<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Noxious (HTB-Sherlocks) | DarioCruz.dev</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.dariocruz.dev/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.dariocruz.dev/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Noxious (HTB-Sherlocks) | DarioCruz.dev"><meta data-rh="true" name="description" content="Noxious"><meta data-rh="true" property="og:description" content="Noxious"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-10-31T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/dario-cruz"><meta data-rh="true" property="article:tag" content="Labs,Hackthebox,Incident-Response,NTLM,LLMNR,HashCat,Offline-BruteForce"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks"><link data-rh="true" rel="alternate" href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks","mainEntityOfPage":"https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks","url":"https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks","headline":"Noxious (HTB-Sherlocks)","name":"Noxious (HTB-Sherlocks)","description":"Noxious","datePublished":"2024-10-31T00:00:00.000Z","author":{"@type":"Person","name":"Dario Cruz","description":"Maintainer of DarioCruz.dev","url":"https://github.com/dario-cruz","image":"https://github.com/dario-cruz.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://www.dariocruz.dev/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="DarioCruz.dev RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="DarioCruz.dev Atom Feed"><link rel="stylesheet" href="/assets/css/styles.d922e3b4.css">
<script src="/assets/js/runtime~main.49fa740e.js" defer="defer"></script>
<script src="/assets/js/main.4e688565.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/dcdev-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/dcdev-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">DarioCruz.dev</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/intro">Projects</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/dariocru/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Kerberoasting-Explained">Kerberoasting: What You Need To Know</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/RogueOne-HTB-Sherlocks">RogueOne (HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/Noxious-HTB-Sherlocks">Noxious (HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Security-Plus-Passed">Security+ Passed!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Reaper-HTB-Sherlocks">Reaper(HTB-Sherlocks)</a></li></ul></div></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">Noxious (HTB-Sherlocks)</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-10-31T00:00:00.000Z">October 31, 2024</time> ¬∑ <!-- -->17 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dario-cruz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/dario-cruz.png" alt="Dario Cruz"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/dario-cruz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Dario Cruz</span></a></div><small class="authorTitle_nd0D" title="Maintainer of DarioCruz.dev">Maintainer of DarioCruz.dev</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p><img decoding="async" loading="lazy" alt="Noxious" src="/assets/images/98966c960819afc7d536fa03a8d5918d-a5f0db3dee205c8b252f46e65947c876.webp" width="1024" height="1024" class="img_ev3q">
Okay, lets get back into it! Time for another Sherlock investigation.üïµÔ∏è‚Äç‚ôÇÔ∏è</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scenario">Scenario<a href="#scenario" class="hash-link" aria-label="Direct link to Scenario" title="Direct link to Scenario">‚Äã</a></h2>
<blockquote>
<p>The IDS device alerted us to a possible rogue device in the internal Active Directory network. The Intrusion Detection System also indicated signs of LLMNR traffic, which is unusual. It is suspected that an LLMNR poisoning attack occurred. The LLMNR traffic was directed towards Forela-WKstn002, which has the IP address 172.17.79.136. A limited packet capture from the surrounding time is provided to you, our Network Forensics expert. Since this occurred in the Active Directory VLAN, it is suggested that we perform network threat hunting with the Active Directory attack vector in mind, specifically focusing on LLMNR poisoning.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-files">The Files<a href="#the-files" class="hash-link" aria-label="Direct link to The Files" title="Direct link to The Files">‚Äã</a></h2>
<p>Okay so in the zip file for the Sherlock we have a single <code>.pcap</code> file which means we will be flexing our Wireshark/TCPdump skills in this investigation.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1">Task 1<a href="#task-1" class="hash-link" aria-label="Direct link to Task 1" title="Direct link to Task 1">‚Äã</a></h2>
<p><strong>Its suspected by the security team that there was a rogue device in Forela&#x27;s internal network running responder tool to perform an LLMNR Poisoning attack. Please find the malicious IP Address of the machine.</strong></p>
<p>Hmmmm, okay so the acronym LLMNR is new to me, so it&#x27;s time to educate myself on that it means, and also how it can be used by a threat actor that has access to an organizations network.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="link-local-multicast-name-resolution">Link-Local Multicast Name Resolution<a href="#link-local-multicast-name-resolution" class="hash-link" aria-label="Direct link to Link-Local Multicast Name Resolution" title="Direct link to Link-Local Multicast Name Resolution">‚Äã</a></h3>
<p>So, it&#x27;s a network protocol, and it&#x27;s based on the DNS packet format. It allows both IPv4 and IPv6 hosts and devices to perform name resolution on the same network link. <sup><a href="#user-content-fn-1-1b8274" id="user-content-fnref-1-1b8274" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-llmnr-works">How LLMNR works<a href="#how-llmnr-works" class="hash-link" aria-label="Direct link to How LLMNR works" title="Direct link to How LLMNR works">‚Äã</a></h3>
<p>Okay so digging deeper into how the protocol works, so that we know what the normal baseline behavior should be, looking at this image <sup><a href="#user-content-fn-3-1b8274" id="user-content-fnref-3-1b8274" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup> it looks like LLMNR works similar to DNS, meaning that a central server is responsible for requests, this means that any deviation in where requests are sent and responded to, should provide us with information on the machine that is on the network carrying out the attack.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="llmnr-poisoning-attacks">LLMNR Poisoning Attacks<a href="#llmnr-poisoning-attacks" class="hash-link" aria-label="Direct link to LLMNR Poisoning Attacks" title="Direct link to LLMNR Poisoning Attacks">‚Äã</a></h4>
<p>How can LLMNR be poisoned? How can it be used to attack a system? According to <a href="https://attack.mitre.org/techniques/T1557/001/" target="_blank" rel="noopener noreferrer">this article</a> from MITRE, adversaries will spoof and present themselves as an authoritative source for name resolution, allowing for the threat actor to collect and/or relay authentication data. Yikes! Threat actors will respond to LLMNR requests as though they know the identity of the requested host, poisoning the service and getting the victims to communicate with the threat actor controlled system.</p>
<p>The goal of the attack is to collect hashes used in authentication which could be used for cracking of the hashes via offline brute forcing, leading to the obtaining of account passwords. <sup><a href="#user-content-fn-2-1b8274" id="user-content-fnref-2-1b8274" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="detection">Detection<a href="#detection" class="hash-link" aria-label="Direct link to Detection" title="Direct link to Detection">‚Äã</a></h5>
<p>Lucky for us, on the same page of this article MITRE provides information on how to detect the incident. More specifically, since we only have access to the pcap of the security incident and not the Windows logs of the machines affected, we can narrow our focus to the Network Traffic data source.
<img decoding="async" loading="lazy" src="/assets/images/c3788c4419312e5e98f8d09f444eec49-b27d8e42f04faed9531dc21435e1833d.png" width="1413" height="387" class="img_ev3q"></p>
<ul>
<li>Monitor network traffic on UDP Ports <strong>5355</strong> and UDP <strong>137</strong>, if LNMR is disabled via security policy.</li>
<li>Monitor network traffic originating from <strong>unknown/unexpected hardware devices</strong>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="investigating-further">Investigating Further<a href="#investigating-further" class="hash-link" aria-label="Direct link to Investigating Further" title="Direct link to Investigating Further">‚Äã</a></h3>
<p>Okay so now it&#x27;s time to open up that <code>.pcap</code> file and start the investigation, we are looking for the IP address of the machine that is carrying out the LLNMR poisoning attack. From our enumeration and information gathering, we know that the ports to check are UPD <strong>5355</strong> &amp; <strong>137</strong>, so in Wireshark we will filter for that starting with port <strong>5355</strong>, <code>upd.port == 5355</code>.
<img decoding="async" loading="lazy" src="/assets/images/18d67820bd23ef498df0f0a320f36188-1147edd91766857532b3ae38a153d816.png" width="1920" height="991" class="img_ev3q"></p>
<p>Looking at the above image we can see a series of normal requests to the DC01 server, the server is processing the requests form machines on the network as normal.
<img decoding="async" loading="lazy" src="/assets/images/a383e27f6efbf38856dc340316101c9c-a6b6d92cdad4b8117fbf262cfb070056.png" width="1851" height="359" class="img_ev3q">
Scrolling down further reveals some intriguing network traffic.
<img decoding="async" loading="lazy" src="/assets/images/f4a3b2fb2aa22e9af2a861ed56780442-c98084d7293bae043f89b1a0ee26523f.png" width="1618" height="351" class="img_ev3q">
Towards the end of the pcap file we can see that query responses are no longer coming from the DC01 server. Query responses are now being handled by <strong>172.17.79.135</strong>, which is the IP address needed answer the task question.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2">Task 2<a href="#task-2" class="hash-link" aria-label="Direct link to Task 2" title="Direct link to Task 2">‚Äã</a></h2>
<p><strong>What is the hostname of the rogue machine?</strong>
Okay so now that we know the IP address of the machine that is carrying out the LLMNR poisoning attack, it should be easy to find the hostname of the machine.</p>
<p>Taking what we have learned form the MITRE information on LLMNR poisoning attacks and how they are carried out, we know we can use DHCP to potentially find information on the threat actor machine. So, back into Wireshark we go, filtering for the IP address that we have found and narrowing down the search by scoping down to only DHCP protocol activity. With that we get 3 network events.
<img decoding="async" loading="lazy" src="/assets/images/7bb19b78cc05701747389245c7de9e40-c0d7a9ce85203559cef953d613acfd17.png" width="1295" height="828" class="img_ev3q">
With the 3 log events we can see that there was a DHCP request from this IP address. and digging into the log details we see that there is a field for the hostname of the requesting computer, in this case the threat actors machine hostname is <strong>kali</strong>. (Kali Linux bby!üòé)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3">Task 3<a href="#task-3" class="hash-link" aria-label="Direct link to Task 3" title="Direct link to Task 3">‚Äã</a></h2>
<p><strong>Now we need to confirm whether the attacker captured the user&#x27;s hash and it is crackable!! What is the username whose hash was captured?</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="llmnr-poisoning-and-hashes">LLMNR Poisoning and Hashes<a href="#llmnr-poisoning-and-hashes" class="hash-link" aria-label="Direct link to LLMNR Poisoning and Hashes" title="Direct link to LLMNR Poisoning and Hashes">‚Äã</a></h3>
<p>Okay so how are LLMNR attacks related to password hashes and the cracking of them? For this lets go back to the MITRE documentation on the attack. Reading through the material, I found this snippet that explains how hashes can be obtained as a result LLMNR poisoning attacks:</p>
<blockquote>
<p>(After initial LLMNR poisoning has been carried out.) ¬†If the requested host belongs to a resource that requires identification/authentication, the username and NTLMv2 hash will then be sent to the adversary controlled system. The adversary can then collect the hash information sent over the wire through tools that monitor the ports for traffic or through¬†<a href="https://attack.mitre.org/techniques/T1040" target="_blank" rel="noopener noreferrer">Network Sniffing</a>¬†and crack the hashes offline through¬†<a href="https://attack.mitre.org/techniques/T1110" target="_blank" rel="noopener noreferrer">Brute Force</a>¬†to obtain the plaintext passwords.</p>
</blockquote>
<p>and also...</p>
<blockquote>
<p>In some cases where an adversary has access to a system that is in the authentication path between systems or when automated scans that use credentials attempt to authenticate to an adversary controlled system, the NTLMv1/v2 hashes can be intercepted and relayed to access and execute code against a target system.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="further-investigation">Further investigation<a href="#further-investigation" class="hash-link" aria-label="Direct link to Further investigation" title="Direct link to Further investigation">‚Äã</a></h3>
<p>Okay so now that we know that the threat actor could potentially be exploiting LLMNR to carry out poisoning and a man-in-the-middle attack to obtain hashes and crack those hashes and attempt to login to a compromised account via NTLM, we will look for indicators of such via further Wireshark filtering.</p>
<p>First lets filter for NTLM traffic, and oh boy we find some clear indicators...
<img decoding="async" loading="lazy" src="/assets/images/6f2b4a46c29981f672959dcf23e6c878-8d337554b4aa0b8f7a3f09579c7c6af4.png" width="1614" height="550" class="img_ev3q">
Looks like we are getting some brute force traffic on the SMB port 412 and also multiple session setup requests on the user account <strong>Forela\john.deacon</strong>, the final answer to the task question being <strong>john.deacon</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4">Task 4<a href="#task-4" class="hash-link" aria-label="Direct link to Task 4" title="Direct link to Task 4">‚Äã</a></h2>
<p><strong>In NTLM traffic we can see that the victim credentials were relayed multiple times to the attacker&#x27;s machine. When were the hashes captured the First time?</strong></p>
<p>Pretty straight forward, as we have already filtered for smb2 traffic. We can look at the time stamps and check for the first instance of the <strong>john.deacon</strong> user account hash being brute forced over the network.
<img decoding="async" loading="lazy" src="/assets/images/9b045d4bb6e5bb04be25707e2764e016-9958f90ea3572abfe7aa6b9717dd398a.png" width="1919" height="513" class="img_ev3q">
The brute forcing of the hash for user account john.deacon took place on <strong>2024-06-24 11:18:30</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-5">Task 5<a href="#task-5" class="hash-link" aria-label="Direct link to Task 5" title="Direct link to Task 5">‚Äã</a></h2>
<p><strong>What was the typo made by the victim when navigating to the file share that caused his credentials to be leaked?</strong></p>
<p>Okay so we have information that the user john.deacon made a typo in the SMB share why does this matter and how did it leak the credentials of the users account? This probably has to do with the LNMRR poisoning as smb share hostnames are resolved to IP addresses and where does that resolution happen, via DNS and in this case with the dual IP addressing protocol nature of the network, LNMRR. So lets take a look at those network logs.
<img decoding="async" loading="lazy" src="/assets/images/71571c0f74f8ccfe49260398944ce1a3-a103ba473e7fbf040e250d188a3af648.png" width="1912" height="296" class="img_ev3q">
So we see some broadcast traffic of the server DC01 announcing it&#x27;s presence. SMB servers have a feature that allows them to advertise their presence on a local network, for security this should probably be disabled as it allows threat actors to enumerate smb servers and shares and potentially exploit them.</p>
<p>Looking back at the network logs of the LLNMR attack, we can see that the victim that had their credentials compromised had mistakenly typed the hostname <strong>DCC01</strong> when attempting to access the smb server/shares.
<img decoding="async" loading="lazy" src="/assets/images/028970dab294f9334460114d0d6aae4a-41b79639afc460e3d4833dba04e5521f.png" width="1913" height="489" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-6">Task 6<a href="#task-6" class="hash-link" aria-label="Direct link to Task 6" title="Direct link to Task 6">‚Äã</a></h2>
<p><strong>To get the actual credentials of the victim user we need to stitch together multiple values from the ntlm negotiation packets. What is the NTLM server challenge value?</strong></p>
<p>For this one a roped in ChatGPT for some clarification on the NTLM protocol and the structure of it&#x27;s packets. The task charges us with finding the <em>server challenge value</em> and that, <em>&quot;To get the actual credentials of the victim we need to stich together multiple values from the NTLM negotiation packets&quot;</em>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="educating-myself-with-chatgpt">Educating myself with ChatGPT<a href="#educating-myself-with-chatgpt" class="hash-link" aria-label="Direct link to Educating myself with ChatGPT" title="Direct link to Educating myself with ChatGPT">‚Äã</a></h3>
<p>I prompted ChatGPT with the following message:</p>
<blockquote>
<p>Explain the structure of ntlm negotiation packets. The context for this task is that I am investigation a security incident, and I need to obtain the NTLM server challenge value that the threat actor obtained.</p>
</blockquote>
<p>And ChatGPT proceeded to give me a wealth of information. More specifically, instructions on how to extract the server challenge value, nice! üòé</p>
<blockquote>
<p>[!NOTE] Steps to Extract the Server Challenge Value</p>
<ol>
<li><strong>Capture NTLM Traffic</strong>:<!-- -->
<ul>
<li>Use network monitoring tools like Wireshark to capture the traffic during the NTLM authentication process.</li>
<li>Apply filters in Wireshark to isolate NTLM packets. The filter <code>ntlmssp</code> can be used to find these packets specifically.</li>
</ul>
</li>
<li><strong>Locate the NTLM Challenge Message</strong>:<!-- -->
<ul>
<li>Look for the message with a type field of <code>0x00000002</code>, which indicates the NTLM challenge message.</li>
</ul>
</li>
<li><strong>Extract the Server Challenge</strong>:<!-- -->
<ul>
<li>The server challenge is located 8 bytes after the &quot;Negotiate Flags&quot; field.</li>
<li>In Wireshark, expand the NTLMSSP fields within the NTLM challenge message to locate the &quot;Server Challenge&quot;.</li>
<li>The value will be a 64-bit (8-byte) hexadecimal number (e.g., <code>0xA1B2C3D4E5F6A7B8</code>).</li>
</ul>
</li>
<li><strong>Verify the Challenge</strong>:<!-- -->
<ul>
<li>Ensure that the challenge aligns with the expected structure, and cross-reference with other packets to see how the client responded using this challenge.</li>
</ul>
</li>
</ol>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-solution">The Solution<a href="#the-solution" class="hash-link" aria-label="Direct link to The Solution" title="Direct link to The Solution">‚Äã</a></h3>
<p>ChatGPT broke it down for me and now I have the details I need to hunt for the answer, NTLM has a series of steps for the authentication process, there are 3 different packets, which are the following, Negotiation Message, Challenge Message, and Authentication Message. The NTLM Challenge packets will be the ones that we are targeting.</p>
<p>Back to Wireshark we filter for <code>ntlmssp</code> packets and we can see the Challenge Message packets clearly.
<img decoding="async" loading="lazy" src="/assets/images/8ede64a723be6efcbf035f5c42c26d9a-6d06bee4875a009dc9535d6097d8eea7.png" width="1917" height="484" class="img_ev3q">
Looking at the first of the challenge packets details, scrolling down to the NTLM specific parts of the packet we can see the first challenge message, from when the threat actor carried out their brute force of the users account.
<img decoding="async" loading="lazy" src="/assets/images/c19eac34ce74fdc7565bc89136d0f1a8-f06dcb0d393718e81b03bf3a26c98aa8.png" width="843" height="462" class="img_ev3q">
The NTLM server challenge value for the first challenge packet is <strong>601019d191f054f1</strong>, which is the answer to the task question.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-7">Task 7<a href="#task-7" class="hash-link" aria-label="Direct link to Task 7" title="Direct link to Task 7">‚Äã</a></h2>
<p><strong>Now doing something similar find the NTProofStr value.</strong></p>
<p>Now our target is the NTProofStr value but, wait what is that? Looking back at the ChatGPT info there is no mention of this value in the information provided....</p>
<blockquote>
<p>[!NOTE] Hey ChatGPT what is NTProofStr in relation to the NTLM protocol?
Response:
<em>In the NTLM protocol, <strong><code>NTProofStr</code></strong> (often called <strong>NT Proof String</strong>) is a key component of the NTLMv2 authentication process. It is a critical part of the client&#x27;s response during the authentication process, specifically in the <strong>NTLM Authenticate Message</strong>.</em></p>
</blockquote>
<p>Cool, so now we need to target and filter for the ntlm authentication packets and look for the value of the NTProofStr.</p>
<p>Looking at the packet that came right after the first ntlm challenge, we see an NTLM authentication packet, attempting to authenticate the user <code>john.deacon</code>.
<img decoding="async" loading="lazy" src="/assets/images/66614e4e754b222469292e72d086b1c0-a835ed50a54bc552a737fa6fe2a73bcf.png" width="683" height="81" class="img_ev3q">
Now looking at the details of the NTLM authentication packet, we see the response type, and also the NTProofStr value, which is <strong>c0cc803a6d9fb5a9082253a04dbd4cd4</strong>.
<img decoding="async" loading="lazy" src="/assets/images/f8993266c9ce839b99d6467353b06177-a59fe3871ea18562d13b26b76ab52d8b.png" width="889" height="452" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-8">Task 8<a href="#task-8" class="hash-link" aria-label="Direct link to Task 8" title="Direct link to Task 8">‚Äã</a></h2>
<p><strong>To test the password complexity, try recovering the password from the information found from packet capture. This is a crucial step as this way we can find whether the attacker was able to crack this and how quickly.</strong></p>
<p>So we need to recover the password? Well, okay lets research how to do that. ChatGPT comes into play again and I ask it the following:</p>
<blockquote>
<p>[!NOTE] How do threat actors crack user passwords using the NTLM protocol?
<em>Response Highlights:</em>
<strong>NTLM hashes</strong> are representations of the user‚Äôs password in hash form, which is used during authentication instead of the plaintext password. If an attacker can capture these hashes (e.g., through a network sniffing attack or by extracting them from compromised machines), they can attempt to crack them offline.</p>
<p>If an attacker captures the NTLM hash <code>aad3b435b51404eeaad3b435b51404ee:32ed87bdb5fbb310bc9ef504a40265b1</code>, they can attempt to use <strong>Hashcat</strong> with a wordlist to brute-force the plaintext password.</p>
</blockquote>
<p>Looks like we have to gather the hashes from the NTLM packets and attempt to crack them with <strong>Hashcat</strong>. I spun up a Linux VM and proceeded to install hash cat and look for wordlists to use.
<img decoding="async" loading="lazy" src="/assets/images/7623b54e81df73f9142230f9c26585b0-a7096e889de448aa5ad4e98785887d42.png" width="474" height="174" class="img_ev3q"></p>
<p>Running Hashcat for the first time with the -h flag(help menu) shows all the flags, parameters and how they can be used to crack hashes or complete other tasks. The list is expansive.
<img decoding="async" loading="lazy" src="/assets/images/4a3025330a06c9ec4502df86901a4953-8266025d16ea6fa52fe3ee66cc42a1bc.png" width="1033" height="873" class="img_ev3q"></p>
<p>Looking for wordlists I found this resource on github, <a href="https://github.com/gmelodie/awesome-wordlists" target="_blank" rel="noopener noreferrer">https://github.com/gmelodie/awesome-wordlists</a> and proceeded to download the <em>RockYou</em> password list as the description read, <em>The go-to wordlist for passwords</em>.</p>
<p>After getting the wordlists and hashcat installed I looked for some guidance on basic usage of the cli app and found an article on freecodecamp <a href="https://www.freecodecamp.org/news/hacking-with-hashcat-a-practical-guide/" target="_blank" rel="noopener noreferrer">https://www.freecodecamp.org/news/hacking-with-hashcat-a-practical-guide/</a>. The syntax we should use to brute force and find that password should be the following</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hashcat -m 0 -a0 hashes.txt rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cracking-ntlm">Cracking NTLM<a href="#cracking-ntlm" class="hash-link" aria-label="Direct link to Cracking NTLM" title="Direct link to Cracking NTLM">‚Äã</a></h3>
<p>I went ahead and created a folder that store the <code>rockyou.txt</code> and also the <code>hashes.txt</code> files. We need to gather the hashes from the <code>.pcap</code> file and place them in the hashes file so that
HashCat can process them and find a match.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ntlm-challenge-response">NTLM Challenge Response<a href="#ntlm-challenge-response" class="hash-link" aria-label="Direct link to NTLM Challenge Response" title="Direct link to NTLM Challenge Response">‚Äã</a></h4>
<p>After doing some research on the NTLM protocol and how threat actors exploit the way it works, in order to carry out <strong>Man-In-The-Middle</strong> attacks, I found that the NTLM Challenge Response is the field that contains the hash-based validation of the password, along with other information, like the <strong>NTProofStr</strong> value that we collected earlier.
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="889" height="123" class="img_ev3q">
So I gathered all the NTLMv2 response hashes from the packet capture file and stored in the <code>hashes.txt</code> file, so that they can be access an processed using hashcat.
<img decoding="async" loading="lazy" src="/assets/images/378feb9f0dafca90dc32f591543c00bc-1ce7d867b39d2f36ce5acf5e94f5076b.png" width="784" height="470" class="img_ev3q">
There was an issue though, when attempting to run hashcat on the file, with the proper syntax, hashcat was presenting me with errors about the hash format.
<img decoding="async" loading="lazy" src="/assets/images/df22b4700beeb6267e76528da7c68e44-a38cf84c59e9b514107e4e31f8dbe811.png" width="1062" height="439" class="img_ev3q">
Here is the syntax that I used after looking at the documentation for hashcat and the guide on how to use it, that I found on <a href="https://www.freecodecamp.org/news/hacking-with-hashcat-a-practical-guide/" target="_blank" rel="noopener noreferrer">freecodecamp</a>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hashcat -m 5600 -a 0 -o cracked.txt hashes.txt rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>The <code>-m 5600</code> flag and arg, tell hash cast to use the HMAC-MD5 hashing algorithm, which is the hashing method that NTLMv2 uses. The <code>-a 0</code> configures hashcat to carry out a normal Dictionary Attack using the provided wordlist in the <code>rockyou.txt</code> file. Lastly, the <code>-o</code> flag specifies where the results of the process should be stored, which is inside of the <code>cracked.txt</code> file.</em></p>
<p>I began to dig into what the cause of the issue was and see how I could correct the formatting. Doing google searches and ChatGPT queries. I came across this video, which detailed, how to obtain the NTLMv2 hash, along with other information that hashcat required, as well has how to format the file that stored the information. <em>Super useful!üòÑ  Shoutout to <a href="https://www.youtube.com/@embracethered" target="_blank" rel="noopener noreferrer">Embrace The Red</a>üçª</em></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/lhhlgoMjM7o?si=Mx6wIhsMwPTYCJvz" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin"></iframe>
<p>Looks like the format of the content in the file needs to be structured via  the format:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">username::domain::challenge_value::HMAC-MD5_value::NTLMv2Resposne(Without fist 16 bytes)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So I created a new file <code>ntlm-hashes.txt</code> and typed out the needed format. Time to gather the data from the packet capture file.</p>
<p>First we need the <strong>NTLM Server Challenge</strong> value. Looking at the packet capture this would be the first packet that is sent to the NTLM server, by the client, requesting authentication and access. I my case I am targeting the first 3 packets in the capture file, after filtering for <code>ntlmssp</code>.
<img decoding="async" loading="lazy" src="/assets/images/6c9061d3c0d2e86f2e3f3ba97fcbb047-00d6a88fd861b4cee12910eaaaf77700.png" width="1080" height="158" class="img_ev3q">
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="527" height="99" class="img_ev3q">
Second, we need the <strong>NTLMv2 Response</strong>, which we find in the same packet further down the packet details, just like in our previous attempt.
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="576" height="163" class="img_ev3q">
Third, we need to obtain the <strong>HMAC-MD5</strong> value for hashcat, according to the information in the video, the <strong>NTProofStr</strong> is the HMAC-MD5 value. It is also the first 16 bytes of the challenge response.
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="576" height="163" class="img_ev3q">
And for the last two values, User and Domain, we scroll down further in the packet details to find those values under the <em>domain name</em> &amp; <em>user name</em> attributes.
<img decoding="async" loading="lazy" src="/assets/images/89cbf79b5d85adceafbb5fb7bedeeb62-bd3d3ce4d96d667ba3c93ad1694f1248.png" width="606" height="306" class="img_ev3q">
Here we have, the final result of gathering all the need attribute values stored in the <code>ntlm-hashes.txt</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">john.deacon::FORELA: 53b0e5778af9adfb:8573cf0b2b03b84ba6caef21cd43a303:010100000000000080e4d59406c6da0153b0e57....</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we use hashcat to do an offline brute force of the NTLMv2 hash. Below is the refined command to run:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hashcat -a0 -m5600 ntlm-hashes.txt rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And here is the terminal output from the command and the resulting password for the user account.
<img decoding="async" loading="lazy" src="/assets/images/b2bbd96796f272fecdd34c38d1565ada-1a28654e1129d8fa46c5cb10bb1324bd.png" width="1062" height="499" class="img_ev3q">
<strong>The answer to the task question is the password <code>NotMyPassword0k?</code></strong></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-9">Task 9<a href="#task-9" class="hash-link" aria-label="Direct link to Task 9" title="Direct link to Task 9">‚Äã</a></h2>
<p><strong>Just to get more context surrounding the incident, what is the actual file share that the victim was trying to navigate to?</strong></p>
<p>For this task we will need to take a look at the log files that lead up to the malicious event. We know that the user was attempting to access a file share but, entered the wrong file share path, which in turn lead to their account becoming compromised.  In task 5 we found the typo that the user had mistakenly typed in, which was <code>DCC01</code>. Looking through the packet capture file, we can see that right before the LLMNR pensioning took place, the user was attempting to access the file share, <strong><code>\\DC01\DC-Confidential</code></strong>, which is the answer to the Task 9 Question.
<img decoding="async" loading="lazy" src="/assets/images/b8e02d6e56baed79311e79178c8b37d1-795f1373aa4e19baa89a8ac5d61a5d84.png" width="1908" height="399" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-takeaways"><strong>Key Takeaways</strong><a href="#key-takeaways" class="hash-link" aria-label="Direct link to key-takeaways" title="Direct link to key-takeaways">‚Äã</a></h2>
<ul>
<li><strong>LLMNR (Link-Local Multicast Name Resolution)</strong> is a protocol that is used in Windows networks, it allows for the resolution of local network hostnames to IP addresses when DNS is not available. It is susceptible to <strong>Man-in-the-middle (MITM) &amp; Poisoning Attacks</strong>, due to it&#x27;s lack of <em>verifying the identity of devices that respond to the name resolution requests</em>. <strong>Poisoning of LLMNR</strong> takes place when a threat actor exploits this lack of <em>verification</em> and <strong>impersonates the the LLMNR requesting service</strong>, allowing for the threat actor to receive traffic flows that contain sensitive information, which in this case lead to an corresponding <strong>NTLMv2 hash brute force</strong>.</li>
<li><strong>NTLM(Windows New Technology LAN Manager)</strong> and it&#x27;s <strong>Version 2</strong> variant are used to <em>authenticate users</em> via a <strong>challenge-response mechanism</strong>. With <strong>NTLMv2</strong> the challenge-response mechanism uses HMAC-MD5 hashes that can be obtained via <em>traffic capture</em> or <em>Man-In-The-Middle attacks</em> and used for <em>offline brute forcing</em>, using a number of tools that are available, including the tool which we used for this investigation, <em>HashCat</em>. NTLM as a protocol should be disabled as is has been <em><a href="https://learn.microsoft.com/en-us/windows/whats-new/deprecated-features" target="_blank" rel="noopener noreferrer">deprecated by Microsoft</a></em>, and there are more modern protocols like Kerberos that accomplish the same functionality while being secure.</li>
</ul>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">‚Äã</a></h2>
<ol>
<li id="user-content-fn-1-1b8274">
<p><a href="https://en.wikipedia.org/wiki/Link-Local_Multicast_Name_Resolution" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Link-Local_Multicast_Name_Resolution</a> <a href="#user-content-fnref-1-1b8274" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">‚Ü©</a></p>
</li>
<li id="user-content-fn-3-1b8274">
<p><a href="https://www.aptive.co.uk/wp-content/uploads/2017/02/responder-llmnr-netbios-name-server-spoofing.png" target="_blank" rel="noopener noreferrer">https://www.aptive.co.uk/wp-content/uploads/2017/02/responder-llmnr-netbios-name-server-spoofing.png</a> <a href="#user-content-fnref-3-1b8274" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref">‚Ü©</a></p>
</li>
<li id="user-content-fn-2-1b8274">
<p><a href="https://attack.mitre.org/techniques/T1557/001/" target="_blank" rel="noopener noreferrer">https://attack.mitre.org/techniques/T1557/001/</a> <a href="#user-content-fnref-2-1b8274" data-footnote-backref="" aria-label="Back to reference 3" class="data-footnote-backref">‚Ü©</a></p>
</li>
</ol>
</section></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/labs">Labs</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/hackthebox">Hackthebox</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/incident-response">Incident-Response</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/ntlm">NTLM</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/llmnr">LLMNR</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/hash-cat">HashCat</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/offline-brute-force">Offline-BruteForce</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/RogueOne-HTB-Sherlocks"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">RogueOne (HTB-Sherlocks)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/Security-Plus-Passed"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Security+ Passed!</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#scenario" class="table-of-contents__link toc-highlight">Scenario</a></li><li><a href="#the-files" class="table-of-contents__link toc-highlight">The Files</a></li><li><a href="#task-1" class="table-of-contents__link toc-highlight">Task 1</a><ul><li><a href="#link-local-multicast-name-resolution" class="table-of-contents__link toc-highlight">Link-Local Multicast Name Resolution</a></li><li><a href="#how-llmnr-works" class="table-of-contents__link toc-highlight">How LLMNR works</a></li><li><a href="#investigating-further" class="table-of-contents__link toc-highlight">Investigating Further</a></li></ul></li><li><a href="#task-2" class="table-of-contents__link toc-highlight">Task 2</a></li><li><a href="#task-3" class="table-of-contents__link toc-highlight">Task 3</a><ul><li><a href="#llmnr-poisoning-and-hashes" class="table-of-contents__link toc-highlight">LLMNR Poisoning and Hashes</a></li><li><a href="#further-investigation" class="table-of-contents__link toc-highlight">Further investigation</a></li></ul></li><li><a href="#task-4" class="table-of-contents__link toc-highlight">Task 4</a></li><li><a href="#task-5" class="table-of-contents__link toc-highlight">Task 5</a></li><li><a href="#task-6" class="table-of-contents__link toc-highlight">Task 6</a><ul><li><a href="#educating-myself-with-chatgpt" class="table-of-contents__link toc-highlight">Educating myself with ChatGPT</a></li><li><a href="#the-solution" class="table-of-contents__link toc-highlight">The Solution</a></li></ul></li><li><a href="#task-7" class="table-of-contents__link toc-highlight">Task 7</a></li><li><a href="#task-8" class="table-of-contents__link toc-highlight">Task 8</a><ul><li><a href="#cracking-ntlm" class="table-of-contents__link toc-highlight">Cracking NTLM</a></li></ul></li><li><a href="#task-9" class="table-of-contents__link toc-highlight">Task 9</a></li><li><a href="#key-takeaways" class="table-of-contents__link toc-highlight"><strong>Key Takeaways</strong></a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2025 DarioCruz.dev. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>