<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">What I&#x27;ve Learned - Network Traffic Analysis | DarioCruz.dev</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://www.dariocruz.dev/blog/NetTrafficAnalysis"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:title" content="What I&#x27;ve Learned - Network Traffic Analysis | DarioCruz.dev"><meta data-rh="true" name="description" content="Lessons learned from analyzing network traffic with Wireshark and tcpdump."><meta data-rh="true" property="og:description" content="Lessons learned from analyzing network traffic with Wireshark and tcpdump."><meta data-rh="true" name="keywords" content="network traffic analysis,Wireshark,tcpdump,detection,cybersecurity"><meta data-rh="true" property="og:image" content="https://www.dariocruz.dev/img/itsmedario.webp"><meta data-rh="true" name="twitter:image" content="https://www.dariocruz.dev/img/itsmedario.webp"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-02-03T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/dario-cruz"><meta data-rh="true" property="article:tag" content="NetworkTrafficAnalysis,Detection,Wireshark,tcpdump"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.dariocruz.dev/blog/NetTrafficAnalysis"><link data-rh="true" rel="alternate" href="https://www.dariocruz.dev/blog/NetTrafficAnalysis" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.dariocruz.dev/blog/NetTrafficAnalysis" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://www.dariocruz.dev/blog/NetTrafficAnalysis","mainEntityOfPage":"https://www.dariocruz.dev/blog/NetTrafficAnalysis","url":"https://www.dariocruz.dev/blog/NetTrafficAnalysis","headline":"What I've Learned - Network Traffic Analysis","name":"What I've Learned - Network Traffic Analysis","description":"Lessons learned from analyzing network traffic with Wireshark and tcpdump.","datePublished":"2025-02-03T00:00:00.000Z","author":{"@type":"Person","name":"Dario Cruz","description":"Maintainer of DarioCruz.dev","url":"https://github.com/dario-cruz","image":"https://github.com/dario-cruz.png"},"image":{"@type":"ImageObject","@id":"https://www.dariocruz.dev/img/itsmedario.webp","url":"https://www.dariocruz.dev/img/itsmedario.webp","contentUrl":"https://www.dariocruz.dev/img/itsmedario.webp","caption":"title image for the blog post: What I've Learned - Network Traffic Analysis"},"keywords":["network traffic analysis","Wireshark","tcpdump","detection","cybersecurity"],"isPartOf":{"@type":"Blog","@id":"https://www.dariocruz.dev/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="DarioCruz.dev RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="DarioCruz.dev Atom Feed"><link rel="stylesheet" href="/assets/css/styles.fe7f9ae0.css">
<script src="/assets/js/runtime~main.eea08814.js" defer="defer"></script>
<script src="/assets/js/main.471f7ac3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/dcdev-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/dcdev-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">DarioCruz.dev</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/intro">Projects</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/dariocru/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/LearningLinuxArch">Learning Linux with Arch</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Unit42-Sherlock">Unit42 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/CrownJewel2-Sherlock">CrownJewel 2 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/CrownJewel1-Sherlock">CrownJewel 1 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Campfire2-Sherlock">Campfire 2 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Campfire1-Sherlock">Campfire 1 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Loggy-Sherlock">Loggy (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/NetTrafficAnalysis">What I&#x27;ve Learned - Network Traffic Analysis</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Kerberoasting-Explained">Kerberoasting: What You Need To Know</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/RogueOne-HTB-Sherlocks">RogueOne (HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Noxious-HTB-Sherlocks">Noxious (HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Security-Plus-Passed">Security+ Passed!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Reaper-HTB-Sherlocks">Reaper(HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/The Journey So Far">The Journey So Far</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Mastering Identity &amp; Access Management">Mastering Identity &amp; Access Management</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Site Up and Running">Site Up and Running</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">What I&#x27;ve Learned - Network Traffic Analysis</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-02-03T00:00:00.000Z">February 3, 2025</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dario-cruz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/dario-cruz.png" alt="Dario Cruz"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/dario-cruz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Dario Cruz</span></a></div><small class="authorTitle_nd0D" title="Maintainer of DarioCruz.dev">Maintainer of DarioCruz.dev</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p><img decoding="async" loading="lazy" alt="Network Traffic Detective" src="/assets/images/Net Traffic Detective-6e20aa4c60cce3a2d774ccc3796bd585.png" width="1024" height="1024" class="img_ev3q">
I recently completed the Hack The Box module: <a href="https://academy.hackthebox.com/achievement/379578/229" target="_blank" rel="noopener noreferrer">Intro to Network Traffic Analysis</a>. I have to say I really enjoyed this module as we dived into the Analysis process. The whole module gave me the feeling of being a private investigator/detective, digging through tons of information to look for anomalies or patterns that indicate compromise or a security event. Lets dig into what I learned over the course of the module and how it can be applied in practice.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-is-network-traffic-analysis-important">Why is Network Traffic Analysis Important?<a href="#why-is-network-traffic-analysis-important" class="hash-link" aria-label="Direct link to Why is Network Traffic Analysis Important?" title="Direct link to Why is Network Traffic Analysis Important?">​</a></h2>
<p>This is a good question to pose as we need to establish the intent and need for Network Traffic Analysis.</p>
<p>Network Traffic Analysis, can be defined as inspecting of network traffic patterns, analysis network protocol behavior, and analyzing network packets for abnormal behavior, or indicators of compromise.</p>
<p>When you think about it networks are the core of IT infrastructure. Without a network, computers and servers providing services can not communicate with one another. This need for communication is the very reason computers are interconnected in the first place. Threat actors know that communication is paramount to organizations and individuals and by association, the work that they do. Threat actors use this fact and exploit a given network for various reasons.</p>
<ul>
<li>To disrupt service and functionality</li>
<li>To capture and exfiltrate data.</li>
<li>To gain unauthorized access to a network or service.</li>
</ul>
<p>Regular checking and investigation of network traffic is important as many times abnormal network communication is the first indicator that something malicious has or will take place.</p>
<p>Citing the NIST publication <a href="https://www.nist.gov/publications/network-security-traffic-analysis-platform-design-and-validation" target="_blank" rel="noopener noreferrer">Network Security Traffic Analysis Platform - Design and Validation</a>, it states:</p>
<blockquote>
<p>Real-time traffic management and control have become necessary in today&#x27;s networks due to their complexity and cybersecurity risks. With the increase in internet use, threats are more present and require real-time detection and analysis to prevent intrusions. As the number of data flows increases, the number and the types of attacks increase, which makes detecting intrusions challenging. Over the last years, many researchers have focused on different ways to detect intrusions in different systems. In this work, we describe the design and evaluation of a network security traffic analysis platform (NSTAP) to collect, view, search and analyze traffic data in real-time. Through charts, tables, histograms and other visualization methods, we demonstrate its power and usefulness with results obtained with simple time analytics of large data volumes. This work is intended to be the foundation for machine learning based automation tools.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-process">What is the Process?<a href="#what-is-the-process" class="hash-link" aria-label="Direct link to What is the Process?" title="Direct link to What is the Process?">​</a></h2>
<p>The process of analyzing network traffic is cyclical. The higher level process steps inform the bottom level steps and vise versa, information is echoed to each other until the full picture of the threat actors actions come into view.
<img decoding="async" loading="lazy" alt="NTA Process" src="/assets/images/Network Traffic Analysis Process-f9d221d863ac8bddd30492f7b4903aa2.svg" width="784" height="721" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="steps-of-the-cycle">Steps of the Cycle<a href="#steps-of-the-cycle" class="hash-link" aria-label="Direct link to Steps of the Cycle" title="Direct link to Steps of the Cycle">​</a></h3>
<ul>
<li><strong>Monitoring</strong> - The continuous capture of data from the network using tools like <em>Tcpdump</em>, <em>Wireshark</em>, or a <em>SIEM</em> platform.</li>
<li><strong>Analysis</strong> - Reviewing of data captured. Looking for anomalies, patterns, and threats.</li>
<li><strong>Action</strong> - Implementing changes in an effort to remediate the issue and harden the given network, servers/services, and hosts from future attack.</li>
<li><strong>Documentation and Review</strong> - Logtargetteds and Reports of given incidents are used to assess the current processes around responding to the incident. Things like what tools where used to investigate and also remediate the issue. Could this be streamlined further?</li>
<li><strong>Adaptation and Improvement</strong> - Lessons learned from the entire cycle, used to create refinements and efficiencies in analyzing and responding to found incidents or events. Drives improvement through out the entire cycle.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tools-used">Tools Used<a href="#tools-used" class="hash-link" aria-label="Direct link to Tools Used" title="Direct link to Tools Used">​</a></h2>
<p>The most commonly used tools for Network Traffic Analysis are as follows:</p>
<ul>
<li><strong>Wireshark</strong> - GUI based network packet capture and analysis tool. Has a host of features that allow for granular filtering of captured traffic, plugins that include functions for displaying statistics about packets captured, rebuilding of protocol traffic flows, and exporting of transferred data, files, images, etc. <em>Makes use of BPF syntax for filtering</em>.</li>
<li><strong>TShark</strong> - Terminal based version of Wireshark that has many of the same features. Is accessed via the CLI and does not have a GUI. <em>Also uses BPF Syntax for filtering.</em></li>
<li><strong>Tcpdump</strong> - Terminal based packet sniffer/capture and analysis tool for Unix based systems. Has a host of features that are accessed via <code>flags</code> that are used to define whether to read or write a packet capture file, and how to filter the file and display the output.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bpf-syntax">BPF Syntax<a href="#bpf-syntax" class="hash-link" aria-label="Direct link to BPF Syntax" title="Direct link to BPF Syntax">​</a></h3>
<p>Stands for <a href="https://www.ibm.com/docs/en/qsip/7.4?topic=queries-berkeley-packet-filters" target="_blank" rel="noopener noreferrer">Berkeley Packet Filter Syntax</a> and was created by two individuals, Steven McCanne and Van Jacobson, while they were at Berkeley College&#x27;s Lawrence Laboratory. <sup><a href="#user-content-fn-1-0eaf4c" id="user-content-fnref-1-0eaf4c" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup> The syntax is widely used in packet capture and filtering tools due to it&#x27;s ability to quickly reduce packet captures to targeted results. <sup><a href="#user-content-fn-2-0eaf4c" id="user-content-fnref-2-0eaf4c" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="detection-and-threat-hunting">Detection and Threat Hunting<a href="#detection-and-threat-hunting" class="hash-link" aria-label="Direct link to Detection and Threat Hunting" title="Direct link to Detection and Threat Hunting">​</a></h2>
<p>Network Traffic Analysis and be used for detection of malicious activity on a given network but, in the case that their is no SIEM or IDS/IPS system running on the network. Network Traffic Analysis can be used to <em>hunt for threats</em>. Through the use of packet analysis, looking for odd connections to or from hosts, looking at large amounts of data being transferred over a network during non-work hours could be indicators of malicious activity.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="wireshark-file-extraction">Wireshark File Extraction<a href="#wireshark-file-extraction" class="hash-link" aria-label="Direct link to Wireshark File Extraction" title="Direct link to Wireshark File Extraction">​</a></h2>
<p>Wireshark has the ability to follow traffic flows and rebuild data that has been transferred to completion, over a given network. This specific functionality is called the <em>dissector</em>, which will reassemble the data into the original file. This allows for complete files to be analyzed or read in isolated environments, providing more insight as to what is actually taking place.
<sup><a href="#user-content-fn-3-0eaf4c" id="user-content-fnref-3-0eaf4c" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup></p>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-1-0eaf4c">
<p><a href="https://en.wikipedia.org/wiki/Berkeley_Packet_Filter" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Berkeley_Packet_Filter</a> <a href="#user-content-fnref-1-0eaf4c" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-2-0eaf4c">
<p><a href="https://www.ibm.com/docs/en/qsip/7.4?topic=queries-berkeley-packet-filters" target="_blank" rel="noopener noreferrer">https://www.ibm.com/docs/en/qsip/7.4?topic=queries-berkeley-packet-filters</a> <a href="#user-content-fnref-2-0eaf4c" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-3-0eaf4c">
<p><a href="https://www.wireshark.org/docs/wsug_html_chunked/ChIOExportSection.html" target="_blank" rel="noopener noreferrer">https://www.wireshark.org/docs/wsug_html_chunked/ChIOExportSection.html</a> <a href="#user-content-fnref-3-0eaf4c" data-footnote-backref="" aria-label="Back to reference 3" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/network-traffic-analysis">NetworkTrafficAnalysis</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/detection">Detection</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/wireshark">Wireshark</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/tcpdump">tcpdump</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/Loggy-Sherlock"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Loggy (HTB-Sherlock)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/Kerberoasting-Explained"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Kerberoasting: What You Need To Know</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-is-network-traffic-analysis-important" class="table-of-contents__link toc-highlight">Why is Network Traffic Analysis Important?</a></li><li><a href="#what-is-the-process" class="table-of-contents__link toc-highlight">What is the Process?</a><ul><li><a href="#steps-of-the-cycle" class="table-of-contents__link toc-highlight">Steps of the Cycle</a></li></ul></li><li><a href="#tools-used" class="table-of-contents__link toc-highlight">Tools Used</a><ul><li><a href="#bpf-syntax" class="table-of-contents__link toc-highlight">BPF Syntax</a></li></ul></li><li><a href="#detection-and-threat-hunting" class="table-of-contents__link toc-highlight">Detection and Threat Hunting</a></li><li><a href="#wireshark-file-extraction" class="table-of-contents__link toc-highlight">Wireshark File Extraction</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 DarioCruz.dev. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>