<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://www.dariocruz.dev/blog</id>
    <title>DarioCruz.dev Blog</title>
    <updated>2024-12-05T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://www.dariocruz.dev/blog"/>
    <subtitle>DarioCruz.dev Blog</subtitle>
    <icon>https://www.dariocruz.dev/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Kerberoasting: What You Need To Know]]></title>
        <id>https://www.dariocruz.dev/blog/Kerberoasting-Explained</id>
        <link href="https://www.dariocruz.dev/blog/Kerberoasting-Explained"/>
        <updated>2024-12-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Kerberoasting]]></summary>
        <content type="html"><![CDATA[<p><img decoding="async" loading="lazy" alt="Kerberoasting" src="https://www.dariocruz.dev/assets/images/4bb6b8a0a373ae8196887b8c953a9127-207a9244822e6e6846222d7a1be69412.png" width="1024" height="1024" class="img_ev3q">
Hello Everyone! 👋</p>
<p>Today we will be learning about Kerberoasting, an attack that targets Kerberos. I decided to write an article about this topic as I am actively learning about the attack as a part of the Hack the Box CDSA certification.</p>
<p>To first understand what Kerberoasting is, we need to dive into Kerberos, what is is, what it offers, and how it works to gain better insight into how Kerberoasting are carried out, and why threat actors persistently choose this method to gain access to AD environments.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="kerberos-whats-that">Kerberos... What's that?<a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#kerberos-whats-that" class="hash-link" aria-label="Direct link to Kerberos... What's that?" title="Direct link to Kerberos... What's that?">​</a></h2>
<p>Kerberos is a network authentication mechanism that is used in Active Directory and other systems/environments. It was developed by Massachusetts Institute of Technology(MIT) in the last 1980's and is now the default authorization technology in Microsoft Windows, it has also been implemented in Apple OS, FreeBSD, UNIX, and Linux. Active Directory its self has the largest market share out of all IAM platforms so attackers target AD environments and attack Kerberos consistently, thus this is a good topic to learn about.  <sup><a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fn-1-e35319" id="user-content-fnref-1-e35319" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup></p>
<p>The main reason the protocol was developed in the first place, was to provide a way of securing authentication traffic on a given network, preventing threat actors from intercepting authentication transmissions, gaining unauthorized access. Back in the 1980's most authentication was transmitted in clear text over networks, making it easy for threat actors with network access to eavesdrop on traffic and obtain credentials.<sup><a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fn-2-e35319" id="user-content-fnref-2-e35319" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="components">Components<a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#components" class="hash-link" aria-label="Direct link to Components" title="Direct link to Components">​</a></h3>
<p>Kerberos consists of a few interconnected parts that work together to offer a complete &amp; secure authentication and authorization protocol.</p>
<ul>
<li><strong>The Client</strong>: The end point that is requesting authentication to an app, service, or network. The client will send out a request to what is called the <em>Key Distribution Center</em>, with it's encrypted credentials and await a response back.</li>
<li><strong>Key Distribution Center</strong>: Handles the requests from clients for authentication, is comprised of 3 elements, which all tend to reside on the same server. They are the <em>Authentication Server</em>, <em>Ticket Granting Server</em>, and a <em>Database</em>.<!-- -->
<ul>
<li><strong>Authentication Server</strong>: Component of the KDC that receives client requests and provides successfully authenticated clients with a ticket known as a <em>Ticket Granting Ticket (TGT)</em>. The TGT allows for authed clients to obtain other <em>Service Tickets</em> without having to re-enter credentials.</li>
<li><strong>Ticket Granting Server (TGS)</strong>: Component of the KDC that is the distributor of <em>Service Tickets</em> to clients with a valid <em>TGT</em>, providing them access to specific services, apps, or networks.</li>
<li><strong>Database</strong>: Part of the KDC that contains entries of <em>users</em> and the associated <em>services</em> that they have access to. Also contains information related to the <em>max validity duration</em> for a ticket, <em>max time a ticket may be renewed</em>, <em>password expiration date</em>, etc.</li>
</ul>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Kerberos Diagram" src="https://www.dariocruz.dev/assets/images/KerberosDiagram-ec6a06ba263defa6757764cb0cc59e87.svg" width="1276" height="750" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="kerberoasting">Kerberoasting<a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#kerberoasting" class="hash-link" aria-label="Direct link to Kerberoasting" title="Direct link to Kerberoasting">​</a></h2>
<p>Okay so now that we have an understanding of how Kerberos works, we will move on to how threat actors carry out what is called Kerberoasting.</p>
<p>Kerberoasting is an attack that attempts to obtain the password hash of an Active Directory <em>Service Account</em> that has what is called a <em>Service Principal Name (SPN)</em>. What is an SPN you might ask? Well, it is a Active Directory attribute that is used by Kerberos authentication mechanisms to associate a service instance with corresponding service account, providing access to said service. <sup><a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fn-3-e35319" id="user-content-fnref-3-e35319" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup> <sup><a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fn-4-e35319" id="user-content-fnref-4-e35319" data-footnote-ref="true" aria-describedby="footnote-label">4</a></sup></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-attack">The Attack<a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#the-attack" class="hash-link" aria-label="Direct link to The Attack" title="Direct link to The Attack">​</a></h3>
<p>The threat actor must first gain access to a domain user account via compromise, not a <em>Domain Admin account</em>, just a regular account, this then allows them to request a Kerberos service ticket from the TGS. This is done with the use of tools, most commonly <a href="https://github.com/GhostPack/Rubeus" target="_blank" rel="noopener noreferrer">Rubeus</a>. Once the ticket is received from the KDC the threat actor stores the key for offline brute forcing. The ticket from the KDC contains an encrypted hash of the <em>service accounts</em> password.</p>
<p>Rubeus is a tool, written in C# that automates interaction and abuse of Kerberos authentication mechanisms. It has a host of options such as making Ticket Requests and Renewals, Ticket Forgery, Ticket Extraction and Harvesting. <sup><a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fn-5-e35319" id="user-content-fnref-5-e35319" data-footnote-ref="true" aria-describedby="footnote-label">5</a></sup></p>
<p>So lets say that we wanted to use the tool to carryout our own testing, or make use of it for a capture the flag challenge. On Windows via PowerShell, the command to carry out Kerberoasting, using Rubeus, would be;</p>
<div class="language-Shell language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">.\Rubeus.exe kerberoast /outfile:results.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After obtaining the SPN values from Rubeus, threat actors then carry out offline brute forcing with tools like Hashcat or JohnTheRipper. In the case of hashcat, looking at the documentation for the command-line utility, there is a specific hash option designed for Kerberos 5 hashes, hash option <code>13100</code>.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/f35a8e5b76f9bc3c1542c0fddecd383f-bcbc548ef0eae4f779dda5315dc8a007.png" width="1194" height="188" class="img_ev3q">And if we were to let's say use the <code>result.txt</code> file form the Rubeus output, you could use the below command to crack the hashes of the returned SPN's.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hashcat -m 13100 -a 0 wordlist.txt results.txt --outfile="cracked-spns.txt"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>-m</code> flag  allows for specifying what hash type we would like to crack, and as stated previously <code>13100</code> is the value for the Kerberos hash type. The<code>-a</code> flag specifies the type of attack mode to use. It's followed by the value of <code>0</code> which is "Straight Mode". Straight Mode uses a single wordlist, as you can see by flag and value having <code>wordlist.txt</code> specified after it. Next is the target file that contains the hash, in our case it is <code>results.txt</code>. At the end we have <code>--outfile</code> which directs hashcat to save the output to a specified file, in this case <code>cracked-spns.txt</code>, formatting can also be changed for the output file via <code>--outfile-format</code> as well. <sup><a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fn-6-e35319" id="user-content-fnref-6-e35319" data-footnote-ref="true" aria-describedby="footnote-label">6</a></sup></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="attack-chain-visualized">Attack Chain Visualized<a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#attack-chain-visualized" class="hash-link" aria-label="Direct link to Attack Chain Visualized" title="Direct link to Attack Chain Visualized">​</a></h3>
<p>Below I have included a graphic of the entire Kerberoasting attack chain.</p>
<p><img decoding="async" loading="lazy" alt="KerberosAttackChain" src="https://www.dariocruz.dev/assets/images/KerberosAttackChain-908bc0f465babd955ed51ecd3a404d96.svg" width="1040" height="352" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="detection">Detection<a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#detection" class="hash-link" aria-label="Direct link to Detection" title="Direct link to Detection">​</a></h3>
<p>Kerberoasting attacks can be detected via the monitoring of <strong>Windows Event Code: 4769</strong>, which is the Windows event code that corresponds to a Kerberos ticket being requested. In the logs for this event code there are a few fields to take not of, specifically the <em>Account Name</em>, <em>Service Name</em>, <em>Client Address</em>, and the <em>Ticket Encryption Type</em>. The value for the <em>Ticket Encryption Type</em> is an important, the hex values represent the type of encryption being used for the request and could tip us off to a potential attack.</p>
<p>Below is a table of common encryption types and their strengths.</p>
<table><thead><tr><th>Hex code</th><th>Encryption Type</th><th>Description</th></tr></thead><tbody><tr><td>0x17</td><td>RC4_HMAC</td><td><strong>Weak Encryption, Commonly Used for Kerberoasting attacks</strong></td></tr><tr><td>0x12</td><td>AES256_CTS_HMAC_SHA1_96</td><td>Strong encryption, preferred for modern environments.</td></tr><tr><td>0x11</td><td>AES128_CTS_HMAC_SHA1_96</td><td>Strong but less secure then AES256.</td></tr><tr><td>0x01</td><td>DES_CBC_CRC</td><td>Deprecated/Weak encryption.</td></tr><tr><td>0x02</td><td>DES_CBC_MD5</td><td>Deprecated/Weak encryption.</td></tr><tr><td>0x03</td><td>DES3_CBC_SHA1</td><td>Stronger then both DES encryption algorithms but is not commonly used in modern environments.</td></tr></tbody></table>
<p>Take note that any Kerberos request that uses the <code>RC4_HMAC</code> encryption protocol is potentially an indicator of attack or compromise.</p>
<p>Also, we need to note that if any of the legacy encryption methods are left enabled on the KDC server, attackers could carryout a downgrade attack on the Kerberos system, effectively forcing the authentication/authorization protocol to use a weaker level encryption allowing for threat actors to more easily crack the SPN hash. 😬</p>
<p>Lets say that we wanted to do an SPL query in Splunk for Kerberoasting, targeting the Event 4769 and the Ticket Encryption Value of 0x17, the query would look like this:</p>
<div class="language-SPL language-spl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-spl codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">index=&lt;target-index&gt; EventCode=4769 EncryptionType=0x17</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prevention">Prevention<a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#prevention" class="hash-link" aria-label="Direct link to Prevention" title="Direct link to Prevention">​</a></h3>
<p>The goal of Kerberoasting attacks is the theft of service account credentials and the eventual compromise of the AD Doman, allowing threat actors to gain a foot hold in an organizations environment and carry out further malicious actions. Due to these factors, prevention of Kerberoasting attacks should take a multi-faceted approach. Below are some methods to protect against Kerberoasting attacks:</p>
<ul>
<li>Use of strong &amp; complex Service Account passwords &amp; the updating of said passwords on a regular cadence. <sup><a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fn-7-e35319" id="user-content-fnref-7-e35319" data-footnote-ref="true" aria-describedby="footnote-label">7</a></sup></li>
<li>Restriction of Service Principal Name (SPN) Exposure via limiting SPN registration and using Managed Service Accounts. <sup><a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fn-8-e35319" id="user-content-fnref-8-e35319" data-footnote-ref="true" aria-describedby="footnote-label">8</a></sup></li>
<li>Enforcement of strong encryption types, threat actors will attempt to push the protocol to downgrade the encryption, if these lower level encryption standards are enabled, the domain will be left vulnerable to Kerberoasting attacks. <sup><a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fn-8-e35319" id="user-content-fnref-8-e35319-2" data-footnote-ref="true" aria-describedby="footnote-label">8</a></sup></li>
<li>Implementing Monitoring and Auditing of Kerberos Ticket Requests, this will allow for alerting on unusual requests and audits will find unusual patterns that could indicate attack or compromise. <sup><a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fn-9-e35319" id="user-content-fnref-9-e35319" data-footnote-ref="true" aria-describedby="footnote-label">9</a></sup></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>And with that, you know have a pretty good understanding of Kerberos &amp; Kerberoasting. How threat actor target Kerberos and Active Directory in an attempt to compromise a Service Account, and potentially over parts of the domain after the initial compromise.</p>
<p>You also know now how to detect and defend from these types of attacks but, there is always more to learn and more to dig into and understand. As my learning progresses I will update this article with other bits of information I find related to Kerberoasting.</p>
<p><strong>Thank you for reading! 😎</strong></p>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-1-e35319">
<p><a href="https://www.simplilearn.com/what-is-kerberos-article#:~:text=This%20process%20uses%20shared%20secret,against%20eavesdropping%20and%20replay%20attacks" target="_blank" rel="noopener noreferrer">https://www.simplilearn.com/what-is-kerberos-article#:~:text=This%20process%20uses%20shared%20secret,against%20eavesdropping%20and%20replay%20attacks</a>. <a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fnref-1-e35319" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-2-e35319">
<p><a href="https://www.techtarget.com/searchsecurity/definition/Kerberos" target="_blank" rel="noopener noreferrer">https://www.techtarget.com/searchsecurity/definition/Kerberos</a> <a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fnref-2-e35319" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-3-e35319">
<p><a href="https://www.crowdstrike.com/en-us/cybersecurity-101/cyberattacks/kerberoasting/" target="_blank" rel="noopener noreferrer">https://www.crowdstrike.com/en-us/cybersecurity-101/cyberattacks/kerberoasting/</a> <a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fnref-3-e35319" data-footnote-backref="" aria-label="Back to reference 3" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-4-e35319">
<p><a href="https://learn.microsoft.com/en-us/windows/win32/ad/service-principal-names" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/windows/win32/ad/service-principal-names</a> <a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fnref-4-e35319" data-footnote-backref="" aria-label="Back to reference 4" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-5-e35319">
<p><a href="https://github.com/GhostPack/Rubeus" target="_blank" rel="noopener noreferrer">https://github.com/GhostPack/Rubeus</a> <a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fnref-5-e35319" data-footnote-backref="" aria-label="Back to reference 5" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-6-e35319">
<p><a href="https://hashcat.net/wiki/" target="_blank" rel="noopener noreferrer">https://hashcat.net/wiki/</a> <a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fnref-6-e35319" data-footnote-backref="" aria-label="Back to reference 6" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-7-e35319">
<p><a href="https://www.semperis.com/blog/protecting-active-directory-from-kerberoasting/" target="_blank" rel="noopener noreferrer">https://www.semperis.com/blog/protecting-active-directory-from-kerberoasting/</a> <a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fnref-7-e35319" data-footnote-backref="" aria-label="Back to reference 7" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-8-e35319">
<p><a href="https://www.microsoft.com/en-us/security/blog/2024/10/11/microsofts-guidance-to-help-mitigate-kerberoasting/" target="_blank" rel="noopener noreferrer">https://www.microsoft.com/en-us/security/blog/2024/10/11/microsofts-guidance-to-help-mitigate-kerberoasting/</a> <a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fnref-8-e35319" data-footnote-backref="" aria-label="Back to reference 8" class="data-footnote-backref">↩</a> <a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fnref-8-e35319-2" data-footnote-backref="" aria-label="Back to reference 8-2" class="data-footnote-backref">↩<sup>2</sup></a></p>
</li>
<li id="user-content-fn-9-e35319">
<p><a href="https://cymulate.com/cybersecurity-glossary/kerberoasting/" target="_blank" rel="noopener noreferrer">https://cymulate.com/cybersecurity-glossary/kerberoasting/</a> <a href="https://www.dariocruz.dev/blog/Kerberoasting-Explained#user-content-fnref-9-e35319" data-footnote-backref="" aria-label="Back to reference 9" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section>]]></content>
        <author>
            <name>Dario Cruz</name>
            <uri>https://github.com/dario-cruz</uri>
        </author>
        <category label="Kerberos" term="Kerberos"/>
        <category label="Kerberoasting" term="Kerberoasting"/>
        <category label="Active-Directory" term="Active-Directory"/>
        <category label="Rubeus" term="Rubeus"/>
        <category label="Hashcat" term="Hashcat"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[RogueOne (HTB-Sherlocks)]]></title>
        <id>https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks</id>
        <link href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks"/>
        <updated>2024-11-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[RogueOne]]></summary>
        <content type="html"><![CDATA[<p><img decoding="async" loading="lazy" alt="RogueOne" src="https://www.dariocruz.dev/assets/images/b7497376cdde03305e1abce7fddc155c-46f9b4b23dbca91da80c156be8a98e0d.png" width="1024" height="1024" class="img_ev3q">
It's that time again, lets dig into another investigation, this time it looks like we will be digging into memory forensics. 🕵️‍♂️🤓🔎</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scenario">Scenario<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#scenario" class="hash-link" aria-label="Direct link to Scenario" title="Direct link to Scenario">​</a></h2>
<blockquote>
<p>Your SIEM system generated multiple alerts in less than a minute, indicating potential C2 communication from Simon Stark's workstation. Despite Simon not noticing anything unusual, the IT team had him share screenshots of his task manager to check for any unusual processes. No suspicious processes were found, yet alerts about C2 communications persisted. The SOC manager then directed the immediate containment of the workstation and a memory dump for analysis. As a memory forensics expert, you are tasked with assisting the SOC team at Forela to investigate and resolve this urgent incident.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-c2-communications">What are C2 communications<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#what-are-c2-communications" class="hash-link" aria-label="Direct link to What are C2 communications" title="Direct link to What are C2 communications">​</a></h3>
<p>This term is new to me, so time to do some research to gain more context into the event. After doing some googling I found that C2 just stands for <strong>Command &amp; Control</strong>, meaning that the computer is potentially compromised and could be part of a botnet. Yikes!😬</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-provided-files">The Provided Files<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#the-provided-files" class="hash-link" aria-label="Direct link to The Provided Files" title="Direct link to The Provided Files">​</a></h3>
<p>For this investigation the zip file is 1gig in size. Looks like we will be sifting through a lot of data. The file stored inside of the zip file is a <code>.mem</code> file, which I have not used before but, makes sense as in the given scenario, it's stated that a memory dump is provided for analysis.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="memory-analysis-software-volatility">Memory Analysis Software (Volatility)<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#memory-analysis-software-volatility" class="hash-link" aria-label="Direct link to Memory Analysis Software (Volatility)" title="Direct link to Memory Analysis Software (Volatility)">​</a></h3>
<p>I looked into the different types of software used by SOC teams, to analyze <code>.mem</code> files and I came across <strong><a href="https://volatilityfoundation.org/" target="_blank" rel="noopener noreferrer">Volatility Framework</a></strong>, an open-source tool that is used for memory forensics. I went ahead and followed the instructions on the <a href="https://github.com/volatilityfoundation/volatility3" target="_blank" rel="noopener noreferrer">github page</a> for installing the needed dependencies(python3) and Volatility 3 on a Linux VM.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/1c6cfe1f2b558f44b8954e21d9026899-b215cf557b2b98bcc8afd5e634372726.png" width="1080" height="823" class="img_ev3q">
I also needed to create a python virtual environment for use for volatility. Python virtual environments are used to isolate dependencies for projects, instead of installing dependencies globally, which is messy and could cause issues down the road. I went ahead and attempted to create and environment using the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python3 -m venv venv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I was met with the following message that I did not have the needed package installed, <code>python3.12-venv</code>.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/c33f60c71254c640e86a1eedeb33c673-4997551a47e8cc328e8c699e09a385bd.png" width="639" height="194" class="img_ev3q">
I used the command provided along with <code>sudo</code> to install the needed package.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo apt install python3.12-venv -y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we need to activate the python environment via the following command.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">source venv/bin/active</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Our virtual python environment should now be active, you can observe this via the terminal output, which now includes <code>(venv)</code>.</p>
<p><img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/9b88a37ccd953430bd050a39b6eca3d5-69ce58f4163a23e78eba5c2421182e40.png" width="1055" height="445" class="img_ev3q">
And finally, as you can see from the image above, we can now run volatility commands.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1--2">Task 1 &amp; 2<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#task-1--2" class="hash-link" aria-label="Direct link to Task 1 &amp; 2" title="Direct link to Task 1 &amp; 2">​</a></h2>
<ol>
<li><strong>Please identify the malicious process and confirm process id of malicious process.</strong></li>
<li><strong>The SOC team believe the malicious process may spawned another process which enabled threat actor to execute commands. What is the process ID of that child process?</strong></li>
</ol>
<p>So now that we have volatility3 installed and running we can run commands to accomplish various functions. Doing <code>python vol.py -h</code> brings up the following output.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/44510b5da4eace402c27bfcc93173016-58688ffa8936626aaa6014e08b5a218e.png" width="1267" height="871" class="img_ev3q">
Which provides a useful list of flags, arguments and parameters that can be used with the command line utility. The flag, <code>-f</code> allows for specifying of a file to process and analyze, this then must be followed with a value for the plugin to be used on the file. In the case of this question we need to look at the processes that were running on the machine at the time the SOC team was alerted and captured a memory dump of the affected machine. Looking at the list of plugins available from the fresh install, I can see that there is a plugin called <code>windows.pslist</code>, which allows listing of processes that are present in the target windows memory image.
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="709" height="47" class="img_ev3q">
So now we craft the final command to get the processes, we call python to run <code>vol.py</code>, adding the <code>-f</code> flag and specifying the target file which is, in my case located on an attached folder share to the VM. File path to the memory dump we need to analyze for this lab is <code>/media/sf_D_DRIVE/HTB-Sherlocks/RogueOne/20230810.mem</code>. Then we envoke the plugin we need, so that we can get the intended output, <code>windows.pslist</code>.
The final command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python vol.py -f /media/sf_D_DRIVE/HTB-Sherlocks/RogueOne/20230810.mem windows.pslist</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Running the command gives us a list of all of the processes, that of which there are many.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/f73d3623f999398cba988e8e108c8f17-7e6f11afe42d531d63d8cc28629a1768.png" width="1069" height="375" class="img_ev3q"></p>
<p>I went ahead and ran the program again by this time piping the output to a text file that could be searched through and analyzes in greater detail.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python vol.py -f /media/sf_D_DRIVE/HTB-Sherlocks/RogueOne/20230810.mem windows.pslist &gt; pslist_output.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After running the above command we can now use the <code>cat</code> and <code>grep</code> command line utilities to display and filter the content contained within the created text file.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/93dab0d3f29187c9af4bbcd192fba855-90e04eede9ec4af7da8757234f5c3fa2.png" width="1079" height="234" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="investigating-the-output">Investigating the Output<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#investigating-the-output" class="hash-link" aria-label="Direct link to Investigating the Output" title="Direct link to Investigating the Output">​</a></h3>
<p>Looking through the list of processes there are no processes that are named suspiciously at first glance. We do have two <em>Process ID (PID)</em> rows though, one for regular PID values and a second for a <em>Parent Process ID (PPID)</em> which are processes that have been spawned from other running processes. Threat actors may do what is called, <em><strong>Living off The Land (LOTL)</strong></em> which is a technique that allows threat actors obfuscate there activity and avoid detection via using the software included in the operating system and whatever applications the user has installed that may be vulnerable.</p>
<p>Taking all of that into account, if we look toward the bottom of the pslist_output file, we can see two processes for <code>cmd.exe</code>, the running of command prompt it's self is not a red flag, though normal end-users for the most part will not be launching that application on a regular basis. The red flag in this case are the parent processes that have spawned both instances of <code>cmd.exe</code>.  Lets use both the <code>cat</code> &amp; <code>grep</code> cmd line utilities to filter the <code>pslist_output.txt</code> file and gain more insight.</p>
<p><img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/0e1833acfc3625b76a9b214831a82653-44dc30944eb44b85fbca60f42e813815.png" width="974" height="78" class="img_ev3q">
Using <code>cat</code> to display the output and <code>grep</code> to filter for <code>cmd.exe</code> we can see that the parent PID's, which are <code>936</code> &amp; <code>6812</code>. Filtering for both of these PIDs brings up two distinct <code>svchost.exe</code> processes.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/14c8875f85526f3ba123314eaf00b7dc-7eb883599f05c3f0e752fd08e1143100.png" width="1241" height="156" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="svchostexe">svchost.exe<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#svchostexe" class="hash-link" aria-label="Direct link to svchost.exe" title="Direct link to svchost.exe">​</a></h3>
<p>Digging into the information on the svchost process, I found that it's known as the Service Host. It is an integral system process for the Windows Operating system and acts as a host/manager for <em>DLL-Based</em> Windows Services. Essentially is manages <strong>background</strong> services allowing the OS to run efficiently.</p>
<p>I also found that <code>svchost.exe</code> spawning the <code>cmd.exe</code> process is not considered to be normal behavior for the process and is a clear indicator of compromise. Also when filtering for all of the <code>svchost.exe</code> processes, they all share the same <em>PPID</em> except for the <code>svchost.exe</code> processes that spawned <code>cmd.exe</code>.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/e4e62b1fde93578999bc8d15e4a71640-9f0809b5ab4b96ff6f471d86164a3b1b.png" width="1260" height="442" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-answers">The Answers<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#the-answers" class="hash-link" aria-label="Direct link to The Answers" title="Direct link to The Answers">​</a></h3>
<p>So now that we have done our investigation and analysis of the processes that were running at the time of detection, we can answer the questions in both Task 1 and in Task 2.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="please-identify-the-malicious-process-and-confirm-process-id-of-malicious-process">Please identify the malicious process and confirm process id of malicious process.<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#please-identify-the-malicious-process-and-confirm-process-id-of-malicious-process" class="hash-link" aria-label="Direct link to Please identify the malicious process and confirm process id of malicious process." title="Direct link to Please identify the malicious process and confirm process id of malicious process.">​</a></h4>
<p>The malicious process in this case is the <code>svchost.exe (6812)</code> process that spawned the <code>cmd.exe (4364)</code>. Since they ask for the process ID as input, it would be <strong>6812</strong>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-soc-team-believe-the-malicious-process-may-spawned-another-process-which-enabled-threat-actor-to-execute-commands-what-is-the-process-id-of-that-child-process">The SOC team believe the malicious process may spawned another process which enabled threat actor to execute commands. What is the process ID of that child process?<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#the-soc-team-believe-the-malicious-process-may-spawned-another-process-which-enabled-threat-actor-to-execute-commands-what-is-the-process-id-of-that-child-process" class="hash-link" aria-label="Direct link to The SOC team believe the malicious process may spawned another process which enabled threat actor to execute commands. What is the process ID of that child process?" title="Direct link to The SOC team believe the malicious process may spawned another process which enabled threat actor to execute commands. What is the process ID of that child process?">​</a></h4>
<p>That would be the child process, that <code>svchost.exe</code> spawned, the <code>cmd.exe</code> process that has a PID of <strong>4364</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3">Task 3<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#task-3" class="hash-link" aria-label="Direct link to Task 3" title="Direct link to Task 3">​</a></h2>
<ul>
<li><strong>The reverse engineering team need the malicious file sample to analyze. Your SOC manager instructed you to find the hash of the file and then forward the sample to reverse engineering team. What's the md5 hash of the malicious file?</strong></li>
</ul>
<p>We need to get the MD5 hash of the malicious <code>svchost.exe</code> file. I ran volatility3 with the <code>-h </code> flag so that I could see all the the options and plugins available. I narrowed down the search using <code>grep</code> to filter for any occurrences of the the word <em>file</em>. This should provide a function/plugin that will allow us to see the files in the filesystem of the memory dump file.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/6935a0a188447c883cd228b6caf27b95-444883691f47cef9ae1b1990f1af7074.png" width="1269" height="719" class="img_ev3q">
Looks there is a function/plugin called <strong>windows.filescan</strong>, which after some research, I found that it allows for listing of all file objects that were found in memory at the time of the dump.
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="754" height="44" class="img_ev3q"></p>
<p>Using this function/plugin, along with <code>grep</code> filter the output and place it into a text file, using the command below.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python vol.py -f python vol.py -f /media/sf_D_DRIVE/HTB-Sherlocks/RogueOne/20230810.mem windows.filescan | grep svchost.exe &gt; svchost_filescan.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Looking through the <code>svchost_filescan.txt</code> I can clearly see an <code>svchost.exe</code> file located in a folder that is not in the Windows directory, located in a the user, <strong>simon-stark's</strong>, downloads folder.<br>
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/cfacd4ebc59a847c0d68e88631284832-6a4b8ff5c9ea9d57ab2115cb3234fbfb.png" width="484" height="205" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="file-extraction">File Extraction<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#file-extraction" class="hash-link" aria-label="Direct link to File Extraction" title="Direct link to File Extraction">​</a></h3>
<p>We now know the location of the malicious file but, are we able to extract it out of the memory dump file? Does volatility3 have the functionality to do this? The answer to both questions is <strong>yes</strong>.</p>
<p>When I was looking up functions/plugins to use in order to list all of the files in the memory dump, I cam across the plugin <code>windows.dumpfiles</code>.
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="628" height="43" class="img_ev3q">
Now we craft the complete command so that we can extract the file out of the memory dump.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python vol.py -f /media/sf_D_DRIVE/HTB-Sherlocks/RogueOne/20230810.mem windows.dumpfiles --pid 6812 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/70e28cecde09008eaf409e635b544e84-22eefeeb09015f6f34ceed4c21f3298e.png" width="903" height="781" class="img_ev3q">
Above you can see that the <code>svchost.exe</code> was dumped out an an <code>.img</code> file, along with the DLLs that the application must have been accessing to run. The <code>.img</code> file is a raw dump format that is a binary blob of the file as it appeared in memory at the time of capture.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hashing">Hashing<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#hashing" class="hash-link" aria-label="Direct link to Hashing" title="Direct link to Hashing">​</a></h3>
<p>Now that we have the image file of the malicious file we need to get a hash of the file to provide to the reverse engineering team mentioned in the task. To do this we can use the pre-installed <strong>md5sum</strong> command line utility. Most distributions of Linux have this utility installed by default as a part of the GNU Core Utilities package.</p>
<p>The command used to get the md5sum is as follows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">md5sum file.0x9e8b91ec0140.0x9e8b957f24c0.ImageSectionObject.svchost.exe.img</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Which gives use the output, containing the MD5 hash and the filename. The hash being <strong>5bd547c6f5bfc4858fe62c8867acfbb5</strong>, which is the answer to Task 3.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4">Task 4<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#task-4" class="hash-link" aria-label="Direct link to Task 4" title="Direct link to Task 4">​</a></h2>
<ul>
<li><strong>In order to find the scope of the incident, the SOC manager has deployed a threat hunting team to sweep across the environment for any indicator of compromise. It would be a great help to the team if you are able to confirm the C2 IP address and ports so our team can utilize these in their sweep.</strong></li>
</ul>
<p>This task requires us to dig into the <code>windows.netscan</code> plugin that is pre-installed with Volatility3. With the Linux Mint VM that I had setup, volatility was not detecting that the memory dump file had data that could be scanned with the plugin, so I created a new VM and installed Kali Purple, which is a Linux distro targeted at purple/blue team use, which is more suitable for carrying out investigations and also has a lot of SOC Analyst software pre-installed.</p>
<p>I believe now, after looking into the situation, that the file had been only partially extracted from the archive, the memory dump that I was accessing with volatility3 was only 2.7gb in size, with the file in kali purple, after fully being extracted from the archive, was around 4gb in size. Whoops!😝</p>
<p>So, here is the truncated output.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/6b7a134109b41851933036b02589823d-58d93ddf0d599096ecedd5eadd8eadc5.png" width="1197" height="802" class="img_ev3q">
The first thing that jumps out to be is a connection to an IP address, <strong>13.127.155.166</strong> with the port <strong>8888</strong>.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/9227a23fead3b17a69b2c8fc5aef4eee-86e161a19875148a1e1c7cb030e6946c.png" width="1157" height="19" class="img_ev3q">
From what I know about services, networking, and ports, and from running some services on home server, port 8888 is used for some self-hosted services. I did some research on the port and what it has been historically used for. <a href="https://whatportis.com/ports/8888_http-web-interface-alternative" target="_blank" rel="noopener noreferrer">WhatPortIs.com</a> states that the port is commonly used for http &amp; https traffic as an alternative port, if there are multiple services providing http/https functionality. <a href="https://www.speedguide.net/port.php?port=8888" target="_blank" rel="noopener noreferrer">SpeedGuide.net</a> states that the port is used for <em>"allhttpd"</em> but, also states that it could be related to malware and trojans, things are looking fishy 🐟.</p>
<p>Moving on to the IP address, I did some research on websites that contained databases of IP addresses that could be associated with botnets &amp; C2 Command and Control servers. I landed at <a href="https://talosintelligence.com/reputation_center/" target="_blank" rel="noopener noreferrer">Cisco Talos</a>, which allows  for searching of IP addresses, providing information on if the IP address has been used in malicious acts, exactly what we need.</p>
<p>The search itself did not turn up anything of note, IP address originates from Mumbai, India bit the IP address is rated as neutral in nature.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/3b792a7166d7d200f514d24bceba9884-b7ca872896b6ae7f21c586043f843fe8.png" width="619" height="694" class="img_ev3q"></p>
<p>Judging from this entry being the only entry from an <code>svchost.exe</code> process and it's the only one to be connecting to a foreign IP on a non-standard port, we should be on the right track. I went ahead and entered the IP found and port,  <strong>13.127.155.166:8888</strong>. This turned out to be the correct answer.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/99175462031af18f1aab198ba46a4b26-b1abc7ae9a4496342cba1dc9feec1bcc.png" width="695" height="240" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-5">Task 5<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#task-5" class="hash-link" aria-label="Direct link to Task 5" title="Direct link to Task 5">​</a></h2>
<ul>
<li><strong>We need a timeline to help us scope out the incident and help the wider DFIR team to perform root cause analysis. Can you confirm time the process was executed and C2 channel was established?</strong>
To get the answer for this task we can look at the time that the connection was established. In the previous question we used the <code>windows.netstat</code> volatility plugin to get a list of connections that were established leading up to the event. It also provided us with timestamps for when these connections took place.</li>
</ul>
<p><img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/9227a23fead3b17a69b2c8fc5aef4eee-86e161a19875148a1e1c7cb030e6946c.png" width="1157" height="19" class="img_ev3q">
Looking back at the above image, we can see that the time of connection to the C2 server was at <strong>10/08/2023 11:30:03</strong>. Note that we could have also gotten this answer via using the <code>windows.pstree</code> plugin, which allows for checking of parent-child relationships and provides timestamps as to when processes where initially executed.<br>
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/c3f278d2c5df55ab1478fa8cc66d6897-0e8c1e495865b1ed1188f2dc9b6787ea.png" width="1260" height="175" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-6">Task 6<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#task-6" class="hash-link" aria-label="Direct link to Task 6" title="Direct link to Task 6">​</a></h2>
<ul>
<li><strong>What is the memory offset of the malicious process?</strong>
The offset can be found via the above mentioned <code>windows.pstree</code>. It allows us to see, as mentioned before, parent-child relationships and when a process was executed. Looking at the malicious <code>svchost.exe</code> that after being launched created a child <code>cmd.exe</code> process, we can get the offset of the malicious file, which is <strong>0x9e8b87762080</strong>.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/89793110be8d531f657bd7a4ab07cc4e-95020871d9df7e914c69569ba5004c5a.png" width="1260" height="175" class="img_ev3q"></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-7">Task 7<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#task-7" class="hash-link" aria-label="Direct link to Task 7" title="Direct link to Task 7">​</a></h2>
<ul>
<li><strong>You successfully analyzed a memory dump and received praise from your manager. The following day, your manager requests an update on the malicious file. You check VirusTotal and find that the file has already been uploaded, likely by the reverse engineering team. Your task is to determine when the sample was first submitted to VirusTotal.</strong>
Nice, okay so we can use the hash of the malicious <code>svchost.exe</code> file that we gathered as the result of [[#Task 3]], which was <strong>5bd547c6f5bfc4858fe62c8867acfbb5</strong>. So, we load up <a href="https://www.virustotal.com/gui/home/search" target="_blank" rel="noopener noreferrer">VirusTotal</a> and navigate to search and input the hash.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/3c2a636693291df9c1b033fe703081ae-d895f68b275e267078fd22d0f6516c6b.png" width="854" height="732" class="img_ev3q"></li>
</ul>
<p>And we get a result, the file indeed is on virustotal, and is indeed malicious in nature, as we have already confirmed.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/f8712dc71fd8059bfe677e388f5af5a5-39e72fb5a33795d998d71c5d8bc0ce9d.png" width="1373" height="849" class="img_ev3q"></p>
<p>Navigating to the details section of the entry in virustotal, and it looks like the file was first submitted on <strong>2023-08-10 11:58:10 UTC</strong>. 🎉
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/1b05997badd8edc600002d09da18a9dd-6342c57086d0a498eafe33cd3c0e79ec.png" width="510" height="462" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-takeaways">Key Takeaways<a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks#key-takeaways" class="hash-link" aria-label="Direct link to Key Takeaways" title="Direct link to Key Takeaways">​</a></h2>
<ul>
<li>The volatility framework is a powerful tool in memory forensics that can be used on Windows, Mac, &amp; Linux.</li>
<li>Volatility has a host of plugins that work with supported Operating Systems, allowing for in depth memory analysis and investigation.</li>
<li>Capturing images of a compromised systems filesystem and memory is a critical component in the incident response process, providing ways to investigate possible compromised machines, without the need to keep them on the network.</li>
<li>Cisco Talos is a repository of IP address information. Providing insights on if a particular IP address is a part of a botnet or has been used in malicious activities.</li>
</ul>]]></content>
        <author>
            <name>Dario Cruz</name>
            <uri>https://github.com/dario-cruz</uri>
        </author>
        <category label="Hackthebox" term="Hackthebox"/>
        <category label="Labs" term="Labs"/>
        <category label="Incident-Response" term="Incident-Response"/>
        <category label="Volatility" term="Volatility"/>
        <category label="Hashing" term="Hashing"/>
        <category label="Virustotal" term="Virustotal"/>
        <category label="Memory-Forensics" term="Memory-Forensics"/>
        <category label="Python" term="Python"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Noxious (HTB-Sherlocks)]]></title>
        <id>https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks</id>
        <link href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks"/>
        <updated>2024-10-31T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Noxious]]></summary>
        <content type="html"><![CDATA[<p><img decoding="async" loading="lazy" alt="Noxious" src="https://www.dariocruz.dev/assets/images/98966c960819afc7d536fa03a8d5918d-a5f0db3dee205c8b252f46e65947c876.webp" width="1024" height="1024" class="img_ev3q">
Okay, lets get back into it! Time for another Sherlock investigation.🕵️‍♂️</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scenario">Scenario<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#scenario" class="hash-link" aria-label="Direct link to Scenario" title="Direct link to Scenario">​</a></h2>
<blockquote>
<p>The IDS device alerted us to a possible rogue device in the internal Active Directory network. The Intrusion Detection System also indicated signs of LLMNR traffic, which is unusual. It is suspected that an LLMNR poisoning attack occurred. The LLMNR traffic was directed towards Forela-WKstn002, which has the IP address 172.17.79.136. A limited packet capture from the surrounding time is provided to you, our Network Forensics expert. Since this occurred in the Active Directory VLAN, it is suggested that we perform network threat hunting with the Active Directory attack vector in mind, specifically focusing on LLMNR poisoning.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-files">The Files<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#the-files" class="hash-link" aria-label="Direct link to The Files" title="Direct link to The Files">​</a></h2>
<p>Okay so in the zip file for the Sherlock we have a single <code>.pcap</code> file which means we will be flexing our Wireshark/TCPdump skills in this investigation.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1">Task 1<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#task-1" class="hash-link" aria-label="Direct link to Task 1" title="Direct link to Task 1">​</a></h2>
<p><strong>Its suspected by the security team that there was a rogue device in Forela's internal network running responder tool to perform an LLMNR Poisoning attack. Please find the malicious IP Address of the machine.</strong></p>
<p>Hmmmm, okay so the acronym LLMNR is new to me, so it's time to educate myself on that it means, and also how it can be used by a threat actor that has access to an organizations network.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="link-local-multicast-name-resolution">Link-Local Multicast Name Resolution<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#link-local-multicast-name-resolution" class="hash-link" aria-label="Direct link to Link-Local Multicast Name Resolution" title="Direct link to Link-Local Multicast Name Resolution">​</a></h3>
<p>So, it's a network protocol, and it's based on the DNS packet format. It allows both IPv4 and IPv6 hosts and devices to perform name resolution on the same network link. <sup><a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#user-content-fn-1-1b8274" id="user-content-fnref-1-1b8274" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-llmnr-works">How LLMNR works<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#how-llmnr-works" class="hash-link" aria-label="Direct link to How LLMNR works" title="Direct link to How LLMNR works">​</a></h3>
<p>Okay so digging deeper into how the protocol works, so that we know what the normal baseline behavior should be, looking at this image <sup><a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#user-content-fn-3-1b8274" id="user-content-fnref-3-1b8274" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup> it looks like LLMNR works similar to DNS, meaning that a central server is responsible for requests, this means that any deviation in where requests are sent and responded to, should provide us with information on the machine that is on the network carrying out the attack.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="llmnr-poisoning-attacks">LLMNR Poisoning Attacks<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#llmnr-poisoning-attacks" class="hash-link" aria-label="Direct link to LLMNR Poisoning Attacks" title="Direct link to LLMNR Poisoning Attacks">​</a></h4>
<p>How can LLMNR be poisoned? How can it be used to attack a system? According to <a href="https://attack.mitre.org/techniques/T1557/001/" target="_blank" rel="noopener noreferrer">this article</a> from MITRE, adversaries will spoof and present themselves as an authoritative source for name resolution, allowing for the threat actor to collect and/or relay authentication data. Yikes! Threat actors will respond to LLMNR requests as though they know the identity of the requested host, poisoning the service and getting the victims to communicate with the threat actor controlled system.</p>
<p>The goal of the attack is to collect hashes used in authentication which could be used for cracking of the hashes via offline brute forcing, leading to the obtaining of account passwords. <sup><a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#user-content-fn-2-1b8274" id="user-content-fnref-2-1b8274" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="detection">Detection<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#detection" class="hash-link" aria-label="Direct link to Detection" title="Direct link to Detection">​</a></h5>
<p>Lucky for us, on the same page of this article MITRE provides information on how to detect the incident. More specifically, since we only have access to the pcap of the security incident and not the Windows logs of the machines affected, we can narrow our focus to the Network Traffic data source.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/c3788c4419312e5e98f8d09f444eec49-b27d8e42f04faed9531dc21435e1833d.png" width="1413" height="387" class="img_ev3q"></p>
<ul>
<li>Monitor network traffic on UDP Ports <strong>5355</strong> and UDP <strong>137</strong>, if LNMR is disabled via security policy.</li>
<li>Monitor network traffic originating from <strong>unknown/unexpected hardware devices</strong>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="investigating-further">Investigating Further<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#investigating-further" class="hash-link" aria-label="Direct link to Investigating Further" title="Direct link to Investigating Further">​</a></h3>
<p>Okay so now it's time to open up that <code>.pcap</code> file and start the investigation, we are looking for the IP address of the machine that is carrying out the LLNMR poisoning attack. From our enumeration and information gathering, we know that the ports to check are UPD <strong>5355</strong> &amp; <strong>137</strong>, so in Wireshark we will filter for that starting with port <strong>5355</strong>, <code>upd.port == 5355</code>.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/18d67820bd23ef498df0f0a320f36188-1147edd91766857532b3ae38a153d816.png" width="1920" height="991" class="img_ev3q"></p>
<p>Looking at the above image we can see a series of normal requests to the DC01 server, the server is processing the requests form machines on the network as normal.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/a383e27f6efbf38856dc340316101c9c-a6b6d92cdad4b8117fbf262cfb070056.png" width="1851" height="359" class="img_ev3q">
Scrolling down further reveals some intriguing network traffic.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/f4a3b2fb2aa22e9af2a861ed56780442-c98084d7293bae043f89b1a0ee26523f.png" width="1618" height="351" class="img_ev3q">
Towards the end of the pcap file we can see that query responses are no longer coming from the DC01 server. Query responses are now being handled by <strong>172.17.79.135</strong>, which is the IP address needed answer the task question.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2">Task 2<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#task-2" class="hash-link" aria-label="Direct link to Task 2" title="Direct link to Task 2">​</a></h2>
<p><strong>What is the hostname of the rogue machine?</strong>
Okay so now that we know the IP address of the machine that is carrying out the LLMNR poisoning attack, it should be easy to find the hostname of the machine.</p>
<p>Taking what we have learned form the MITRE information on LLMNR poisoning attacks and how they are carried out, we know we can use DHCP to potentially find information on the threat actor machine. So, back into Wireshark we go, filtering for the IP address that we have found and narrowing down the search by scoping down to only DHCP protocol activity. With that we get 3 network events.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/7bb19b78cc05701747389245c7de9e40-c0d7a9ce85203559cef953d613acfd17.png" width="1295" height="828" class="img_ev3q">
With the 3 log events we can see that there was a DHCP request from this IP address. and digging into the log details we see that there is a field for the hostname of the requesting computer, in this case the threat actors machine hostname is <strong>kali</strong>. (Kali Linux bby!😎)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3">Task 3<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#task-3" class="hash-link" aria-label="Direct link to Task 3" title="Direct link to Task 3">​</a></h2>
<p><strong>Now we need to confirm whether the attacker captured the user's hash and it is crackable!! What is the username whose hash was captured?</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="llmnr-poisoning-and-hashes">LLMNR Poisoning and Hashes<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#llmnr-poisoning-and-hashes" class="hash-link" aria-label="Direct link to LLMNR Poisoning and Hashes" title="Direct link to LLMNR Poisoning and Hashes">​</a></h3>
<p>Okay so how are LLMNR attacks related to password hashes and the cracking of them? For this lets go back to the MITRE documentation on the attack. Reading through the material, I found this snippet that explains how hashes can be obtained as a result LLMNR poisoning attacks:</p>
<blockquote>
<p>(After initial LLMNR poisoning has been carried out.) &nbsp;If the requested host belongs to a resource that requires identification/authentication, the username and NTLMv2 hash will then be sent to the adversary controlled system. The adversary can then collect the hash information sent over the wire through tools that monitor the ports for traffic or through&nbsp;<a href="https://attack.mitre.org/techniques/T1040" target="_blank" rel="noopener noreferrer">Network Sniffing</a>&nbsp;and crack the hashes offline through&nbsp;<a href="https://attack.mitre.org/techniques/T1110" target="_blank" rel="noopener noreferrer">Brute Force</a>&nbsp;to obtain the plaintext passwords.</p>
</blockquote>
<p>and also...</p>
<blockquote>
<p>In some cases where an adversary has access to a system that is in the authentication path between systems or when automated scans that use credentials attempt to authenticate to an adversary controlled system, the NTLMv1/v2 hashes can be intercepted and relayed to access and execute code against a target system.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="further-investigation">Further investigation<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#further-investigation" class="hash-link" aria-label="Direct link to Further investigation" title="Direct link to Further investigation">​</a></h3>
<p>Okay so now that we know that the threat actor could potentially be exploiting LLMNR to carry out poisoning and a man-in-the-middle attack to obtain hashes and crack those hashes and attempt to login to a compromised account via NTLM, we will look for indicators of such via further Wireshark filtering.</p>
<p>First lets filter for NTLM traffic, and oh boy we find some clear indicators...
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/6f2b4a46c29981f672959dcf23e6c878-8d337554b4aa0b8f7a3f09579c7c6af4.png" width="1614" height="550" class="img_ev3q">
Looks like we are getting some brute force traffic on the SMB port 412 and also multiple session setup requests on the user account <strong>Forela\john.deacon</strong>, the final answer to the task question being <strong>john.deacon</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4">Task 4<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#task-4" class="hash-link" aria-label="Direct link to Task 4" title="Direct link to Task 4">​</a></h2>
<p><strong>In NTLM traffic we can see that the victim credentials were relayed multiple times to the attacker's machine. When were the hashes captured the First time?</strong></p>
<p>Pretty straight forward, as we have already filtered for smb2 traffic. We can look at the time stamps and check for the first instance of the <strong>john.deacon</strong> user account hash being brute forced over the network.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/9b045d4bb6e5bb04be25707e2764e016-9958f90ea3572abfe7aa6b9717dd398a.png" width="1919" height="513" class="img_ev3q">
The brute forcing of the hash for user account john.deacon took place on <strong>2024-06-24 11:18:30</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-5">Task 5<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#task-5" class="hash-link" aria-label="Direct link to Task 5" title="Direct link to Task 5">​</a></h2>
<p><strong>What was the typo made by the victim when navigating to the file share that caused his credentials to be leaked?</strong></p>
<p>Okay so we have information that the user john.deacon made a typo in the SMB share why does this matter and how did it leak the credentials of the users account? This probably has to do with the LNMRR poisoning as smb share hostnames are resolved to IP addresses and where does that resolution happen, via DNS and in this case with the dual IP addressing protocol nature of the network, LNMRR. So lets take a look at those network logs.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/71571c0f74f8ccfe49260398944ce1a3-a103ba473e7fbf040e250d188a3af648.png" width="1912" height="296" class="img_ev3q">
So we see some broadcast traffic of the server DC01 announcing it's presence. SMB servers have a feature that allows them to advertise their presence on a local network, for security this should probably be disabled as it allows threat actors to enumerate smb servers and shares and potentially exploit them.</p>
<p>Looking back at the network logs of the LLNMR attack, we can see that the victim that had their credentials compromised had mistakenly typed the hostname <strong>DCC01</strong> when attempting to access the smb server/shares.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/028970dab294f9334460114d0d6aae4a-41b79639afc460e3d4833dba04e5521f.png" width="1913" height="489" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-6">Task 6<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#task-6" class="hash-link" aria-label="Direct link to Task 6" title="Direct link to Task 6">​</a></h2>
<p><strong>To get the actual credentials of the victim user we need to stitch together multiple values from the ntlm negotiation packets. What is the NTLM server challenge value?</strong></p>
<p>For this one a roped in ChatGPT for some clarification on the NTLM protocol and the structure of it's packets. The task charges us with finding the <em>server challenge value</em> and that, <em>"To get the actual credentials of the victim we need to stich together multiple values from the NTLM negotiation packets"</em>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="educating-myself-with-chatgpt">Educating myself with ChatGPT<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#educating-myself-with-chatgpt" class="hash-link" aria-label="Direct link to Educating myself with ChatGPT" title="Direct link to Educating myself with ChatGPT">​</a></h3>
<p>I prompted ChatGPT with the following message:</p>
<blockquote>
<p>Explain the structure of ntlm negotiation packets. The context for this task is that I am investigation a security incident, and I need to obtain the NTLM server challenge value that the threat actor obtained.</p>
</blockquote>
<p>And ChatGPT proceeded to give me a wealth of information. More specifically, instructions on how to extract the server challenge value, nice! 😎</p>
<blockquote>
<p>[!NOTE] Steps to Extract the Server Challenge Value</p>
<ol>
<li><strong>Capture NTLM Traffic</strong>:<!-- -->
<ul>
<li>Use network monitoring tools like Wireshark to capture the traffic during the NTLM authentication process.</li>
<li>Apply filters in Wireshark to isolate NTLM packets. The filter <code>ntlmssp</code> can be used to find these packets specifically.</li>
</ul>
</li>
<li><strong>Locate the NTLM Challenge Message</strong>:<!-- -->
<ul>
<li>Look for the message with a type field of <code>0x00000002</code>, which indicates the NTLM challenge message.</li>
</ul>
</li>
<li><strong>Extract the Server Challenge</strong>:<!-- -->
<ul>
<li>The server challenge is located 8 bytes after the "Negotiate Flags" field.</li>
<li>In Wireshark, expand the NTLMSSP fields within the NTLM challenge message to locate the "Server Challenge".</li>
<li>The value will be a 64-bit (8-byte) hexadecimal number (e.g., <code>0xA1B2C3D4E5F6A7B8</code>).</li>
</ul>
</li>
<li><strong>Verify the Challenge</strong>:<!-- -->
<ul>
<li>Ensure that the challenge aligns with the expected structure, and cross-reference with other packets to see how the client responded using this challenge.</li>
</ul>
</li>
</ol>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-solution">The Solution<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#the-solution" class="hash-link" aria-label="Direct link to The Solution" title="Direct link to The Solution">​</a></h3>
<p>ChatGPT broke it down for me and now I have the details I need to hunt for the answer, NTLM has a series of steps for the authentication process, there are 3 different packets, which are the following, Negotiation Message, Challenge Message, and Authentication Message. The NTLM Challenge packets will be the ones that we are targeting.</p>
<p>Back to Wireshark we filter for <code>ntlmssp</code> packets and we can see the Challenge Message packets clearly.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/8ede64a723be6efcbf035f5c42c26d9a-6d06bee4875a009dc9535d6097d8eea7.png" width="1917" height="484" class="img_ev3q">
Looking at the first of the challenge packets details, scrolling down to the NTLM specific parts of the packet we can see the first challenge message, from when the threat actor carried out their brute force of the users account.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/c19eac34ce74fdc7565bc89136d0f1a8-f06dcb0d393718e81b03bf3a26c98aa8.png" width="843" height="462" class="img_ev3q">
The NTLM server challenge value for the first challenge packet is <strong>601019d191f054f1</strong>, which is the answer to the task question.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-7">Task 7<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#task-7" class="hash-link" aria-label="Direct link to Task 7" title="Direct link to Task 7">​</a></h2>
<p><strong>Now doing something similar find the NTProofStr value.</strong></p>
<p>Now our target is the NTProofStr value but, wait what is that? Looking back at the ChatGPT info there is no mention of this value in the information provided....</p>
<blockquote>
<p>[!NOTE] Hey ChatGPT what is NTProofStr in relation to the NTLM protocol?
Response:
<em>In the NTLM protocol, <strong><code>NTProofStr</code></strong> (often called <strong>NT Proof String</strong>) is a key component of the NTLMv2 authentication process. It is a critical part of the client's response during the authentication process, specifically in the <strong>NTLM Authenticate Message</strong>.</em></p>
</blockquote>
<p>Cool, so now we need to target and filter for the ntlm authentication packets and look for the value of the NTProofStr.</p>
<p>Looking at the packet that came right after the first ntlm challenge, we see an NTLM authentication packet, attempting to authenticate the user <code>john.deacon</code>.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/66614e4e754b222469292e72d086b1c0-a835ed50a54bc552a737fa6fe2a73bcf.png" width="683" height="81" class="img_ev3q">
Now looking at the details of the NTLM authentication packet, we see the response type, and also the NTProofStr value, which is <strong>c0cc803a6d9fb5a9082253a04dbd4cd4</strong>.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/f8993266c9ce839b99d6467353b06177-a59fe3871ea18562d13b26b76ab52d8b.png" width="889" height="452" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-8">Task 8<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#task-8" class="hash-link" aria-label="Direct link to Task 8" title="Direct link to Task 8">​</a></h2>
<p><strong>To test the password complexity, try recovering the password from the information found from packet capture. This is a crucial step as this way we can find whether the attacker was able to crack this and how quickly.</strong></p>
<p>So we need to recover the password? Well, okay lets research how to do that. ChatGPT comes into play again and I ask it the following:</p>
<blockquote>
<p>[!NOTE] How do threat actors crack user passwords using the NTLM protocol?
<em>Response Highlights:</em>
<strong>NTLM hashes</strong> are representations of the user’s password in hash form, which is used during authentication instead of the plaintext password. If an attacker can capture these hashes (e.g., through a network sniffing attack or by extracting them from compromised machines), they can attempt to crack them offline.</p>
<p>If an attacker captures the NTLM hash <code>aad3b435b51404eeaad3b435b51404ee:32ed87bdb5fbb310bc9ef504a40265b1</code>, they can attempt to use <strong>Hashcat</strong> with a wordlist to brute-force the plaintext password.</p>
</blockquote>
<p>Looks like we have to gather the hashes from the NTLM packets and attempt to crack them with <strong>Hashcat</strong>. I spun up a Linux VM and proceeded to install hash cat and look for wordlists to use.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/7623b54e81df73f9142230f9c26585b0-a7096e889de448aa5ad4e98785887d42.png" width="474" height="174" class="img_ev3q"></p>
<p>Running Hashcat for the first time with the -h flag(help menu) shows all the flags, parameters and how they can be used to crack hashes or complete other tasks. The list is expansive.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/4a3025330a06c9ec4502df86901a4953-8266025d16ea6fa52fe3ee66cc42a1bc.png" width="1033" height="873" class="img_ev3q"></p>
<p>Looking for wordlists I found this resource on github, <a href="https://github.com/gmelodie/awesome-wordlists" target="_blank" rel="noopener noreferrer">https://github.com/gmelodie/awesome-wordlists</a> and proceeded to download the <em>RockYou</em> password list as the description read, <em>The go-to wordlist for passwords</em>.</p>
<p>After getting the wordlists and hashcat installed I looked for some guidance on basic usage of the cli app and found an article on freecodecamp <a href="https://www.freecodecamp.org/news/hacking-with-hashcat-a-practical-guide/" target="_blank" rel="noopener noreferrer">https://www.freecodecamp.org/news/hacking-with-hashcat-a-practical-guide/</a>. The syntax we should use to brute force and find that password should be the following</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hashcat -m 0 -a0 hashes.txt rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cracking-ntlm">Cracking NTLM<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#cracking-ntlm" class="hash-link" aria-label="Direct link to Cracking NTLM" title="Direct link to Cracking NTLM">​</a></h3>
<p>I went ahead and created a folder that store the <code>rockyou.txt</code> and also the <code>hashes.txt</code> files. We need to gather the hashes from the <code>.pcap</code> file and place them in the hashes file so that
HashCat can process them and find a match.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ntlm-challenge-response">NTLM Challenge Response<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#ntlm-challenge-response" class="hash-link" aria-label="Direct link to NTLM Challenge Response" title="Direct link to NTLM Challenge Response">​</a></h4>
<p>After doing some research on the NTLM protocol and how threat actors exploit the way it works, in order to carry out <strong>Man-In-The-Middle</strong> attacks, I found that the NTLM Challenge Response is the field that contains the hash-based validation of the password, along with other information, like the <strong>NTProofStr</strong> value that we collected earlier.
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="889" height="123" class="img_ev3q">
So I gathered all the NTLMv2 response hashes from the packet capture file and stored in the <code>hashes.txt</code> file, so that they can be access an processed using hashcat.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/378feb9f0dafca90dc32f591543c00bc-1ce7d867b39d2f36ce5acf5e94f5076b.png" width="784" height="470" class="img_ev3q">
There was an issue though, when attempting to run hashcat on the file, with the proper syntax, hashcat was presenting me with errors about the hash format.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/df22b4700beeb6267e76528da7c68e44-a38cf84c59e9b514107e4e31f8dbe811.png" width="1062" height="439" class="img_ev3q">
Here is the syntax that I used after looking at the documentation for hashcat and the guide on how to use it, that I found on <a href="https://www.freecodecamp.org/news/hacking-with-hashcat-a-practical-guide/" target="_blank" rel="noopener noreferrer">freecodecamp</a>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hashcat -m 5600 -a 0 -o cracked.txt hashes.txt rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>The <code>-m 5600</code> flag and arg, tell hash cast to use the HMAC-MD5 hashing algorithm, which is the hashing method that NTLMv2 uses. The <code>-a 0</code> configures hashcat to carry out a normal Dictionary Attack using the provided wordlist in the <code>rockyou.txt</code> file. Lastly, the <code>-o</code> flag specifies where the results of the process should be stored, which is inside of the <code>cracked.txt</code> file.</em></p>
<p>I began to dig into what the cause of the issue was and see how I could correct the formatting. Doing google searches and ChatGPT queries. I came across this video, which detailed, how to obtain the NTLMv2 hash, along with other information that hashcat required, as well has how to format the file that stored the information. <em>Super useful!😄  Shoutout to <a href="https://www.youtube.com/@embracethered" target="_blank" rel="noopener noreferrer">Embrace The Red</a>🍻</em></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/lhhlgoMjM7o?si=Mx6wIhsMwPTYCJvz" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin"></iframe>
<p>Looks like the format of the content in the file needs to be structured via  the format:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">username::domain::challenge_value::HMAC-MD5_value::NTLMv2Resposne(Without fist 16 bytes)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So I created a new file <code>ntlm-hashes.txt</code> and typed out the needed format. Time to gather the data from the packet capture file.</p>
<p>First we need the <strong>NTLM Server Challenge</strong> value. Looking at the packet capture this would be the first packet that is sent to the NTLM server, by the client, requesting authentication and access. I my case I am targeting the first 3 packets in the capture file, after filtering for <code>ntlmssp</code>.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/6c9061d3c0d2e86f2e3f3ba97fcbb047-00d6a88fd861b4cee12910eaaaf77700.png" width="1080" height="158" class="img_ev3q">
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="527" height="99" class="img_ev3q">
Second, we need the <strong>NTLMv2 Response</strong>, which we find in the same packet further down the packet details, just like in our previous attempt.
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="576" height="163" class="img_ev3q">
Third, we need to obtain the <strong>HMAC-MD5</strong> value for hashcat, according to the information in the video, the <strong>NTProofStr</strong> is the HMAC-MD5 value. It is also the first 16 bytes of the challenge response.
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="576" height="163" class="img_ev3q">
And for the last two values, User and Domain, we scroll down further in the packet details to find those values under the <em>domain name</em> &amp; <em>user name</em> attributes.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/89cbf79b5d85adceafbb5fb7bedeeb62-bd3d3ce4d96d667ba3c93ad1694f1248.png" width="606" height="306" class="img_ev3q">
Here we have, the final result of gathering all the need attribute values stored in the <code>ntlm-hashes.txt</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">john.deacon::FORELA: 53b0e5778af9adfb:8573cf0b2b03b84ba6caef21cd43a303:010100000000000080e4d59406c6da0153b0e57....</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we use hashcat to do an offline brute force of the NTLMv2 hash. Below is the refined command to run:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hashcat -a0 -m5600 ntlm-hashes.txt rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And here is the terminal output from the command and the resulting password for the user account.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/b2bbd96796f272fecdd34c38d1565ada-1a28654e1129d8fa46c5cb10bb1324bd.png" width="1062" height="499" class="img_ev3q">
<strong>The answer to the task question is the password <code>NotMyPassword0k?</code></strong></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-9">Task 9<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#task-9" class="hash-link" aria-label="Direct link to Task 9" title="Direct link to Task 9">​</a></h2>
<p><strong>Just to get more context surrounding the incident, what is the actual file share that the victim was trying to navigate to?</strong></p>
<p>For this task we will need to take a look at the log files that lead up to the malicious event. We know that the user was attempting to access a file share but, entered the wrong file share path, which in turn lead to their account becoming compromised.  In task 5 we found the typo that the user had mistakenly typed in, which was <code>DCC01</code>. Looking through the packet capture file, we can see that right before the LLMNR pensioning took place, the user was attempting to access the file share, <strong><code>\\DC01\DC-Confidential</code></strong>, which is the answer to the Task 9 Question.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/b8e02d6e56baed79311e79178c8b37d1-795f1373aa4e19baa89a8ac5d61a5d84.png" width="1908" height="399" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-takeaways"><strong>Key Takeaways</strong><a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#key-takeaways" class="hash-link" aria-label="Direct link to key-takeaways" title="Direct link to key-takeaways">​</a></h2>
<ul>
<li><strong>LLMNR (Link-Local Multicast Name Resolution)</strong> is a protocol that is used in Windows networks, it allows for the resolution of local network hostnames to IP addresses when DNS is not available. It is susceptible to <strong>Man-in-the-middle (MITM) &amp; Poisoning Attacks</strong>, due to it's lack of <em>verifying the identity of devices that respond to the name resolution requests</em>. <strong>Poisoning of LLMNR</strong> takes place when a threat actor exploits this lack of <em>verification</em> and <strong>impersonates the the LLMNR requesting service</strong>, allowing for the threat actor to receive traffic flows that contain sensitive information, which in this case lead to an corresponding <strong>NTLMv2 hash brute force</strong>.</li>
<li><strong>NTLM(Windows New Technology LAN Manager)</strong> and it's <strong>Version 2</strong> variant are used to <em>authenticate users</em> via a <strong>challenge-response mechanism</strong>. With <strong>NTLMv2</strong> the challenge-response mechanism uses HMAC-MD5 hashes that can be obtained via <em>traffic capture</em> or <em>Man-In-The-Middle attacks</em> and used for <em>offline brute forcing</em>, using a number of tools that are available, including the tool which we used for this investigation, <em>HashCat</em>. NTLM as a protocol should be disabled as is has been <em><a href="https://learn.microsoft.com/en-us/windows/whats-new/deprecated-features" target="_blank" rel="noopener noreferrer">deprecated by Microsoft</a></em>, and there are more modern protocols like Kerberos that accomplish the same functionality while being secure.</li>
</ul>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-1-1b8274">
<p><a href="https://en.wikipedia.org/wiki/Link-Local_Multicast_Name_Resolution" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Link-Local_Multicast_Name_Resolution</a> <a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#user-content-fnref-1-1b8274" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-3-1b8274">
<p><a href="https://www.aptive.co.uk/wp-content/uploads/2017/02/responder-llmnr-netbios-name-server-spoofing.png" target="_blank" rel="noopener noreferrer">https://www.aptive.co.uk/wp-content/uploads/2017/02/responder-llmnr-netbios-name-server-spoofing.png</a> <a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#user-content-fnref-3-1b8274" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-2-1b8274">
<p><a href="https://attack.mitre.org/techniques/T1557/001/" target="_blank" rel="noopener noreferrer">https://attack.mitre.org/techniques/T1557/001/</a> <a href="https://www.dariocruz.dev/blog/Noxious-HTB-Sherlocks#user-content-fnref-2-1b8274" data-footnote-backref="" aria-label="Back to reference 3" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section>]]></content>
        <author>
            <name>Dario Cruz</name>
            <uri>https://github.com/dario-cruz</uri>
        </author>
        <category label="Labs" term="Labs"/>
        <category label="Hackthebox" term="Hackthebox"/>
        <category label="Incident-Response" term="Incident-Response"/>
        <category label="NTLM" term="NTLM"/>
        <category label="LLMNR" term="LLMNR"/>
        <category label="HashCat" term="HashCat"/>
        <category label="Offline-BruteForce" term="Offline-BruteForce"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Security+ Passed!]]></title>
        <id>https://www.dariocruz.dev/blog/Security-Plus-Passed</id>
        <link href="https://www.dariocruz.dev/blog/Security-Plus-Passed"/>
        <updated>2024-10-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[DCruz-SecPlus]]></summary>
        <content type="html"><![CDATA[<p><img decoding="async" loading="lazy" alt="DCruz-SecPlus" src="https://www.dariocruz.dev/assets/images/78e2c33e2483c4cf74d88bc2565c1e9a-16a8fcef00ecd941e3a91e5260a7eb73.png" width="1056" height="816" class="img_ev3q">
Hey all,</p>
<p>Apologies for the radio silence! Work has ramped up, and I've been focused on my studies, as you can see. 😆 Last Friday, on Oct 25, I sat down and took the Security+ SY0-701 certification exam—and passed! 🎉</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-exam-experience">The Exam Experience<a href="https://www.dariocruz.dev/blog/Security-Plus-Passed#the-exam-experience" class="hash-link" aria-label="Direct link to The Exam Experience" title="Direct link to The Exam Experience">​</a></h2>
<p>Out of all the exams I have taken so far, I feel that the difficulty level of this exam was moderate. It would be harder if you took the exam without any prior IT experience. My exam comprised 3 performance-based questions, in which I had to use my knowledge to complete a set of tasks, and 72 multiple-choice questions—75 questions in total. As long as you have a study guide or a video course that covers all the exam domains, you should be fine. I took the time to dig deeper into specific topics, most notably <strong>Cryptography</strong> and <strong>Public Key Infrastructure</strong>, as those topics alone contain a wide range of technologies and concepts.</p>
<p>Additionally, it's pretty important to have a good set of practice exams. For this exam, I didn’t use Anki flashcards. My thinking was that, since I had already learned most of the content through the Google Cybersecurity Professional course, I wouldn’t need additional reinforcement as the concepts were already set in my memory. This approach worked well; any reinforcement of knowledge came from the practice exams, which gave me the needed feel of taking the actual test. My mind was ready! 🤓</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a href="https://www.dariocruz.dev/blog/Security-Plus-Passed#resources" class="hash-link" aria-label="Direct link to Resources" title="Direct link to Resources">​</a></h2>
<p>Here is a list of all of the resources that I used to study for the exam:</p>
<ul>
<li><a href="https://www.amazon.com/CompTIA-Security-Get-Certified-Ahead/dp/B0CM13W88J/ref=sr_1_4?crid=17IQW8C9GRB45&amp;dib=eyJ2IjoiMSJ9.KLwV9SPIB7iofREYr9NL4oNcF-LaIpRh9KHPr1EbVF8M_Ab8IJNiykb57TuvgtB--eez8bj1biPogxJBHHmBcMMVrxQJphARhMSI-wsXtwXi97wgpW4NKRStew5uBpCOe5-xAEVX6B79opQoJWMOzm-JmDkD4EDK-9KQfv59Pp8ginqCP6ZB08qXB7rEFX4ogZ_w_VN1uFp4KMYG6hWR3jEOVziFRPC5Zno3rav0cAw.Y0V_3IKnVq8szP6-AV0diTzQXXUrjePowAvGjylbG38&amp;dib_tag=se&amp;keywords=security%2B+701&amp;qid=1730214671&amp;sprefix=security%2B+%2Caps%2C229&amp;sr=8-4" target="_blank" rel="noopener noreferrer">SY0-701 Study Guide by Joe Shelly &amp; Darril Gibson</a></li>
<li><a href="https://lognpacific.com/free-certification-practice-tests/free-security-sy0-701-practice-questions/" target="_blank" rel="noopener noreferrer">Josh Madakor Security+ Practice Questions - LognPacific</a></li>
<li><a href="https://www.whizlabs.com/comptia-security-plus-sy0-701/" target="_blank" rel="noopener noreferrer">WhizLabs Security+ SY0-701 Practice Exams</a></li>
</ul>]]></content>
        <author>
            <name>Dario Cruz</name>
            <uri>https://github.com/dario-cruz</uri>
        </author>
        <category label="certifications" term="certifications"/>
        <category label="comptia" term="comptia"/>
        <category label="security-plus" term="security-plus"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Reaper(HTB-Sherlocks)]]></title>
        <id>https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks</id>
        <link href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks"/>
        <updated>2024-08-23T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Reaper-HTB-Sherlock]]></summary>
        <content type="html"><![CDATA[<p><img decoding="async" loading="lazy" alt="Reaper-HTB-Sherlock" src="https://www.dariocruz.dev/assets/images/Reaper-Sherlock-738bd3ad7c5c6b744a142c477c3cd052.webp" width="1024" height="1024" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-get-labbing">Lets get Labbing<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#lets-get-labbing" class="hash-link" aria-label="Direct link to Lets get Labbing" title="Direct link to Lets get Labbing">​</a></h2>
<p>Okay so I just discovered Hack The Box Sherlocks, they are Blue Team focused labs that test your SOC Analyst skills. Useful for sharping and displaying knowledge and skills. There looks to be a lot of them which is great, so I decided to jump right in and take a stab at the first lab, a retired lab called Reaper.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reaper">Reaper<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#reaper" class="hash-link" aria-label="Direct link to Reaper" title="Direct link to Reaper">​</a></h2>
<p>So, I am on the page and ready to start. I proceeded to read through the scenario, which reads as follows:</p>
<blockquote>
<p>Our SIEM alerted us to a suspicious logon event which needs to be looked at immediately . The alert details were that the IP Address and the Source Workstfation name were a mismatch .You are provided a network capture and event logs from the surrounding time around the incident timeframe. Corelate the given evidence and report back to your SOC Manager.</p>
</blockquote>
<p>Then I downloaded the files for the lab and took a look at them. Here is what they look like:</p>
<p><img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/f3e9a82f7ba8eaa466cb4e55a410d4ea-e43a950c121f55a796427b86f2e8b895.png" width="795" height="257" class="img_ev3q"></p>
<p>Okay so we have a <code>.evtx</code> file which is most likely a Windows Log file and also a <code>.pcapng</code> file that is a network capture of the event.</p>
<p>Before I proceeded I was asking myself if I needed to spin up a Windows VM or this as the computer that I am using is running Ubuntu Linux. Also, during the Windows Event Log: Finding Evil module for the HTB CDSA, all <code>.etvw</code> files where opened using Windows tools like the Event Viewer, SilkETW, and the PowerShell cmd-let <code>get-winevent</code>. Now I know there are most likely tools for viewing of these logs on Linux but, for posterity I will use the tools I learned about. Guess it's time to spin up that Windows VM.</p>
<p>installed Gnome Boxes as I heard it was the most minimal type 2 hypervisor for Debian based Linux distros. Downloaded the latest Windows 10 ISO and completed the install. Landing at the desktop I installed spice-webav guest tools, this makes it easier to move files to and from the host to guest OS and vise versa. I also installed 7-Zip as the native Windows OS archive tool does not support password protected <code>.zip</code> files. WireShark was also installed on the machine for a nice GUI-based interface that I can use to filter and investigate the <code>.pcap</code> file mentioned above. And not bam, here we are at the desktop all ready to go all cyber detective and everything.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/f58d94b49e61071a0c1a170e77e104e9-efbf3847c9590fb5ea58281146ede705.png" width="1851" height="1125" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1-what-is-the-ip-address-for-forela-wkstn001">Task 1: What is the IP Address for Forela-Wkstn001?<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#task-1-what-is-the-ip-address-for-forela-wkstn001" class="hash-link" aria-label="Direct link to Task 1: What is the IP Address for Forela-Wkstn001?" title="Direct link to Task 1: What is the IP Address for Forela-Wkstn001?">​</a></h2>
<p>Okay, so the first question is asking us for the IP address of the computer hostname <strong>Forela-Wkstn001</strong> so most likely we will be looking at the pcap file as that contains all of the network monitoring logs, which contain details of connections to and from the network, protocols used, IP addresses, MAC addresses etc.</p>
<p>Okay so with the pcap file open in WireShark and scrolling through without any filtering I can already see a log form the computer mentioned in the task info. Looks like the NetBios service running on our target machine was attempting to update information of some sort and we can clearly see the source IP address, which is <code>172.17.79.129</code>.</p>
<p><img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/2baa86df0ec002574a78804623f296bf-a98f261d88d5e0a8e059689ab119e176.png" width="1851" height="1125" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-netbios">What is NetBios?<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#what-is-netbios" class="hash-link" aria-label="Direct link to What is NetBios?" title="Direct link to What is NetBios?">​</a></h3>
<p>NetBios is a network protocol that is used for layer 5 (OSI Model) communication over a local network, this communication happens between computers on the local network exchanging data like DNS info, printer sharing, and session management. It's a legacy protocol that was used heavily on older versions of Windows but, now not so much. Note that Linux does not natively use NetBios in it's networking stack but, most distros of Linux have access to a tool called <code>netbios-utils</code>, a command-line utility for interacting with NetBios and other systems using it.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2-what-is-the-ip-address-for-forela-wkstn002">Task 2: What is the IP Address for Forela-Wkstn002?<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#task-2-what-is-the-ip-address-for-forela-wkstn002" class="hash-link" aria-label="Direct link to Task 2: What is the IP Address for Forela-Wkstn002?" title="Direct link to Task 2: What is the IP Address for Forela-Wkstn002?">​</a></h2>
<p>Task 2 is the same exact question but this time for computer <strong>Forela-Wkstn002</strong>. This time we will make use of WireSharks string search abilities.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/f3c6ec58a5c134cc54cea1855ae1cf4e-5dba54d02e22d2b14d22d17eab248cc2.png" width="1851" height="1125" class="img_ev3q">
And yet again we have more NetBios communication and the revealing of the source IP address of the machine, <code>172.17.79.136</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3-which-user-accounts-hash-was-stolen-by-attacker">Task 3: Which user account's hash was stolen by attacker?<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#task-3-which-user-accounts-hash-was-stolen-by-attacker" class="hash-link" aria-label="Direct link to Task 3: Which user account's hash was stolen by attacker?" title="Direct link to Task 3: Which user account's hash was stolen by attacker?">​</a></h2>
<p>Task 3 is to figure out which account had its' hash stolen. Wondering if this could be related to the old NetBios protocol being used. If we look at the logs provided and filter for Windows Logon events, Event Code: <code>4624</code>, the last 3 entries look very suspicious.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/5628302ed4d6d7911eb68b13d7dc8a4b-90182387052b925f75f5bdf10438555b.png" width="1376" height="952" class="img_ev3q">
Now if we take a look at the event we can see what looks to be a malicious logon. How do we know it was malicious though? Well, we can see that the <strong>Security ID, Account Name, Account Domain, and Logon ID</strong> all look to be invalid values. Scrolling down further, we can see more indicators of compromise.</p>
<p><img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/b8cec1843f18c156611acf8605e7745d-1e9275521125e1b1f6e02166c5f7a1dc.png" width="602" height="252" class="img_ev3q"></p>
<p>Above we can see that a new user was logged on to, <code>aurthur.kyle</code> from the Domain <code>FORELA</code>. This is the first instance of this user logging on in the logs.
Also NTLM was used for the logon as you can see from the next image.</p>
<p><img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/5ada28e45a3ca240117786bdd5453fc2-9bcd120d3d8e152c349b9042504940ed.png" width="577" height="203" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-ntlm">What is NTLM<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#what-is-ntlm" class="hash-link" aria-label="Direct link to What is NTLM" title="Direct link to What is NTLM">​</a></h3>
<p>NTLM is another legacy protocol (lol, sensing a pattern here), that was originally developed in 1990's and was used by the Windows OS as an authentication protocol, it was specifically useful for authenticating systems and users in environments where the domain controller was not available.</p>
<p>NTLM is also exploitable via Replay and Pass-The-Hash Attacks, and from the looks of it and taking into account the task question, I believe this is what took place.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4-what-is-the-ip-address-of-unknown-device-used-by-the-attacker-to-intercept-credentials">Task 4: What is the IP Address of Unknown Device used by the attacker to intercept credentials?<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#task-4-what-is-the-ip-address-of-unknown-device-used-by-the-attacker-to-intercept-credentials" class="hash-link" aria-label="Direct link to Task 4: What is the IP Address of Unknown Device used by the attacker to intercept credentials?" title="Direct link to Task 4: What is the IP Address of Unknown Device used by the attacker to intercept credentials?">​</a></h2>
<p>This one was easy as the same set of logs that we looked at from the previous task can be used to answer this one. The set of logons using NTLM and the user account <code>arthur.kyle</code> all originated from the IP <code>172.17.79.135</code>. This can be seen in the Network Information section of the provided windows log file and also in the PCAP file as well.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/596162293f8ea3c7fb165eb296706bd6-8fefdf03b28f5f6b7450eed89280e6de.png" width="1336" height="450" class="img_ev3q"></p>
<p>Filtering for the <code>ntlmssp</code> protocol in Wireshark displays logs pertaining to NTLM negotiation and NTLM authentication.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/f3a1d58d866abb10150ad8ad63c2296d-4f7c632a84a1d7da10271545ef57e976.png" width="1167" height="368" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-5-what-was-the-fileshare-navigated-by-the-victim-user-account">Task 5: What was the fileshare navigated by the victim user account?<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#task-5-what-was-the-fileshare-navigated-by-the-victim-user-account" class="hash-link" aria-label="Direct link to Task 5: What was the fileshare navigated by the victim user account?" title="Direct link to Task 5: What was the fileshare navigated by the victim user account?">​</a></h2>
<p>For this task I had already peeped that there were some events pertaining to SMB shares. <em>I took a look at the hint for this one which read as follows:</em></p>
<blockquote>
<p>Filter for smb2 traffic in wireshark. Search for keywords "BAD_NETWORK_NAME" in packet details.</p>
</blockquote>
<p>Okay so lets filter for smb2 traffic. After applying the filter and scrolling down, I see the "BAD_NETWORK_NAME" string come up in a set of logs.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/89291bdb3b10300a928f183ee28c7c1d-d8799a454aac6d7cc196893c0ca77f1b.png" width="1918" height="1039" class="img_ev3q">
This reveals the SMB share that was navigated to, which was <code>\\DCO01\Trip</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-6-what-is-the-source-port-used-to-logon-to-target-workstation-using-the-compromised-account">Task 6: What is the source port used to logon to target workstation using the compromised account?<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#task-6-what-is-the-source-port-used-to-logon-to-target-workstation-using-the-compromised-account" class="hash-link" aria-label="Direct link to Task 6: What is the source port used to logon to target workstation using the compromised account?" title="Direct link to Task 6: What is the source port used to logon to target workstation using the compromised account?">​</a></h2>
<p>Another easy question as the information is contained in sections of both log files that we've looked at already. Image below shows the source port of the logon for the compromised account <code>aurthur.kyle</code>.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/e008f3c11872b77051878ccfdb9cb6f9-e8d42eb7ec7aeae1a0a10bd85a9f457e.png" width="1284" height="513" class="img_ev3q">
As we can see from the image above the source port for the malicious NTLM logon was port <code>40252</code>, which is an ephemeral port, used for temporary outbound connections.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-7-what-is-the-logon-id-for-the-malicious-session">Task 7: What is the Logon ID for the malicious session?<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#task-7-what-is-the-logon-id-for-the-malicious-session" class="hash-link" aria-label="Direct link to Task 7: What is the Logon ID for the malicious session?" title="Direct link to Task 7: What is the Logon ID for the malicious session?">​</a></h2>
<p>This can also be found in the same event in the Windows Log file specifically in the <em>New Logon</em> section.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/0456a9e3c13b5cd74a1967ed651db34f-9c5dac005047d86fa1d68c12575ac6f5.png" width="1284" height="513" class="img_ev3q">As you can see from the image, the Logon ID is <code>0x64A799</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-8-what-is-the-workstation-name-and-the-source-ip-address-from-which-the-malicious-logon-occur">Task 8: What is the workstation name and the source IP Address from which the malicious logon occur?<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#task-8-what-is-the-workstation-name-and-the-source-ip-address-from-which-the-malicious-logon-occur" class="hash-link" aria-label="Direct link to Task 8: What is the workstation name and the source IP Address from which the malicious logon occur?" title="Direct link to Task 8: What is the workstation name and the source IP Address from which the malicious logon occur?">​</a></h2>
<p>Task description also states that, <em>"The detection was based on the mismatch of hostname and the assigned IP Address"</em>. Which I noticed as in the beginning tasks, we established that <strong>Forela-Wkstn001</strong> had an IP of <strong>172.17.79.129</strong> and that &nbsp;<strong>Forela-Wkstn002</strong> had an IP of <strong>172.17.79.136</strong>. Looking at the log event for the malicious logon we find the following.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/200f35380b7bb598dca2bc4b0f3fa5ba-e0d49b20f4405bf06f3ea0e3b7526ff4.png" width="1284" height="513" class="img_ev3q">
The logon attempt happened on the <strong>Forela-Wkstn002</strong> machine but, from an IP address that is different, <strong>172.17.79.135</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-9-when-did-the-malicious-logon-happened-please-make-sure-the-timestamp-is-in-utc">Task 9: When did the malicious logon happened. Please make sure the timestamp is in UTC?<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#task-9-when-did-the-malicious-logon-happened-please-make-sure-the-timestamp-is-in-utc" class="hash-link" aria-label="Direct link to Task 9: When did the malicious logon happened. Please make sure the timestamp is in UTC?" title="Direct link to Task 9: When did the malicious logon happened. Please make sure the timestamp is in UTC?">​</a></h2>
<p>Alright, so same log event and this time a different set of data needed. Also, we must note that the task requests us to change the time to UTC so, depending on the machine your are viewing the logs on, and it's configured time zone, the time of the actual event will need to be adjusted to take this into account.</p>
<p>I like in the EST time zone so, the time of the event in EST was 12:55:16, converting that into UTC we get, 04:55:16.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/a0b857537dd8f266f3ec5ed7ce0f49fa-07cf65f105b6166ab4e2c227265a3f37.png" width="594" height="386" class="img_ev3q">
The final complete answer, including the date as well as the time was <code>2024-07-31 04:55:16</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-10-what-is-the-share-name-accessed-as-part-of-the-authentication-process-by-the-malicious-tool-used-by-the-attacker">Task 10: What is the share Name accessed as part of the authentication process by the malicious tool used by the attacker?<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#task-10-what-is-the-share-name-accessed-as-part-of-the-authentication-process-by-the-malicious-tool-used-by-the-attacker" class="hash-link" aria-label="Direct link to Task 10: What is the share Name accessed as part of the authentication process by the malicious tool used by the attacker?" title="Direct link to Task 10: What is the share Name accessed as part of the authentication process by the malicious tool used by the attacker?">​</a></h2>
<p>The last and final task of the Sherlock lab. The answer I saw in passing while browsing through the the log looking for answers to other tasks and getting the lay of the land in terms of what took place. I found that the  Windows event code for file shares is <code>5140</code> after a quick google search. I applied the filter to the log file in Event Viewer and got the following.
<img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/a4d891b1bfb9cccbb8e7ff14668e271b-2e911044a5cff759252440230b9527c2.png" width="946" height="620" class="img_ev3q">
A single event that took place at the exact same time as the suspicious logon via NTLM, what a coincidence😝. The share accessed was <code>\\*\IPC$</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mission-complete">Mission Complete!<a href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks#mission-complete" class="hash-link" aria-label="Direct link to Mission Complete!" title="Direct link to Mission Complete!">​</a></h2>
<p><img decoding="async" loading="lazy" src="https://www.dariocruz.dev/assets/images/6a30bc8d976c9615fd7efee1acdcf1d5-e1b8bbfbe495dd161ce12a7b8aa6d4f8.png" width="701" height="617" class="img_ev3q"></p>]]></content>
        <author>
            <name>Dario Cruz</name>
            <uri>https://github.com/dario-cruz</uri>
        </author>
        <category label="Labs" term="Labs"/>
        <category label="Hackthebox" term="Hackthebox"/>
        <category label="Incident-Response" term="Incident-Response"/>
        <category label="Incident-Investigation" term="Incident-Investigation"/>
        <category label="NTLM" term="NTLM"/>
        <category label="NetBios" term="NetBios"/>
        <category label="Pass-The-Hash" term="Pass-The-Hash"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[The Journey So Far]]></title>
        <id>https://www.dariocruz.dev/blog/The Journey So Far</id>
        <link href="https://www.dariocruz.dev/blog/The Journey So Far"/>
        <updated>2024-08-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[dude-climbing-mountain]]></summary>
        <content type="html"><![CDATA[<p><img decoding="async" loading="lazy" alt="dude-climbing-mountain" src="https://www.dariocruz.dev/assets/images/dude-climbing-mountain-74a44a570fc8c6c864d3e6c1139a909a.webp" width="1024" height="1024" class="img_ev3q"></p>
<p>Phew, it's been one hell of a year. At the start of 2024 I made a deal with myself. Progress out of IT Support and take on a new challenge or face the reality that you will be left behind.😅</p>
<p>For me, I know myself to be the type of person to not let talents, skills, and knowledge go to waste. It nags me to no end and will haunt me like a ghost from one of those 80's movies lol.
<img decoding="async" loading="lazy" alt="Ghostbusters" src="https://www.dariocruz.dev/assets/images/ghostbusters-6b80ea00126bdaa7ef3a18f30edd5bc1.jpg" width="666" height="375" class="img_ev3q"></p>
<p>So, I sent my targets on pivoting into Cybersecurity. I wanted to go for a certification or training program that could offer me some skills that I could use in my current role and an IT Support Technician. I landed in the SC300 - Identity and Access Administrator certification from Microsoft for a few reasons.</p>
<ul>
<li><strong>I manage and administer to my Organizations Hybrid Active Directory implementation.</strong></li>
<li><strong>Microsoft Learn provides all of the training and documentation you need to study &amp; take the exam.</strong></li>
<li><strong>Microsoft Certification Exams are reasonably priced.</strong></li>
<li><strong>Microsoft Certifications are industry recognized. (It's Microsoft lol)</strong></li>
</ul>
<p>I passed the SC300 exam on May 27th, 2024 with a score of 820, and I have to say seeing that congratulations page made me feel so good.
<img decoding="async" loading="lazy" alt="Dariocru-sc300" src="https://www.dariocruz.dev/assets/images/dariocru-ms-sc300-9a9c7866c5cbc91f632de7a91b41e9f7.png" width="1026" height="744" class="img_ev3q">
Since then my manager and some of the higher up IT personnel have allowed me to take on more involved projects around managing of on-prem domain controllers and investigating hybrid sync issues between Azure Entra ID and our on-prem domain controller using Entra Connect Sync.</p>
<p>Next up on the list was the Google Cybersecurity Professional Certificate. I chose this certification because of the mix of hands on projects, video, and articles. It's a really nice balance for anyone attempting to get into the industry. It gives you hands on time working in Python and SQL which was a lot of fun. <em>Look out for more in the projects section of the site details of what I have learned.</em></p>
<p>I achieved the Google Cybersecurity Professional Certification on July 16th 2024.
<img decoding="async" loading="lazy" alt="dariocru-Google-Cyber-Cert" src="https://www.dariocruz.dev/assets/images/dariocru-google-cyber-1fb9176eecd940d30dd4b5c4fd733c2c.jpeg" width="1162" height="928" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">Whats next?<a href="https://www.dariocruz.dev/blog/The%20Journey%20So%20Far#whats-next" class="hash-link" aria-label="Direct link to Whats next?" title="Direct link to Whats next?">​</a></h2>
<p>From here I hae a few options. Since completing the GCP, i have a 30% off voucher to take the CompTIA Security+. I have already started to study for it, which shouldn't take too much time since the GCP covers topics that are a part of the domains covered in the Sec+. I also know that the cloud is becoming an ever prevalent way for Organizations to role out services, apps, and infrastructure, so it's important to know how to carry out security in the cloud. With that in regard I have taking steps toward the AZ-900, finishing the Microsoft Learn course content and scheduling the exam for tomorrow 8/2/2024.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hack-the-box---certified-defensive-security-analyst">Hack the Box - Certified Defensive Security Analyst<a href="https://www.dariocruz.dev/blog/The%20Journey%20So%20Far#hack-the-box---certified-defensive-security-analyst" class="hash-link" aria-label="Direct link to Hack the Box - Certified Defensive Security Analyst" title="Direct link to Hack the Box - Certified Defensive Security Analyst">​</a></h3>
<p>Hack the Box is a well known cyber range and I have some experience exploring their modules and also using <a href="https://tryhackme.com/" target="_blank" rel="noopener noreferrer">TryHackMe</a>. What draws me to the certification is that exam test is all practical. I will be investigating a security incident, performing an analysis, and writing out a report on findings. The exam is graded based on the quality of the report and how thorough the findings are, it sounds like just the type of challenge I need right now.</p>
<p><img decoding="async" loading="lazy" alt="Challenge Accepted" src="https://www.dariocruz.dev/assets/images/challenge-accepted-3a50321bed7eb7fa30e99db998787c4f.webp" width="480" height="480" class="img_ev3q"></p>]]></content>
        <author>
            <name>Dario Cruz</name>
            <uri>https://github.com/dario-cruz</uri>
        </author>
        <category label="Microsoft" term="Microsoft"/>
        <category label="Google" term="Google"/>
        <category label="Azure" term="Azure"/>
        <category label="Cybersecurity" term="Cybersecurity"/>
        <category label="Certifications" term="Certifications"/>
        <category label="Hack-the-box" term="Hack-the-box"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Mastering Identity & Access Management]]></title>
        <id>https://www.dariocruz.dev/blog/Mastering Identity &amp; Access Management</id>
        <link href="https://www.dariocruz.dev/blog/Mastering Identity &amp; Access Management"/>
        <updated>2024-07-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Essential Pillars for Enhanced Security with Entra ID]]></summary>
        <content type="html"><![CDATA[<p><img decoding="async" loading="lazy" alt="Mastering IAM" src="https://www.dariocruz.dev/assets/images/mastering-iam-f974a85ee64ff198ab54d8309dd33d61.webp" width="1024" height="1024" class="img_ev3q">
<em>This post was originally posted to my <a href="https://www.linkedin.com/pulse/mastering-identity-access-management-essential-pillars-dario-cruz-nhsue/?trackingId=FEN9MEiaSUenXkprR4giCQ%3D%3D" target="_blank" rel="noopener noreferrer">Linkedin Profile</a></em></p>
<p><strong>Identity and Access Management (IAM)</strong> is a framework of policies and technologies that ensure the management and security of accounts, allowing organizations to implement the concept of least privilege when it comes to the amount of access a user has and what resources that access can be applied to.</p>
<p>IAM is also a core component of the <em>CISSP certification</em>. Let's dive into the pillars of Identity and Access Management and how they can be applied to make your organization more secure. We will use the scope of #Entra ID, as #Microsoft has implemented all the necessary controls to carry out Identity and Access Management.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-pillars-of-iam">The Pillars of IAM<a href="https://www.dariocruz.dev/blog/Mastering%20Identity%20&amp;%20Access%20Management#the-pillars-of-iam" class="hash-link" aria-label="Direct link to The Pillars of IAM" title="Direct link to The Pillars of IAM">​</a></h2>
<p>Here are the core concepts that make up IAM:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="identity-management">Identity Management<a href="https://www.dariocruz.dev/blog/Mastering%20Identity%20&amp;%20Access%20Management#identity-management" class="hash-link" aria-label="Direct link to Identity Management" title="Direct link to Identity Management">​</a></h3>
<p>Identity Management involves the creation, maintenance, and deletion of accounts. Each user is assigned a unique identity that is placed into a repository. Users can manage their own profiles and reset passwords.</p>
<p><strong>Example:</strong> Consider an organization that onboards new employees into its Active Directory/Entra ID system. The user receives account information to access their laptop, email, and other enterprise apps. AD/Entra ID administrators can update the account and make changes if the user changes roles or needs new permissions. The user can update their password and some profile information, like their profile photo. Once the user leaves, the account is marked for deletion based on the organization's account handling policies. On the day of off-boarding, the user will no longer have access to their account or any company resources.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="authentication">Authentication<a href="https://www.dariocruz.dev/blog/Mastering%20Identity%20&amp;%20Access%20Management#authentication" class="hash-link" aria-label="Direct link to Authentication" title="Direct link to Authentication">​</a></h3>
<p>Authentication verifies the identity of users, devices, or systems, ensuring that the party requesting access is who they claim to be.</p>
<p><strong>Example:</strong> The Contoso Organization has configured its Active Directory/Entra ID systems with MFA, SSO, and Biometrics. When a user attempts to authenticate, they need a second factor of authentication. Users onboard with a fingerprint reader to generate biometric data. This data, along with the username and password, verifies the user's identity. SSO allows the user to stay logged in and not be prompted to authenticate when accessing enterprise applications. Admins can adjust the interval or factors required for re-authentication.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="authorization">Authorization<a href="https://www.dariocruz.dev/blog/Mastering%20Identity%20&amp;%20Access%20Management#authorization" class="hash-link" aria-label="Direct link to Authorization" title="Direct link to Authorization">​</a></h3>
<p>Authorization determines what an authenticated user is allowed to do. This is achieved by setting up and enforcing policies. Entra ID uses Role-Based Access Control (RBAC), Attribute-Based Access Control (ABAC), and Policy-Based Access Control mechanisms for comprehensive user authorization.</p>
<p><strong>Example:</strong> Contoso sets up RBAC so that only Operations department users have access to their cloud-based inventory management system. Warehouse users do not see this web app on their Entra ID My Apps page.</p>
<p>Contoso uses Entra ID Conditional Access to control login times, enforcing work hours and enhancing information security. These policies, based on attributes such as time and location, implement Attribute-Based Access Control.</p>
<p>Contoso also implements a Conditional Access policy that restricts access to the sales ERP system, which contains SPII, to on-premise users only.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-management">Access Management<a href="https://www.dariocruz.dev/blog/Mastering%20Identity%20&amp;%20Access%20Management#access-management" class="hash-link" aria-label="Direct link to Access Management" title="Direct link to Access Management">​</a></h3>
<p>Access Management enforces the policies and controls implemented, ensuring users have proper access to appropriate resources. Users should also be able to request specific access when needed.</p>
<p><strong>Example:</strong> Contoso has enabled Privileged Identity Management (PIM) on their Entra ID tenant. PIM allows admins to configure eligible roles for specific groups or roles and control the duration and scope of these roles. Users with eligible roles can request access, pending admin approval.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="governance-and-compliance">Governance and Compliance<a href="https://www.dariocruz.dev/blog/Mastering%20Identity%20&amp;%20Access%20Management#governance-and-compliance" class="hash-link" aria-label="Direct link to Governance and Compliance" title="Direct link to Governance and Compliance">​</a></h3>
<p>Governance and Compliance involve adhering to regulatory requirements, internal policies, and industry standards. Auditing, reporting, policy management, and risk management fall under this pillar.</p>
<p><strong>Example:</strong> Contoso configured Active Directory/Entra ID to make logs available for further investigation in Entra ID. Admins can view these logs in Microsoft Sentinel or ingest them into a SIEM or SOAR platform. These platforms report on user, group, and application activity, providing threat scoring and enabling security analysts to manage risk. Entra ID also includes Identity Protection and Risk-Based Conditional Access policies for managing user and sign-in risk.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-and-intelligence">Monitoring and Intelligence<a href="https://www.dariocruz.dev/blog/Mastering%20Identity%20&amp;%20Access%20Management#monitoring-and-intelligence" class="hash-link" aria-label="Direct link to Monitoring and Intelligence" title="Direct link to Monitoring and Intelligence">​</a></h3>
<p>Monitoring and Intelligence involve continuously analyzing user activities to detect and respond to anomalies and security threats.</p>
<p><strong>Example:</strong>:As<!-- --> mentioned earlier, Contoso logs are ingested into a SIEM or SOAR platform, where security analysts monitor user, group, and app activities. Microsoft Entra ID Identity Protection assists in detecting, investigating, and remediating risks. Admins can investigate user behavior, mark identities as compromised, and start remediation processes, such as password resets and MFA registration.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lifecycle-management">Lifecycle Management<a href="https://www.dariocruz.dev/blog/Mastering%20Identity%20&amp;%20Access%20Management#lifecycle-management" class="hash-link" aria-label="Direct link to Lifecycle Management" title="Direct link to Lifecycle Management">​</a></h3>
<p>Lifecycle Management covers the entire identity lifecycle, from initial provisioning to de-provisioning and account cleanup. It also includes handling lifecycle events, such as promotions or department transfers, requiring changes in access levels, and ensuring account status matches the user's current status in the organization.</p>
<p><strong>Example:</strong> Contoso hires George as a Quality Assurance manager. HR requests a Windows account with appropriate permissions from IT. Entra ID admins create the account with a role matching George's title. Upon George's promotion, admins update his role, granting access to more enterprise apps, including those with SPII. When George decides to leave after two years, HR informs IT of his departure date. Admins set Entra ID to disable the account on George's last workday. His identity is placed in the "Deleted Users" section, allowing 30 days for possible restoration.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-takeaways">Key Takeaways<a href="https://www.dariocruz.dev/blog/Mastering%20Identity%20&amp;%20Access%20Management#key-takeaways" class="hash-link" aria-label="Direct link to Key Takeaways" title="Direct link to Key Takeaways">​</a></h2>
<p>In summary, Identity and Access Management (IAM) is crucial for securing organizational resources and implementing least privilege access. By leveraging Entra ID, organizations can effectively manage identity lifecycle, authenticate users, enforce access policies, and ensure compliance. Understanding the pillars of IAM—Identity Management, Authentication, Authorization, Access Management, Governance and Compliance, Monitoring and Intelligence, and Lifecycle Management—enables businesses to build a robust security framework. Implementing these practices helps protect sensitive information, streamline user access, and enhance overall security posture.</p>]]></content>
        <author>
            <name>Dario Cruz</name>
            <uri>https://github.com/dario-cruz</uri>
        </author>
        <category label="Microsoft" term="Microsoft"/>
        <category label="EntraID" term="EntraID"/>
        <category label="IAM" term="IAM"/>
        <category label="Azure" term="Azure"/>
        <category label="Cybersecurity" term="Cybersecurity"/>
        <category label="Authentication" term="Authentication"/>
        <category label="Authorization" term="Authorization"/>
        <category label="Governance" term="Governance"/>
        <category label="Compliance" term="Compliance"/>
        <category label="Monitoring" term="Monitoring"/>
        <category label="Lifecycle" term="Lifecycle"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Site Up and Running]]></title>
        <id>https://www.dariocruz.dev/blog/Site Up and Running</id>
        <link href="https://www.dariocruz.dev/blog/Site Up and Running"/>
        <updated>2024-05-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[dude coding site]]></summary>
        <content type="html"><![CDATA[<p><img decoding="async" loading="lazy" alt="dude coding site" src="https://www.dariocruz.dev/assets/images/dude-coding-site-0dee76a685dfb8eb2ba808a91df68b3e.webp" width="1024" height="1024" class="img_ev3q"></p>
<p>Hello all, 👋🏽</p>
<p>My name is Dario and I've been working in the IT Support space for 5 years total. 4 years working for Amazon and 1 year working for The Chefs Warehouse.</p>
<p>Over the course of my experience I have had some amazing hands on time with some great technologies. Checkout the projects section for more info on projects that I have worked on.</p>
<h1>Inception of the Site</h1>
<p>This site came about because I needed a place on the internet to share my work and my musings about technology, AI, and software development.</p>]]></content>
        <author>
            <name>Dario Cruz</name>
            <uri>https://github.com/dario-cruz</uri>
        </author>
        <category label="welcome" term="welcome"/>
        <category label="website" term="website"/>
        <category label="azure" term="azure"/>
        <category label="cicd" term="cicd"/>
        <category label="react" term="react"/>
    </entry>
</feed>