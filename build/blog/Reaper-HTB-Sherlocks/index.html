<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Reaper(HTB-Sherlocks) | DarioCruz.dev</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:title" content="Reaper(HTB-Sherlocks) | DarioCruz.dev"><meta data-rh="true" name="description" content="HTB Sherlock Reaper investigation notes focused on NTLM, NetBIOS, and pass-the-hash."><meta data-rh="true" property="og:description" content="HTB Sherlock Reaper investigation notes focused on NTLM, NetBIOS, and pass-the-hash."><meta data-rh="true" name="keywords" content="Hack The Box,Sherlock,Reaper,incident response,NTLM"><meta data-rh="true" property="og:image" content="https://www.dariocruz.dev/img/itsmedario.webp"><meta data-rh="true" name="twitter:image" content="https://www.dariocruz.dev/img/itsmedario.webp"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-08-23T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/dario-cruz"><meta data-rh="true" property="article:tag" content="Labs,Hackthebox,Incident-Response,Incident-Investigation,NTLM,NetBios,Pass-The-Hash"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks"><link data-rh="true" rel="alternate" href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks","mainEntityOfPage":"https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks","url":"https://www.dariocruz.dev/blog/Reaper-HTB-Sherlocks","headline":"Reaper(HTB-Sherlocks)","name":"Reaper(HTB-Sherlocks)","description":"HTB Sherlock Reaper investigation notes focused on NTLM, NetBIOS, and pass-the-hash.","datePublished":"2024-08-23T00:00:00.000Z","author":{"@type":"Person","name":"Dario Cruz","description":"Maintainer of DarioCruz.dev","url":"https://github.com/dario-cruz","image":"https://github.com/dario-cruz.png"},"image":{"@type":"ImageObject","@id":"https://www.dariocruz.dev/img/itsmedario.webp","url":"https://www.dariocruz.dev/img/itsmedario.webp","contentUrl":"https://www.dariocruz.dev/img/itsmedario.webp","caption":"title image for the blog post: Reaper(HTB-Sherlocks)"},"keywords":["Hack The Box","Sherlock","Reaper","incident response","NTLM"],"isPartOf":{"@type":"Blog","@id":"https://www.dariocruz.dev/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="DarioCruz.dev RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="DarioCruz.dev Atom Feed"><link rel="stylesheet" href="/assets/css/styles.fe7f9ae0.css">
<script src="/assets/js/runtime~main.eea08814.js" defer="defer"></script>
<script src="/assets/js/main.471f7ac3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/dcdev-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/dcdev-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">DarioCruz.dev</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/intro">Projects</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/dariocru/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/LearningLinuxArch">Learning Linux with Arch</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Unit42-Sherlock">Unit42 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/CrownJewel2-Sherlock">CrownJewel 2 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/CrownJewel1-Sherlock">CrownJewel 1 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Campfire2-Sherlock">Campfire 2 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Campfire1-Sherlock">Campfire 1 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Loggy-Sherlock">Loggy (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/NetTrafficAnalysis">What I&#x27;ve Learned - Network Traffic Analysis</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Kerberoasting-Explained">Kerberoasting: What You Need To Know</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/RogueOne-HTB-Sherlocks">RogueOne (HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Noxious-HTB-Sherlocks">Noxious (HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Security-Plus-Passed">Security+ Passed!</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/Reaper-HTB-Sherlocks">Reaper(HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/The Journey So Far">The Journey So Far</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Mastering Identity &amp; Access Management">Mastering Identity &amp; Access Management</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Site Up and Running">Site Up and Running</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Reaper(HTB-Sherlocks)</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-08-23T00:00:00.000Z">August 23, 2024</time> ¬∑ <!-- -->9 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dario-cruz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/dario-cruz.png" alt="Dario Cruz"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/dario-cruz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Dario Cruz</span></a></div><small class="authorTitle_nd0D" title="Maintainer of DarioCruz.dev">Maintainer of DarioCruz.dev</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p><img decoding="async" loading="lazy" alt="Reaper-HTB-Sherlock" src="/assets/images/Reaper-Sherlock-738bd3ad7c5c6b744a142c477c3cd052.webp" width="1024" height="1024" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-get-labbing">Lets get Labbing<a href="#lets-get-labbing" class="hash-link" aria-label="Direct link to Lets get Labbing" title="Direct link to Lets get Labbing">‚Äã</a></h2>
<p>Okay so I just discovered Hack The Box Sherlocks, they are Blue Team focused labs that test your SOC Analyst skills. Useful for sharping and displaying knowledge and skills. There looks to be a lot of them which is great, so I decided to jump right in and take a stab at the first lab, a retired lab called Reaper.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reaper">Reaper<a href="#reaper" class="hash-link" aria-label="Direct link to Reaper" title="Direct link to Reaper">‚Äã</a></h2>
<p>So, I am on the page and ready to start. I proceeded to read through the scenario, which reads as follows:</p>
<blockquote>
<p>Our SIEM alerted us to a suspicious logon event which needs to be looked at immediately . The alert details were that the IP Address and the Source Workstfation name were a mismatch .You are provided a network capture and event logs from the surrounding time around the incident timeframe. Corelate the given evidence and report back to your SOC Manager.</p>
</blockquote>
<p>Then I downloaded the files for the lab and took a look at them. Here is what they look like:</p>
<p><img decoding="async" loading="lazy" alt="Intro 1" src="/assets/images/f3e9a82f7ba8eaa466cb4e55a410d4ea-e43a950c121f55a796427b86f2e8b895.png" width="795" height="257" class="img_ev3q"></p>
<p>Okay so we have a <code>.evtx</code> file which is most likely a Windows Log file and also a <code>.pcapng</code> file that is a network capture of the event.</p>
<p>Before I proceeded I was asking myself if I needed to spin up a Windows VM or this as the computer that I am using is running Ubuntu Linux. Also, during the Windows Event Log: Finding Evil module for the HTB CDSA, all <code>.etvw</code> files where opened using Windows tools like the Event Viewer, SilkETW, and the PowerShell cmd-let <code>get-winevent</code>. Now I know there are most likely tools for viewing of these logs on Linux but, for posterity I will use the tools I learned about. Guess it&#x27;s time to spin up that Windows VM.</p>
<p>installed Gnome Boxes as I heard it was the most minimal type 2 hypervisor for Debian based Linux distros. Downloaded the latest Windows 10 ISO and completed the install. Landing at the desktop I installed spice-webav guest tools, this makes it easier to move files to and from the host to guest OS and vise versa. I also installed 7-Zip as the native Windows OS archive tool does not support password protected <code>.zip</code> files. WireShark was also installed on the machine for a nice GUI-based interface that I can use to filter and investigate the <code>.pcap</code> file mentioned above. And not bam, here we are at the desktop all ready to go all cyber detective and everything.</p>
<p><img decoding="async" loading="lazy" alt="Intro 2" src="/assets/images/f58d94b49e61071a0c1a170e77e104e9-efbf3847c9590fb5ea58281146ede705.png" width="1851" height="1125" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1-what-is-the-ip-address-for-forela-wkstn001">Task 1: What is the IP Address for Forela-Wkstn001?<a href="#task-1-what-is-the-ip-address-for-forela-wkstn001" class="hash-link" aria-label="Direct link to Task 1: What is the IP Address for Forela-Wkstn001?" title="Direct link to Task 1: What is the IP Address for Forela-Wkstn001?">‚Äã</a></h2>
<p>Okay, so the first question is asking us for the IP address of the computer hostname <strong>Forela-Wkstn001</strong> so most likely we will be looking at the pcap file as that contains all of the network monitoring logs, which contain details of connections to and from the network, protocols used, IP addresses, MAC addresses etc.</p>
<p>Okay so with the pcap file open in WireShark and scrolling through without any filtering I can already see a log form the computer mentioned in the task info. Looks like the NetBios service running on our target machine was attempting to update information of some sort and we can clearly see the source IP address, which is <code>172.17.79.129</code>.</p>
<p><img decoding="async" loading="lazy" alt="Task 1 01" src="/assets/images/2baa86df0ec002574a78804623f296bf-a98f261d88d5e0a8e059689ab119e176.png" width="1851" height="1125" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-netbios">What is NetBios?<a href="#what-is-netbios" class="hash-link" aria-label="Direct link to What is NetBios?" title="Direct link to What is NetBios?">‚Äã</a></h3>
<p>NetBios is a network protocol that is used for layer 5 (OSI Model) communication over a local network, this communication happens between computers on the local network exchanging data like DNS info, printer sharing, and session management. It&#x27;s a legacy protocol that was used heavily on older versions of Windows but, now not so much. Note that Linux does not natively use NetBios in it&#x27;s networking stack but, most distros of Linux have access to a tool called <code>netbios-utils</code>, a command-line utility for interacting with NetBios and other systems using it.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2-what-is-the-ip-address-for-forela-wkstn002">Task 2: What is the IP Address for Forela-Wkstn002?<a href="#task-2-what-is-the-ip-address-for-forela-wkstn002" class="hash-link" aria-label="Direct link to Task 2: What is the IP Address for Forela-Wkstn002?" title="Direct link to Task 2: What is the IP Address for Forela-Wkstn002?">‚Äã</a></h2>
<p>Task 2 is the same exact question but this time for computer <strong>Forela-Wkstn002</strong>. This time we will make use of WireSharks string search abilities.</p>
<p><img decoding="async" loading="lazy" alt="Task 2 01" src="/assets/images/f3c6ec58a5c134cc54cea1855ae1cf4e-5dba54d02e22d2b14d22d17eab248cc2.png" width="1851" height="1125" class="img_ev3q"></p>
<p>And yet again we have more NetBios communication and the revealing of the source IP address of the machine, <code>172.17.79.136</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3-which-user-accounts-hash-was-stolen-by-attacker">Task 3: Which user account&#x27;s hash was stolen by attacker?<a href="#task-3-which-user-accounts-hash-was-stolen-by-attacker" class="hash-link" aria-label="Direct link to Task 3: Which user account&#x27;s hash was stolen by attacker?" title="Direct link to Task 3: Which user account&#x27;s hash was stolen by attacker?">‚Äã</a></h2>
<p>Task 3 is to figure out which account had its&#x27; hash stolen. Wondering if this could be related to the old NetBios protocol being used. If we look at the logs provided and filter for Windows Logon events, Event Code: <code>4624</code>, the last 3 entries look very suspicious.</p>
<p><img decoding="async" loading="lazy" alt="Task 3 01" src="/assets/images/5628302ed4d6d7911eb68b13d7dc8a4b-90182387052b925f75f5bdf10438555b.png" width="1376" height="952" class="img_ev3q"></p>
<p>Now if we take a look at the event we can see what looks to be a malicious logon. How do we know it was malicious though? Well, we can see that the <strong>Security ID, Account Name, Account Domain, and Logon ID</strong> all look to be invalid values. Scrolling down further, we can see more indicators of compromise.</p>
<p><img decoding="async" loading="lazy" alt="Task 3 02" src="/assets/images/b8cec1843f18c156611acf8605e7745d-1e9275521125e1b1f6e02166c5f7a1dc.png" width="602" height="252" class="img_ev3q"></p>
<p>Above we can see that a new user was logged on to, <code>aurthur.kyle</code> from the Domain <code>FORELA</code>. This is the first instance of this user logging on in the logs.
Also NTLM was used for the logon as you can see from the next image.</p>
<p><img decoding="async" loading="lazy" alt="Task 3 03" src="/assets/images/5ada28e45a3ca240117786bdd5453fc2-9bcd120d3d8e152c349b9042504940ed.png" width="577" height="203" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-ntlm">What is NTLM<a href="#what-is-ntlm" class="hash-link" aria-label="Direct link to What is NTLM" title="Direct link to What is NTLM">‚Äã</a></h3>
<p>NTLM is another legacy protocol (lol, sensing a pattern here), that was originally developed in 1990&#x27;s and was used by the Windows OS as an authentication protocol, it was specifically useful for authenticating systems and users in environments where the domain controller was not available.</p>
<p>NTLM is also exploitable via Replay and Pass-The-Hash Attacks, and from the looks of it and taking into account the task question, I believe this is what took place.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4-what-is-the-ip-address-of-unknown-device-used-by-the-attacker-to-intercept-credentials">Task 4: What is the IP Address of Unknown Device used by the attacker to intercept credentials?<a href="#task-4-what-is-the-ip-address-of-unknown-device-used-by-the-attacker-to-intercept-credentials" class="hash-link" aria-label="Direct link to Task 4: What is the IP Address of Unknown Device used by the attacker to intercept credentials?" title="Direct link to Task 4: What is the IP Address of Unknown Device used by the attacker to intercept credentials?">‚Äã</a></h2>
<p>This one was easy as the same set of logs that we looked at from the previous task can be used to answer this one. The set of logons using NTLM and the user account <code>arthur.kyle</code> all originated from the IP <code>172.17.79.135</code>. This can be seen in the Network Information section of the provided windows log file and also in the PCAP file as well.
<img decoding="async" loading="lazy" alt="Task 4 01" src="/assets/images/596162293f8ea3c7fb165eb296706bd6-8fefdf03b28f5f6b7450eed89280e6de.png" width="1336" height="450" class="img_ev3q"></p>
<p>Filtering for the <code>ntlmssp</code> protocol in Wireshark displays logs pertaining to NTLM negotiation and NTLM authentication.</p>
<p><img decoding="async" loading="lazy" alt="Task 4 02" src="/assets/images/f3a1d58d866abb10150ad8ad63c2296d-4f7c632a84a1d7da10271545ef57e976.png" width="1167" height="368" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-5-what-was-the-fileshare-navigated-by-the-victim-user-account">Task 5: What was the fileshare navigated by the victim user account?<a href="#task-5-what-was-the-fileshare-navigated-by-the-victim-user-account" class="hash-link" aria-label="Direct link to Task 5: What was the fileshare navigated by the victim user account?" title="Direct link to Task 5: What was the fileshare navigated by the victim user account?">‚Äã</a></h2>
<p>For this task I had already peeped that there were some events pertaining to SMB shares. <em>I took a look at the hint for this one which read as follows:</em></p>
<blockquote>
<p>Filter for smb2 traffic in wireshark. Search for keywords &quot;BAD_NETWORK_NAME&quot; in packet details.</p>
</blockquote>
<p>Okay so lets filter for smb2 traffic. After applying the filter and scrolling down, I see the &quot;BAD_NETWORK_NAME&quot; string come up in a set of logs.</p>
<p><img decoding="async" loading="lazy" alt="Task 5 01" src="/assets/images/89291bdb3b10300a928f183ee28c7c1d-d8799a454aac6d7cc196893c0ca77f1b.png" width="1918" height="1039" class="img_ev3q"></p>
<p>This reveals the SMB share that was navigated to, which was <code>\\DCO01\Trip</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-6-what-is-the-source-port-used-to-logon-to-target-workstation-using-the-compromised-account">Task 6: What is the source port used to logon to target workstation using the compromised account?<a href="#task-6-what-is-the-source-port-used-to-logon-to-target-workstation-using-the-compromised-account" class="hash-link" aria-label="Direct link to Task 6: What is the source port used to logon to target workstation using the compromised account?" title="Direct link to Task 6: What is the source port used to logon to target workstation using the compromised account?">‚Äã</a></h2>
<p>Another easy question as the information is contained in sections of both log files that we&#x27;ve looked at already. Image below shows the source port of the logon for the compromised account <code>aurthur.kyle</code>.</p>
<p><img decoding="async" loading="lazy" alt="Task 6 01" src="/assets/images/e008f3c11872b77051878ccfdb9cb6f9-e8d42eb7ec7aeae1a0a10bd85a9f457e.png" width="1284" height="513" class="img_ev3q"></p>
<p>As we can see from the image above the source port for the malicious NTLM logon was port <code>40252</code>, which is an ephemeral port, used for temporary outbound connections.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-7-what-is-the-logon-id-for-the-malicious-session">Task 7: What is the Logon ID for the malicious session?<a href="#task-7-what-is-the-logon-id-for-the-malicious-session" class="hash-link" aria-label="Direct link to Task 7: What is the Logon ID for the malicious session?" title="Direct link to Task 7: What is the Logon ID for the malicious session?">‚Äã</a></h2>
<p>This can also be found in the same event in the Windows Log file specifically in the <em>New Logon</em> section.</p>
<p><img decoding="async" loading="lazy" alt="Task 7 01" src="/assets/images/0456a9e3c13b5cd74a1967ed651db34f-9c5dac005047d86fa1d68c12575ac6f5.png" width="1284" height="513" class="img_ev3q">As you can see from the image, the Logon ID is <code>0x64A799</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-8-what-is-the-workstation-name-and-the-source-ip-address-from-which-the-malicious-logon-occur">Task 8: What is the workstation name and the source IP Address from which the malicious logon occur?<a href="#task-8-what-is-the-workstation-name-and-the-source-ip-address-from-which-the-malicious-logon-occur" class="hash-link" aria-label="Direct link to Task 8: What is the workstation name and the source IP Address from which the malicious logon occur?" title="Direct link to Task 8: What is the workstation name and the source IP Address from which the malicious logon occur?">‚Äã</a></h2>
<p>Task description also states that, <em>&quot;The detection was based on the mismatch of hostname and the assigned IP Address&quot;</em>. Which I noticed as in the beginning tasks, we established that <strong>Forela-Wkstn001</strong> had an IP of <strong>172.17.79.129</strong> and that ¬†<strong>Forela-Wkstn002</strong> had an IP of <strong>172.17.79.136</strong>. Looking at the log event for the malicious logon we find the following.</p>
<p><img decoding="async" loading="lazy" alt="Task 8 01" src="/assets/images/200f35380b7bb598dca2bc4b0f3fa5ba-e0d49b20f4405bf06f3ea0e3b7526ff4.png" width="1284" height="513" class="img_ev3q"></p>
<p>The logon attempt happened on the <strong>Forela-Wkstn002</strong> machine but, from an IP address that is different, <strong>172.17.79.135</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-9-when-did-the-malicious-logon-happened-please-make-sure-the-timestamp-is-in-utc">Task 9: When did the malicious logon happened. Please make sure the timestamp is in UTC?<a href="#task-9-when-did-the-malicious-logon-happened-please-make-sure-the-timestamp-is-in-utc" class="hash-link" aria-label="Direct link to Task 9: When did the malicious logon happened. Please make sure the timestamp is in UTC?" title="Direct link to Task 9: When did the malicious logon happened. Please make sure the timestamp is in UTC?">‚Äã</a></h2>
<p>Alright, so same log event and this time a different set of data needed. Also, we must note that the task requests us to change the time to UTC so, depending on the machine your are viewing the logs on, and it&#x27;s configured time zone, the time of the actual event will need to be adjusted to take this into account.</p>
<p>I like in the EST time zone so, the time of the event in EST was 12:55:16, converting that into UTC we get, 04:55:16.</p>
<p><img decoding="async" loading="lazy" alt="Task 9 01" src="/assets/images/a0b857537dd8f266f3ec5ed7ce0f49fa-07cf65f105b6166ab4e2c227265a3f37.png" width="594" height="386" class="img_ev3q"></p>
<p>The final complete answer, including the date as well as the time was <code>2024-07-31 04:55:16</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-10-what-is-the-share-name-accessed-as-part-of-the-authentication-process-by-the-malicious-tool-used-by-the-attacker">Task 10: What is the share Name accessed as part of the authentication process by the malicious tool used by the attacker?<a href="#task-10-what-is-the-share-name-accessed-as-part-of-the-authentication-process-by-the-malicious-tool-used-by-the-attacker" class="hash-link" aria-label="Direct link to Task 10: What is the share Name accessed as part of the authentication process by the malicious tool used by the attacker?" title="Direct link to Task 10: What is the share Name accessed as part of the authentication process by the malicious tool used by the attacker?">‚Äã</a></h2>
<p>The last and final task of the Sherlock lab. The answer I saw in passing while browsing through the the log looking for answers to other tasks and getting the lay of the land in terms of what took place. I found that the  Windows event code for file shares is <code>5140</code> after a quick google search. I applied the filter to the log file in Event Viewer and got the following.</p>
<p><img decoding="async" loading="lazy" alt="Task 10 01" src="/assets/images/a4d891b1bfb9cccbb8e7ff14668e271b-2e911044a5cff759252440230b9527c2.png" width="946" height="620" class="img_ev3q"></p>
<p>A single event that took place at the exact same time as the suspicious logon via NTLM, what a coincidenceüòù. The share accessed was <code>\\*\IPC$</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mission-complete">Mission Complete!<a href="#mission-complete" class="hash-link" aria-label="Direct link to Mission Complete!" title="Direct link to Mission Complete!">‚Äã</a></h2>
<p><img decoding="async" loading="lazy" alt="Mission Complete" src="/assets/images/6a30bc8d976c9615fd7efee1acdcf1d5-e1b8bbfbe495dd161ce12a7b8aa6d4f8.png" width="701" height="617" class="img_ev3q"></p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/labs">Labs</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/hackthebox">Hackthebox</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/incident-response">Incident-Response</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/incident-investigation">Incident-Investigation</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/ntlm">NTLM</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/net-bios">NetBios</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/pass-the-hash">Pass-The-Hash</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/Security-Plus-Passed"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Security+ Passed!</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/The Journey So Far"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">The Journey So Far</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#lets-get-labbing" class="table-of-contents__link toc-highlight">Lets get Labbing</a></li><li><a href="#reaper" class="table-of-contents__link toc-highlight">Reaper</a></li><li><a href="#task-1-what-is-the-ip-address-for-forela-wkstn001" class="table-of-contents__link toc-highlight">Task 1: What is the IP Address for Forela-Wkstn001?</a><ul><li><a href="#what-is-netbios" class="table-of-contents__link toc-highlight">What is NetBios?</a></li></ul></li><li><a href="#task-2-what-is-the-ip-address-for-forela-wkstn002" class="table-of-contents__link toc-highlight">Task 2: What is the IP Address for Forela-Wkstn002?</a></li><li><a href="#task-3-which-user-accounts-hash-was-stolen-by-attacker" class="table-of-contents__link toc-highlight">Task 3: Which user account&#39;s hash was stolen by attacker?</a><ul><li><a href="#what-is-ntlm" class="table-of-contents__link toc-highlight">What is NTLM</a></li></ul></li><li><a href="#task-4-what-is-the-ip-address-of-unknown-device-used-by-the-attacker-to-intercept-credentials" class="table-of-contents__link toc-highlight">Task 4: What is the IP Address of Unknown Device used by the attacker to intercept credentials?</a></li><li><a href="#task-5-what-was-the-fileshare-navigated-by-the-victim-user-account" class="table-of-contents__link toc-highlight">Task 5: What was the fileshare navigated by the victim user account?</a></li><li><a href="#task-6-what-is-the-source-port-used-to-logon-to-target-workstation-using-the-compromised-account" class="table-of-contents__link toc-highlight">Task 6: What is the source port used to logon to target workstation using the compromised account?</a></li><li><a href="#task-7-what-is-the-logon-id-for-the-malicious-session" class="table-of-contents__link toc-highlight">Task 7: What is the Logon ID for the malicious session?</a></li><li><a href="#task-8-what-is-the-workstation-name-and-the-source-ip-address-from-which-the-malicious-logon-occur" class="table-of-contents__link toc-highlight">Task 8: What is the workstation name and the source IP Address from which the malicious logon occur?</a></li><li><a href="#task-9-when-did-the-malicious-logon-happened-please-make-sure-the-timestamp-is-in-utc" class="table-of-contents__link toc-highlight">Task 9: When did the malicious logon happened. Please make sure the timestamp is in UTC?</a></li><li><a href="#task-10-what-is-the-share-name-accessed-as-part-of-the-authentication-process-by-the-malicious-tool-used-by-the-attacker" class="table-of-contents__link toc-highlight">Task 10: What is the share Name accessed as part of the authentication process by the malicious tool used by the attacker?</a></li><li><a href="#mission-complete" class="table-of-contents__link toc-highlight">Mission Complete!</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2026 DarioCruz.dev. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>