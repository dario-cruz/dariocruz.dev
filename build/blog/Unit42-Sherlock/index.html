<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Unit42 (HTB-Sherlock) | DarioCruz.dev</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://www.dariocruz.dev/blog/Unit42-Sherlock"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:title" content="Unit42 (HTB-Sherlock) | DarioCruz.dev"><meta data-rh="true" name="description" content="HTB Sherlock Unit42 investigation focused on Sysmon logs and threat detection."><meta data-rh="true" property="og:description" content="HTB Sherlock Unit42 investigation focused on Sysmon logs and threat detection."><meta data-rh="true" name="keywords" content="Hack The Box,Sherlock,Unit42,Sysmon,threat detection"><meta data-rh="true" property="og:image" content="https://www.dariocruz.dev/img/itsmedario.webp"><meta data-rh="true" name="twitter:image" content="https://www.dariocruz.dev/img/itsmedario.webp"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-06-09T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/dario-cruz"><meta data-rh="true" property="article:tag" content="hackthebox,Sherlocks,Threat Detection,Sysmon,EvtxECmd,TimelineExplorer,LogAnalysis,EricZimmermanTools"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.dariocruz.dev/blog/Unit42-Sherlock"><link data-rh="true" rel="alternate" href="https://www.dariocruz.dev/blog/Unit42-Sherlock" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.dariocruz.dev/blog/Unit42-Sherlock" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://www.dariocruz.dev/blog/Unit42-Sherlock","mainEntityOfPage":"https://www.dariocruz.dev/blog/Unit42-Sherlock","url":"https://www.dariocruz.dev/blog/Unit42-Sherlock","headline":"Unit42 (HTB-Sherlock)","name":"Unit42 (HTB-Sherlock)","description":"HTB Sherlock Unit42 investigation focused on Sysmon logs and threat detection.","datePublished":"2025-06-09T00:00:00.000Z","author":{"@type":"Person","name":"Dario Cruz","description":"Maintainer of DarioCruz.dev","url":"https://github.com/dario-cruz","image":"https://github.com/dario-cruz.png"},"image":{"@type":"ImageObject","@id":"https://www.dariocruz.dev/img/itsmedario.webp","url":"https://www.dariocruz.dev/img/itsmedario.webp","contentUrl":"https://www.dariocruz.dev/img/itsmedario.webp","caption":"title image for the blog post: Unit42 (HTB-Sherlock)"},"keywords":["Hack The Box","Sherlock","Unit42","Sysmon","threat detection"],"isPartOf":{"@type":"Blog","@id":"https://www.dariocruz.dev/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="DarioCruz.dev RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="DarioCruz.dev Atom Feed"><link rel="stylesheet" href="/assets/css/styles.fe7f9ae0.css">
<script src="/assets/js/runtime~main.eea08814.js" defer="defer"></script>
<script src="/assets/js/main.471f7ac3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/dcdev-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/dcdev-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">DarioCruz.dev</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/intro">Projects</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/dariocru/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/LearningLinuxArch">Learning Linux with Arch</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/Unit42-Sherlock">Unit42 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/CrownJewel2-Sherlock">CrownJewel 2 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/CrownJewel1-Sherlock">CrownJewel 1 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Campfire2-Sherlock">Campfire 2 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Campfire1-Sherlock">Campfire 1 (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Loggy-Sherlock">Loggy (HTB-Sherlock)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/NetTrafficAnalysis">What I&#x27;ve Learned - Network Traffic Analysis</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Kerberoasting-Explained">Kerberoasting: What You Need To Know</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/RogueOne-HTB-Sherlocks">RogueOne (HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Noxious-HTB-Sherlocks">Noxious (HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Security-Plus-Passed">Security+ Passed!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Reaper-HTB-Sherlocks">Reaper(HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/The Journey So Far">The Journey So Far</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Mastering Identity &amp; Access Management">Mastering Identity &amp; Access Management</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Site Up and Running">Site Up and Running</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Unit42 (HTB-Sherlock)</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-06-09T00:00:00.000Z">June 9, 2025</time> · <!-- -->12 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dario-cruz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/dario-cruz.png" alt="Dario Cruz"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/dario-cruz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Dario Cruz</span></a></div><small class="authorTitle_nd0D" title="Maintainer of DarioCruz.dev">Maintainer of DarioCruz.dev</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p><img decoding="async" loading="lazy" alt="Title Image - Unit42" src="/assets/images/Unit 42 _HTB-Sherlock_-1749482256043-04020d72dedb6dee42f7074ee2a59b50.webp" width="1024" height="1024" class="img_ev3q"></p>
<p>Welcome back everyone. The following Sherlock is being completed in preparation for taking the HTB CDSA exam. I came across a medium blog post by the user, <a href="https://medium.com/@hammazahmed40/mastering-cdsa-by-htb-f11e99403986" target="_blank" rel="noopener noreferrer">Hammazahmed</a>. He provides some advice for learning and practicing skills before taking the exam. Specifically, he mentioned this Sherlock investigation, along with some others, <a href="https://app.hackthebox.com/sherlocks/BFT" target="_blank" rel="noopener noreferrer">BFT</a>, <a href="https://app.hackthebox.com/sherlocks/Noted" target="_blank" rel="noopener noreferrer">Noted</a>, RogueOne (Which I have completed, full writeup <a href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks" target="_blank" rel="noopener noreferrer">here</a>), and <a href="https://app.hackthebox.com/sherlocks/BFT" target="_blank" rel="noopener noreferrer">Meerkat</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scenario">Scenario<a href="#scenario" class="hash-link" aria-label="Direct link to Scenario" title="Direct link to Scenario">​</a></h2>
<p><em>In this Sherlock, you will familiarize yourself with Sysmon logs and various useful EventIDs for identifying and analyzing malicious activities on a Windows system. Palo Alto&#x27;s Unit42 recently conducted research on an UltraVNC campaign, wherein attackers utilized a backdoored version of UltraVNC to maintain access to systems. This lab is inspired by that campaign and guides participants through the initial access stage of the campaign.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-files">The Files<a href="#the-files" class="hash-link" aria-label="Direct link to The Files" title="Direct link to The Files">​</a></h2>
<p>Inside the zip file for this investigation, we are provided with a single Windows log file, from the Sysmon Operational log provider.</p>
<p><img decoding="async" loading="lazy" alt="The Files" src="data:image/webp;base64,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" width="660" height="160" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1">Task 1<a href="#task-1" class="hash-link" aria-label="Direct link to Task 1" title="Direct link to Task 1">​</a></h2>
<p><em>How many Event logs were there with Event ID 11?</em></p>
<p>For this I opted to make use of PowerShell, specifically the cmdlet <code>Get-WinEvent</code>. Referencing this amazing <a href="https://wiki.sans.blue/Tools/pdfs/Get-WinEvent.pdf" target="_blank" rel="noopener noreferrer">PDF</a> created by the SANS institute, I was able to use the <code>-Path</code> argument to point the Cmdlet to the provided <code>.evtx</code> file.  I also applied filtering and counting of events via <code>| Group-Object id -NoElement | sort count</code>. The complete command I created is below, along with an explanation of each element.</p>
<div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-WinEvent -Path &#x27;C:\Sherlocks\Unit 42\Microsoft-Windows-Sysmon-Operational.evtx&#x27; | Group-Object id -NoElement | sort count</span><br></span></code></pre></div></div>
<ul>
<li><code>Get-WinEvent -Path</code>: Tells the Get-WinEvent cmdlet to target a specific event log file.</li>
<li><code>Group-Object</code>: Will display objects based on a the value of a property that is given as an argument, in this case the <code>id</code> property.</li>
<li><code>-NoElement</code>: Tells the Group-Object command not to include the objects in the output.</li>
<li><code>sort count</code>: Enables sorting via a value in this case the count of events.</li>
</ul>
<p>And here is the output of the complete command.</p>
<p><img decoding="async" loading="lazy" alt="Task 1 - Image 1" src="/assets/images/Unit 42 _HTB-Sherlock_-1749224947067-5f91ed0f7736171cb9dab6d9bf9ae9c4.webp" width="1088" height="380" class="img_ev3q"></p>
<p>As you can see from the output we have a list of event IDs and their counts in descending order, at the bottom the event id of 11 has a count of <strong>56</strong> events.</p>
<p><img decoding="async" loading="lazy" alt="Task 1 - Image 2" src="data:image/webp;base64,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" width="563" height="259" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2">Task 2<a href="#task-2" class="hash-link" aria-label="Direct link to Task 2" title="Direct link to Task 2">​</a></h2>
<p><em>Whenever a process is created in memory, an event with Event ID 1 is recorded with details such as command line, hashes, process path, parent process path, etc. This information is very useful for an analyst because it allows us to see all programs executed on a system, which means we can spot any malicious processes being executed. What is the malicious process that infected the victim&#x27;s system?</em></p>
<p>For this I will be parsing the provided <code>.evtx</code> file using EvtxECmd and converting it into a <code>.csv</code> file. After the parsing/conversion we will be able to view and filter the file in Timeline Explorer, providing a clearer view of the log data and more complete searching and filtering.</p>
<p><img decoding="async" loading="lazy" alt="Task 2 - Image 1" src="/assets/images/Unit 42 _HTB-Sherlock_-1749226871829-72c51131f777146a6a5eb594803e209e.webp" width="979" height="919" class="img_ev3q"></p>
<p>Above I ran EvtxECMD with the needed parameters and had it generate a <code>.csv</code> file from the provided log file.</p>
<p><img decoding="async" loading="lazy" alt="Task 2 - Image 2" src="/assets/images/Unit 42 _HTB-Sherlock_-1749231600250-70fc8f9a370d4d5f15bc59e25139f0ba.webp" width="853" height="710" class="img_ev3q"></p>
<p>I then opened the file in Timeline Explorer, displaying all the events contained in the log file, presented in groups sorted by event ID.</p>
<p><img decoding="async" loading="lazy" alt="Task 2 - Image 3" src="/assets/images/Unit 42 _HTB-Sherlock_-1749232799098-6d70e084329caee1da582f7dce607215.webp" width="752" height="239" class="img_ev3q"></p>
<p>Looking at all of the 6 events pertaining to Event ID 1, we can see a suspicious process creation event invoked from the directory location and file, <strong>C:\Users\CyberJunkie\Downloads\Preventivo24.02.14.exe.exe</strong> which turns out to be the task flag and the malicious process that infected the system.</p>
<p><img decoding="async" loading="lazy" alt="Task 2 - Image 4" src="/assets/images/Unit 42 _HTB-Sherlock_-1749232910639-1fea0e79bf51bbb1476cbfb77db1faee.webp" width="561" height="363" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3">Task 3<a href="#task-3" class="hash-link" aria-label="Direct link to Task 3" title="Direct link to Task 3">​</a></h2>
<p><em>Which Cloud drive was used to distribute the malware?</em></p>
<p>Hmm, okay so we need to find either a directory or some sort of network communication to a cloud service to pin down the flag for this task. Lets take a look at all the events that are contained in the log, just so that we know what we have to work with. Below I have included details for all the Sysmon events contained in our log file and what data they contain.</p>
<p><img decoding="async" loading="lazy" alt="Task 3 Image 1" src="/assets/images/Unit 42 _HTB-Sherlock_-1749235246395-a106c3d74360da4cb512a52171f1b616.webp" width="347" height="549" class="img_ev3q"></p>
<ul>
<li><em>Sysmon Event ID 1</em>: We already know from the previous tasks that this event is logged on creation of a Windows processes.</li>
<li><em>Sysmon Event ID 2</em>: Changing of file creation time.</li>
<li><em>Sysmon Event ID 3</em>: Network connection made by process.</li>
<li><em>Sysmon Event ID 5</em>: Windows process termination.</li>
<li><em>Sysmon Event ID 7</em>: DLL loaded into a process.</li>
<li><em>Sysmon Event ID 10</em>: Process accessing another process.</li>
<li><em>Sysmon Event ID 11</em>: File creation/File Overwritten.</li>
<li><em>Sysmon Event ID 12</em>: Creation and deletion of registry events.</li>
<li><em>Sysmon Event ID 13</em>: Modification of registry values.</li>
<li><em>Sysmon Event ID 15</em>: creation of file stream and hash of file contents.</li>
<li><em>Sysmon Event ID 17</em>: Named Pipe created (interprocess communication).</li>
<li><em>Sysmon Event ID 22</em>: DNS Queries.</li>
<li><em>Sysmon Event ID 23</em>: File deletion and archiving.</li>
<li><em>Sysmon Event ID 26</em>: File deletion logged.</li>
</ul>
<p>Now we know what event data we have contained in the logs, the task requires us to find what cloud drive was used. Usage of the cloud at all means communication over the internet, meaning that a DNS query should have been made to the cloud service for connection and communication. Lets take a look at <em>Sysmon Event ID 22</em>.</p>
<p><img decoding="async" loading="lazy" alt="Task 3 Image 2" src="/assets/images/Unit 42 _HTB-Sherlock_-1749236734814-6801b7b814ad93faca420975771d2798.webp" width="1886" height="122" class="img_ev3q"></p>
<p>Above we can see that we have 3 logs for Sysmon Event 22. All of the events were triggered by the same user account that launched the malware and all of the events took place around the same time.</p>
<p><img decoding="async" loading="lazy" alt="Task 3 Image 3" src="/assets/images/Unit 42 _HTB-Sherlock_-1749237333302-c01336cff8972dbd0e6c5800d5a23f61.webp" width="1428" height="78" class="img_ev3q"></p>
<p>Looking at the payload data contained in the logs we have the Image/Process that initiated the DNS query and also the QueryName/Hostname value.</p>
<p><img decoding="async" loading="lazy" alt="Task 3 Image 4" src="/assets/images/Unit 42 _HTB-Sherlock_-1749237910904-557ee21d2435cddcc8ff10ec9caa939b.webp" width="1451" height="333" class="img_ev3q"></p>
<p>I sorted the events by time and found that we had queries for <code>dl.dropboxusercontent.com</code> &amp; <code>d.dropbox.com</code>. Directly after, we have a query from the malware process, attempting to resolve <code>www.example.com</code>. From this information, we can confirm that the cloud drive/service that was being used was <strong>dropbox</strong>.</p>
<p><img decoding="async" loading="lazy" alt="Task 3 Image 5" src="data:image/webp;base64,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" width="562" height="259" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4">Task 4<a href="#task-4" class="hash-link" aria-label="Direct link to Task 4" title="Direct link to Task 4">​</a></h2>
<p><em>For many of the files it wrote to disk, the initial malicious file used a defense evasion technique called Time Stomping, where the file creation date is changed to make it appear older and blend in with other files. What was the timestamp changed to for the PDF file?</em></p>
<p>We know that the Sysmon Event 2 logs the file creation times. We should be able to look at these logs for a PDF file that looks to be older than it really is.</p>
<p><img decoding="async" loading="lazy" alt="Task 4 Image 1" src="/assets/images/Unit 42 _HTB-Sherlock_-1749477041249-a68b9b67166f4b077f181d8555f112bd.webp" width="1890" height="445" class="img_ev3q"></p>
<p>Above I have filtered for all the Sysmon Event 2 logs, and we have a list of file creations. Looking at the file creations and their originating process, we can see that the malware created a host of files on the system. The most notable is the only PDF file that was created and logged which is found at <code>C:\Users\CyberJunkie\AppData\Roaming\Photo and Fax Vn\Photo and vn 1.1.2\install\F97891C\TempFolder\~.pdf</code>.</p>
<p><img decoding="async" loading="lazy" alt="Task 4 Image 2" src="/assets/images/Unit 42 _HTB-Sherlock_-1749477321545-d5d43e0b7bba6ca4b6bab00ec63ec419.webp" width="1636" height="258" class="img_ev3q"></p>
<p>And now looking at the creation time of the PDF file we can see that the creation time logged was <strong><code>2024-01-14 08:10:06</code></strong>.</p>
<p><img decoding="async" loading="lazy" alt="Task 4 Image 3" src="/assets/images/Unit 42 _HTB-Sherlock_-1749477402403-4f275f8348d6f4fcd11753431bc81dc7.webp" width="730" height="301" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-5">Task 5<a href="#task-5" class="hash-link" aria-label="Direct link to Task 5" title="Direct link to Task 5">​</a></h2>
<p><em>The malicious file dropped a few files on disk. Where was &quot;once.cmd&quot; created on disk? Please answer with the full path along with the filename.</em></p>
<p>In the previous task, we filtered for Sysmon Event 2 logs and we noticed that the malware created a few files on the affected host system. One of which was the PDF file we observed the creation time of, another was this file, <code>once.md</code>.</p>
<p><img decoding="async" loading="lazy" alt="Task 5 Image 1" src="/assets/images/Unit 42 _HTB-Sherlock_-1749477656697-f1363bd5296e539fa2ce5c716f605c49.webp" width="1918" height="936" class="img_ev3q"></p>
<p>Looking again at the filtered logs we have an entry for the file creation of <code>once.md</code> and we can see the full path in which the file was created. The complete file path is <strong><code>C:\Users\CyberJunkie\AppData\Roaming\Photo and Fax Vn\Photo and vn 1.1.2\install\F97891C\WindowsVolume\Games\once.cmd</code></strong>.</p>
<p><img decoding="async" loading="lazy" alt="Task 5 Image 2" src="/assets/images/Unit 42 _HTB-Sherlock_-1749477784992-52624cac126d819b772fb466fab74f95.webp" width="730" height="280" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-6">Task 6<a href="#task-6" class="hash-link" aria-label="Direct link to Task 6" title="Direct link to Task 6">​</a></h2>
<p><em>The malicious file attempted to reach a dummy domain, most likely to check the internet connection status. What domain name did it try to connect to?</em></p>
<p>This one is simple, in Task 3, we were asked, what cloud service was used to distribute the malware. We observed a timeline of Sysmon Event 22 logs, in which the affected computer attempted to reach two Dropbox domains and also the domain <strong><code>www.example.com</code></strong>, of which I annotated in the image that it was potentially an attempt for the malware to check for internet connection before downloading more malicious files. I have included the image below.</p>
<p><img decoding="async" loading="lazy" alt="Task 6 Image 1" src="/assets/images/Unit 42 _HTB-Sherlock_-1749237910904-557ee21d2435cddcc8ff10ec9caa939b.webp" width="1451" height="333" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Task 6 Image 2" src="/assets/images/Unit 42 _HTB-Sherlock_-1749478083738-e776e3aa4deaa2ad015b922a14fdd66d.webp" width="729" height="279" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-7">Task 7<a href="#task-7" class="hash-link" aria-label="Direct link to Task 7" title="Direct link to Task 7">​</a></h2>
<p><em>Which IP address did the malicious process try to reach out to?</em></p>
<p>Referencing the Sysmon Event ID, present in the provided log file, we should be able to make use of Sysmon Event 3, which logs data pertaining to a process making a network connection.</p>
<p><img decoding="async" loading="lazy" alt="Task 7 Image 1" src="/assets/images/Unit 42 _HTB-Sherlock_-1749478469969-98fc0e816a1252567cd964143ee69160.webp" width="1905" height="140" class="img_ev3q"></p>
<p>Filtering for Sysmon Event 3 there is only a single log entry, and it is related to the malicious file that was run and infected the host system.</p>
<p><img decoding="async" loading="lazy" alt="Task 7 Image 2" src="/assets/images/Unit 42 _HTB-Sherlock_-1749478792372-1415b6d3d565a91656a564769ac5763c.webp" width="1117" height="400" class="img_ev3q"></p>
<p>Scrolling to the payload data and executable info we confirm that the log was for the malicious file, and we also see that the destination IP address the malware was attempting to connect to was, <strong><code>93.184.216.34</code></strong>.</p>
<p><img decoding="async" loading="lazy" alt="Task 7 Image 3" src="data:image/webp;base64,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" width="731" height="260" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-8">Task 8<a href="#task-8" class="hash-link" aria-label="Direct link to Task 8" title="Direct link to Task 8">​</a></h2>
<p><em>The malicious process terminated itself after infecting the PC with a backdoored variant of UltraVNC. When did the process terminate itself?</em></p>
<p>Sysmon Event 5 correlates to the termination of processes. It is safe to assume that if we have any logs for this type of event, that there would be some useful information pertaining to the termination of the malware that infected the host.</p>
<p><img decoding="async" loading="lazy" alt="Task 8 Image 1" src="/assets/images/Unit 42 _HTB-Sherlock_-1749481917261-256b7a3deb0f9eadfd49a34a58bd315b.webp" width="1894" height="134" class="img_ev3q"></p>
<p>Filtering for Sysmon Event 5 we have a single log entry, of which the executable info for the log entry points to the malicious file from the previous tasks.</p>
<p><img decoding="async" loading="lazy" alt="Task 8 Image 2" src="/assets/images/Unit 42 _HTB-Sherlock_-1749482222681-d0fb3db9742b9e18f94331de5928adb0.webp" width="1515" height="193" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Task 8 Image 3" src="/assets/images/Unit 42 _HTB-Sherlock_-1749482189208-9d49d6e3557d341b6b6fb86d93222d4a.webp" width="1084" height="480" class="img_ev3q"></p>
<p>Now looking at the payload information for this log entry we find the time &amp; date of the process termination, which is <strong><code>2024-02-14 03:41:58</code></strong>. Note that double clicking on a cell in Timeline Explorer will present the full contents of the cell.</p>
<p><img decoding="async" loading="lazy" alt="Task 8 Image 1" src="/assets/images/Unit 42 _HTB-Sherlock_-1749482299926-b8844036971438bad582a8e3dbd0d96e.webp" width="729" height="280" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Task 8 Image 2" src="/assets/images/Unit 42 _HTB-Sherlock_-1749482332059-a633769e8a9fee32802d83c563f90ac4.webp" width="703" height="591" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="timeline-of-events">Timeline of Events<a href="#timeline-of-events" class="hash-link" aria-label="Direct link to Timeline of Events" title="Direct link to Timeline of Events">​</a></h2>
<ul>
<li><code>2024-02-14 03:41:25</code> - User on the soon-to-be-infected machine downloads malicious file from Dropbox cloud storage using Firefox web browser. Malicious file is named <code>Preventivo24.02.14.exe.exe</code>, and is downloaded to the users downloads folder.</li>
<li><code>2024-02-14 03:41:48</code> - User executes the malicious file. Malware attempts to access <code>www.example.com</code>, possibly to test internet connection.</li>
<li><code>2024-02-14 03:41:57</code> - Malware creates network connection to IP <code>93.184.216.34</code>.</li>
<li><code>2024-02-14 03:41:57</code> - <code>Preventivo24.02.14.exe.exe</code> process downloads malicious files and scripts to  <code>C:\Users\CyberJunkie\AppData\Roaming\Photo and Fax Vn\Photo and vn 1.1.2\install\F97891C\</code> creating sub-directories as well.</li>
<li><code>2024-02-14 03:41:57</code> - <code>Preventivo24.02.14.exe.exe</code> executes installer  file that was downloaded via the command, infecting the system:<!-- -->
<ul>
<li><code>&quot;C:\Windows\system32\msiexec.exe&quot; /i &quot;C:\Users\CyberJunkie\AppData\Roaming\Photo and Fax Vn\Photo and vn 1.1.2\install\F97891C\main1.msi&quot; AI_SETUPEXEPATH=C:\Users\CyberJunkie\Downloads\Preventivo24.02.14.exe.exe SETUPEXEDIR=C:\Users\CyberJunkie\Downloads\ EXE_CMD_LINE=&quot;/exenoupdates  /forcecleanup  /wintime 1707880560  &quot; AI_EUIMSI=&quot;&quot;</code></li>
</ul>
</li>
<li><code>2024-02-14 03:41:58</code> - <code>Preventivo24.02.14.exe.exe</code> deletes all downloaded files, directories, and scripts downloaded from IP address.</li>
<li><code>2024-02-14 03:41:58</code> -  <code>Preventivo24.02.14.exe.exe</code> terminates its process after downloading malicious files from IP address.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-key-takeaways">🔑 Key Takeaways<a href="#-key-takeaways" class="hash-link" aria-label="Direct link to 🔑 Key Takeaways" title="Direct link to 🔑 Key Takeaways">​</a></h2>
<ul>
<li><strong>Effective Use of Sysmon Logs</strong>: Understanding Sysmon event IDs is critical for detecting suspicious behavior.</li>
<li><strong>PowerShell for Log Analysis</strong>: Leveraging <code>Get-WinEvent</code>, filtering of a given log file can be accomplished.</li>
<li><strong>Timelining with EvtxECmd &amp; Timeline Explorer</strong>: Parsing <code>.evtx</code> files into <code>.csv</code> and analyzing them in Timeline Explorer provided a powerful method to sift through and correlate event data.</li>
</ul></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/hackthebox">hackthebox</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/sherlocks">Sherlocks</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/threat-detection">Threat Detection</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/sysmon">Sysmon</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/evtx-e-cmd">EvtxECmd</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/timeline-explorer">TimelineExplorer</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/log-analysis">LogAnalysis</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/eric-zimmerman-tools">EricZimmermanTools</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/LearningLinuxArch"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Learning Linux with Arch</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/CrownJewel2-Sherlock"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">CrownJewel 2 (HTB-Sherlock)</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#scenario" class="table-of-contents__link toc-highlight">Scenario</a></li><li><a href="#the-files" class="table-of-contents__link toc-highlight">The Files</a></li><li><a href="#task-1" class="table-of-contents__link toc-highlight">Task 1</a></li><li><a href="#task-2" class="table-of-contents__link toc-highlight">Task 2</a></li><li><a href="#task-3" class="table-of-contents__link toc-highlight">Task 3</a></li><li><a href="#task-4" class="table-of-contents__link toc-highlight">Task 4</a></li><li><a href="#task-5" class="table-of-contents__link toc-highlight">Task 5</a></li><li><a href="#task-6" class="table-of-contents__link toc-highlight">Task 6</a></li><li><a href="#task-7" class="table-of-contents__link toc-highlight">Task 7</a></li><li><a href="#task-8" class="table-of-contents__link toc-highlight">Task 8</a></li><li><a href="#timeline-of-events" class="table-of-contents__link toc-highlight">Timeline of Events</a></li><li><a href="#-key-takeaways" class="table-of-contents__link toc-highlight">🔑 Key Takeaways</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 DarioCruz.dev. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>