<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">RogueOne (HTB-Sherlocks) | DarioCruz.dev</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.dariocruz.dev/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.dariocruz.dev/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="RogueOne (HTB-Sherlocks) | DarioCruz.dev"><meta data-rh="true" name="description" content="RogueOne"><meta data-rh="true" property="og:description" content="RogueOne"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-11-18T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/dario-cruz"><meta data-rh="true" property="article:tag" content="Hackthebox,Labs,Incident-Response,Volatility,Hashing,Virustotal,Memory-Forensics,Python"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks"><link data-rh="true" rel="alternate" href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks","mainEntityOfPage":"https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks","url":"https://www.dariocruz.dev/blog/RogueOne-HTB-Sherlocks","headline":"RogueOne (HTB-Sherlocks)","name":"RogueOne (HTB-Sherlocks)","description":"RogueOne","datePublished":"2024-11-18T00:00:00.000Z","author":{"@type":"Person","name":"Dario Cruz","description":"Maintainer of DarioCruz.dev","url":"https://github.com/dario-cruz","image":"https://github.com/dario-cruz.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://www.dariocruz.dev/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="DarioCruz.dev RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="DarioCruz.dev Atom Feed"><link rel="stylesheet" href="/assets/css/styles.d922e3b4.css">
<script src="/assets/js/runtime~main.49fa740e.js" defer="defer"></script>
<script src="/assets/js/main.4e688565.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/dcdev-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/dcdev-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">DarioCruz.dev</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/intro">Projects</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/dariocru/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Kerberoasting-Explained">Kerberoasting: What You Need To Know</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/RogueOne-HTB-Sherlocks">RogueOne (HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Noxious-HTB-Sherlocks">Noxious (HTB-Sherlocks)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Security-Plus-Passed">Security+ Passed!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Reaper-HTB-Sherlocks">Reaper(HTB-Sherlocks)</a></li></ul></div></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">RogueOne (HTB-Sherlocks)</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-11-18T00:00:00.000Z">November 18, 2024</time> ¬∑ <!-- -->14 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dario-cruz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/dario-cruz.png" alt="Dario Cruz"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/dario-cruz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Dario Cruz</span></a></div><small class="authorTitle_nd0D" title="Maintainer of DarioCruz.dev">Maintainer of DarioCruz.dev</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p><img decoding="async" loading="lazy" alt="RogueOne" src="/assets/images/b7497376cdde03305e1abce7fddc155c-46f9b4b23dbca91da80c156be8a98e0d.png" width="1024" height="1024" class="img_ev3q">
It&#x27;s that time again, lets dig into another investigation, this time it looks like we will be digging into memory forensics. üïµÔ∏è‚Äç‚ôÇÔ∏èü§ìüîé</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scenario">Scenario<a href="#scenario" class="hash-link" aria-label="Direct link to Scenario" title="Direct link to Scenario">‚Äã</a></h2>
<blockquote>
<p>Your SIEM system generated multiple alerts in less than a minute, indicating potential C2 communication from Simon Stark&#x27;s workstation. Despite Simon not noticing anything unusual, the IT team had him share screenshots of his task manager to check for any unusual processes. No suspicious processes were found, yet alerts about C2 communications persisted. The SOC manager then directed the immediate containment of the workstation and a memory dump for analysis. As a memory forensics expert, you are tasked with assisting the SOC team at Forela to investigate and resolve this urgent incident.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-c2-communications">What are C2 communications<a href="#what-are-c2-communications" class="hash-link" aria-label="Direct link to What are C2 communications" title="Direct link to What are C2 communications">‚Äã</a></h3>
<p>This term is new to me, so time to do some research to gain more context into the event. After doing some googling I found that C2 just stands for <strong>Command &amp; Control</strong>, meaning that the computer is potentially compromised and could be part of a botnet. Yikes!üò¨</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-provided-files">The Provided Files<a href="#the-provided-files" class="hash-link" aria-label="Direct link to The Provided Files" title="Direct link to The Provided Files">‚Äã</a></h3>
<p>For this investigation the zip file is 1gig in size. Looks like we will be sifting through a lot of data. The file stored inside of the zip file is a <code>.mem</code> file, which I have not used before but, makes sense as in the given scenario, it&#x27;s stated that a memory dump is provided for analysis.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="memory-analysis-software-volatility">Memory Analysis Software (Volatility)<a href="#memory-analysis-software-volatility" class="hash-link" aria-label="Direct link to Memory Analysis Software (Volatility)" title="Direct link to Memory Analysis Software (Volatility)">‚Äã</a></h3>
<p>I looked into the different types of software used by SOC teams, to analyze <code>.mem</code> files and I came across <strong><a href="https://volatilityfoundation.org/" target="_blank" rel="noopener noreferrer">Volatility Framework</a></strong>, an open-source tool that is used for memory forensics. I went ahead and followed the instructions on the <a href="https://github.com/volatilityfoundation/volatility3" target="_blank" rel="noopener noreferrer">github page</a> for installing the needed dependencies(python3) and Volatility 3 on a Linux VM.
<img decoding="async" loading="lazy" src="/assets/images/1c6cfe1f2b558f44b8954e21d9026899-b215cf557b2b98bcc8afd5e634372726.png" width="1080" height="823" class="img_ev3q">
I also needed to create a python virtual environment for use for volatility. Python virtual environments are used to isolate dependencies for projects, instead of installing dependencies globally, which is messy and could cause issues down the road. I went ahead and attempted to create and environment using the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python3 -m venv venv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I was met with the following message that I did not have the needed package installed, <code>python3.12-venv</code>.
<img decoding="async" loading="lazy" src="/assets/images/c33f60c71254c640e86a1eedeb33c673-4997551a47e8cc328e8c699e09a385bd.png" width="639" height="194" class="img_ev3q">
I used the command provided along with <code>sudo</code> to install the needed package.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo apt install python3.12-venv -y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we need to activate the python environment via the following command.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">source venv/bin/active</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Our virtual python environment should now be active, you can observe this via the terminal output, which now includes <code>(venv)</code>.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/9b88a37ccd953430bd050a39b6eca3d5-69ce58f4163a23e78eba5c2421182e40.png" width="1055" height="445" class="img_ev3q">
And finally, as you can see from the image above, we can now run volatility commands.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1--2">Task 1 &amp; 2<a href="#task-1--2" class="hash-link" aria-label="Direct link to Task 1 &amp; 2" title="Direct link to Task 1 &amp; 2">‚Äã</a></h2>
<ol>
<li><strong>Please identify the malicious process and confirm process id of malicious process.</strong></li>
<li><strong>The SOC team believe the malicious process may spawned another process which enabled threat actor to execute commands. What is the process ID of that child process?</strong></li>
</ol>
<p>So now that we have volatility3 installed and running we can run commands to accomplish various functions. Doing <code>python vol.py -h</code> brings up the following output.
<img decoding="async" loading="lazy" src="/assets/images/44510b5da4eace402c27bfcc93173016-58688ffa8936626aaa6014e08b5a218e.png" width="1267" height="871" class="img_ev3q">
Which provides a useful list of flags, arguments and parameters that can be used with the command line utility. The flag, <code>-f</code> allows for specifying of a file to process and analyze, this then must be followed with a value for the plugin to be used on the file. In the case of this question we need to look at the processes that were running on the machine at the time the SOC team was alerted and captured a memory dump of the affected machine. Looking at the list of plugins available from the fresh install, I can see that there is a plugin called <code>windows.pslist</code>, which allows listing of processes that are present in the target windows memory image.
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="709" height="47" class="img_ev3q">
So now we craft the final command to get the processes, we call python to run <code>vol.py</code>, adding the <code>-f</code> flag and specifying the target file which is, in my case located on an attached folder share to the VM. File path to the memory dump we need to analyze for this lab is <code>/media/sf_D_DRIVE/HTB-Sherlocks/RogueOne/20230810.mem</code>. Then we envoke the plugin we need, so that we can get the intended output, <code>windows.pslist</code>.
The final command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python vol.py -f /media/sf_D_DRIVE/HTB-Sherlocks/RogueOne/20230810.mem windows.pslist</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Running the command gives us a list of all of the processes, that of which there are many.
<img decoding="async" loading="lazy" src="/assets/images/f73d3623f999398cba988e8e108c8f17-7e6f11afe42d531d63d8cc28629a1768.png" width="1069" height="375" class="img_ev3q"></p>
<p>I went ahead and ran the program again by this time piping the output to a text file that could be searched through and analyzes in greater detail.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python vol.py -f /media/sf_D_DRIVE/HTB-Sherlocks/RogueOne/20230810.mem windows.pslist &gt; pslist_output.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After running the above command we can now use the <code>cat</code> and <code>grep</code> command line utilities to display and filter the content contained within the created text file.
<img decoding="async" loading="lazy" src="/assets/images/93dab0d3f29187c9af4bbcd192fba855-90e04eede9ec4af7da8757234f5c3fa2.png" width="1079" height="234" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="investigating-the-output">Investigating the Output<a href="#investigating-the-output" class="hash-link" aria-label="Direct link to Investigating the Output" title="Direct link to Investigating the Output">‚Äã</a></h3>
<p>Looking through the list of processes there are no processes that are named suspiciously at first glance. We do have two <em>Process ID (PID)</em> rows though, one for regular PID values and a second for a <em>Parent Process ID (PPID)</em> which are processes that have been spawned from other running processes. Threat actors may do what is called, <em><strong>Living off The Land (LOTL)</strong></em> which is a technique that allows threat actors obfuscate there activity and avoid detection via using the software included in the operating system and whatever applications the user has installed that may be vulnerable.</p>
<p>Taking all of that into account, if we look toward the bottom of the pslist_output file, we can see two processes for <code>cmd.exe</code>, the running of command prompt it&#x27;s self is not a red flag, though normal end-users for the most part will not be launching that application on a regular basis. The red flag in this case are the parent processes that have spawned both instances of <code>cmd.exe</code>.  Lets use both the <code>cat</code> &amp; <code>grep</code> cmd line utilities to filter the <code>pslist_output.txt</code> file and gain more insight.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/0e1833acfc3625b76a9b214831a82653-44dc30944eb44b85fbca60f42e813815.png" width="974" height="78" class="img_ev3q">
Using <code>cat</code> to display the output and <code>grep</code> to filter for <code>cmd.exe</code> we can see that the parent PID&#x27;s, which are <code>936</code> &amp; <code>6812</code>. Filtering for both of these PIDs brings up two distinct <code>svchost.exe</code> processes.
<img decoding="async" loading="lazy" src="/assets/images/14c8875f85526f3ba123314eaf00b7dc-7eb883599f05c3f0e752fd08e1143100.png" width="1241" height="156" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="svchostexe">svchost.exe<a href="#svchostexe" class="hash-link" aria-label="Direct link to svchost.exe" title="Direct link to svchost.exe">‚Äã</a></h3>
<p>Digging into the information on the svchost process, I found that it&#x27;s known as the Service Host. It is an integral system process for the Windows Operating system and acts as a host/manager for <em>DLL-Based</em> Windows Services. Essentially is manages <strong>background</strong> services allowing the OS to run efficiently.</p>
<p>I also found that <code>svchost.exe</code> spawning the <code>cmd.exe</code> process is not considered to be normal behavior for the process and is a clear indicator of compromise. Also when filtering for all of the <code>svchost.exe</code> processes, they all share the same <em>PPID</em> except for the <code>svchost.exe</code> processes that spawned <code>cmd.exe</code>.
<img decoding="async" loading="lazy" src="/assets/images/e4e62b1fde93578999bc8d15e4a71640-9f0809b5ab4b96ff6f471d86164a3b1b.png" width="1260" height="442" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-answers">The Answers<a href="#the-answers" class="hash-link" aria-label="Direct link to The Answers" title="Direct link to The Answers">‚Äã</a></h3>
<p>So now that we have done our investigation and analysis of the processes that were running at the time of detection, we can answer the questions in both Task 1 and in Task 2.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="please-identify-the-malicious-process-and-confirm-process-id-of-malicious-process">Please identify the malicious process and confirm process id of malicious process.<a href="#please-identify-the-malicious-process-and-confirm-process-id-of-malicious-process" class="hash-link" aria-label="Direct link to Please identify the malicious process and confirm process id of malicious process." title="Direct link to Please identify the malicious process and confirm process id of malicious process.">‚Äã</a></h4>
<p>The malicious process in this case is the <code>svchost.exe (6812)</code> process that spawned the <code>cmd.exe (4364)</code>. Since they ask for the process ID as input, it would be <strong>6812</strong>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-soc-team-believe-the-malicious-process-may-spawned-another-process-which-enabled-threat-actor-to-execute-commands-what-is-the-process-id-of-that-child-process">The SOC team believe the malicious process may spawned another process which enabled threat actor to execute commands. What is the process ID of that child process?<a href="#the-soc-team-believe-the-malicious-process-may-spawned-another-process-which-enabled-threat-actor-to-execute-commands-what-is-the-process-id-of-that-child-process" class="hash-link" aria-label="Direct link to The SOC team believe the malicious process may spawned another process which enabled threat actor to execute commands. What is the process ID of that child process?" title="Direct link to The SOC team believe the malicious process may spawned another process which enabled threat actor to execute commands. What is the process ID of that child process?">‚Äã</a></h4>
<p>That would be the child process, that <code>svchost.exe</code> spawned, the <code>cmd.exe</code> process that has a PID of <strong>4364</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3">Task 3<a href="#task-3" class="hash-link" aria-label="Direct link to Task 3" title="Direct link to Task 3">‚Äã</a></h2>
<ul>
<li><strong>The reverse engineering team need the malicious file sample to analyze. Your SOC manager instructed you to find the hash of the file and then forward the sample to reverse engineering team. What&#x27;s the md5 hash of the malicious file?</strong></li>
</ul>
<p>We need to get the MD5 hash of the malicious <code>svchost.exe</code> file. I ran volatility3 with the <code>-h </code> flag so that I could see all the the options and plugins available. I narrowed down the search using <code>grep</code> to filter for any occurrences of the the word <em>file</em>. This should provide a function/plugin that will allow us to see the files in the filesystem of the memory dump file.
<img decoding="async" loading="lazy" src="/assets/images/6935a0a188447c883cd228b6caf27b95-444883691f47cef9ae1b1990f1af7074.png" width="1269" height="719" class="img_ev3q">
Looks there is a function/plugin called <strong>windows.filescan</strong>, which after some research, I found that it allows for listing of all file objects that were found in memory at the time of the dump.
<img decoding="async" loading="lazy" src="data:image/png;base64,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" width="754" height="44" class="img_ev3q"></p>
<p>Using this function/plugin, along with <code>grep</code> filter the output and place it into a text file, using the command below.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python vol.py -f python vol.py -f /media/sf_D_DRIVE/HTB-Sherlocks/RogueOne/20230810.mem windows.filescan | grep svchost.exe &gt; svchost_filescan.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Looking through the <code>svchost_filescan.txt</code> I can clearly see an <code>svchost.exe</code> file located in a folder that is not in the Windows directory, located in a the user, <strong>simon-stark&#x27;s</strong>, downloads folder.<br>
<img decoding="async" loading="lazy" src="/assets/images/cfacd4ebc59a847c0d68e88631284832-6a4b8ff5c9ea9d57ab2115cb3234fbfb.png" width="484" height="205" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="file-extraction">File Extraction<a href="#file-extraction" class="hash-link" aria-label="Direct link to File Extraction" title="Direct link to File Extraction">‚Äã</a></h3>
<p>We now know the location of the malicious file but, are we able to extract it out of the memory dump file? Does volatility3 have the functionality to do this? The answer to both questions is <strong>yes</strong>.</p>
<p>When I was looking up functions/plugins to use in order to list all of the files in the memory dump, I cam across the plugin <code>windows.dumpfiles</code>.
<img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAnQAAAArCAYAAADxLhXEAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAASdEVYdFNvZnR3YXJlAEdyZWVuc2hvdF5VCAUAABgxSURBVHhe7Z2NVxNH28bfP4x8QSRWFMWCUqkgKj4qVi0VxVKlxXJUpPpoxYoPgsWPik2LNoql2krLh2JFERQUTY1FCCCRAEtCgni9u5tNSCDZCYRYqDfn/M4h2Z3ZmXtm7rmys3vP/0VERIAgZhXKZcg69QvuPevF4MgonFwv2uvOYVdipNd5CixYdxCGpg5YR5yw9Rlx88wOxCmFY0oszfoOjZ396O95gb+afsKBE7+D6yzHBjV/XBGL/AYbWr9ZAaWUX3RuDWzGUqSqXOmT8gxoNHZjgL++Y7ALzZcLsFqnkK4dJHw9vm624c8DsVBMOKaITkX+lRaYOSdfvx48vHoQa33y1yCrahBd5Ruh9koXLIpFW1BSb4LF0ovOx9U4V9kGe/PXWCbaR0Amf1UqSo2vMenPeR9HEpTj50VuRUXvGMb6DPhE65VeQP0+Mktu4FEPB6eDQ9/z+7hethMJwVw/VPsr38d/m+x4oD8OQ6sFducQOm6dQkasV9lZ9pUtfxDlk0vP7H8SCh02HK+FyerA2Js3cN7cixiF1/FAsNov2OsHhDG+/Kbxgtk+weQfxPgIZL+g+recf+HH18KPUXa3B9xAL0xNBhz6tgH2SfZTYP7GItx8weG1cP2GfMSK7TdD9QuIArH5t+EYqMLOefxn7XZU9jvQeDDO1d4z0D9Y/kXevzHKF+L412y/iv4Hx/CBUoWUk+3oqdgKTcR8fFnL4da+hS5fLDM+g0k/M/57HrKu9mPUdBppQY07CZn2I0FHEMS/C1Ew2NB0ON4zIRGzCGofguDHQRwvnDkYS1Oh8nd8GpCgIwji3wUJhtkNtQ/xTqNEpC4WSdkXYbK1oPAD75WD0CBBRxDEvwsSDLMbah/iXUb5AY49dGKUe47f/5sKrb9zpgkJOoIgCIIgiDkOCTqCIAiCIIg5Dgk6giAIgiCIOU6Igk6JFd+0wuZ5HXu6KBF3sBE2n7AKs4l/rnxRKQW4buyHY+wNxl5WYLPG+3gA+2syccU65nqVebQd/0ueuYcu/12Q/QiCIIh/ByELutjMYlwq3AQdCbowEI3s6wPo/vlzJMbMh04XNeH1Zob9dbmosb19QaJMOIL7Tl4MvRmDc9iC501VKN6xHJF+zg0PSnx44jFGXZJs/G/MjO/T1T7nzUb7EQRBEMRUmSVLriTo/KKMx5H7NtwpWDIpMG1Q/JOCztGDK5+nIGVdBvJO1cM80oOqzyYH2A0PLkHn6LiEnDWpSE2VWJWEOG2QwWkFSNARBEEQc4TJgk69EeWdFlzepvH9nkez+Uf09LqW/TTZv2LkjevGx3gEbAkx0rQdj/SFOH/bBAtng6W1ArvixydGxaLNKK4zwTpiR1+rAcfKm30j2c9LwT5DM8xDDji5brRUHkBqND8ZB1m+CO0q7L/c4kpvt6KztRqHUlWT0gRCtnyMSNpCpGlrxx3UtFkwZK7DicPf45HVDsu9IqRF8eeLr+3b8bjyDK61dcFifYXn9aXY6o6ULuYv3OLy/fNecpW1vxs5QSJEyj71B5702eAcscJ06yyy4r3uXoVgP1HQjbzA+fXu/LTY/EMXnO3FSH4b9pME3YhM5PvZbD+CIAiCmCp+7tDpkFM9iLaipAkxgpRY/nULuLo8r+1nAjyDJAmS0d5q5CdpodAkoqDeit5LGYgSjy9Czm+vMNRchsyVy5C8sxyt3Gs4PYJOi4/0L2B/dhl70pZj2ZovcMloR1fFVswLqnxKJB5tgd1kQE5qPOLiVyI95yhy1wQ5obLKF4QgGRxqwOE1aTh6x4bRJ2ex+cPPcKXTDP0mftIXBYkTY/11KFgRBYU6DruqzLDcyMEibzvKbB3lgvEMY0BBosX6M0ZYH19EXvoKxC9Pw56f+M/NhUgS7R+a/SYLughE7vgZg44/cWAxL8rDbj+2oHMxO+1HEARBEFPFj6BzTXKD/OSo4/9fufdHVOxLhoqfxHZWWdFenOwlpOQE3Qi69ZugEb9TIHZ/A2yt32AFP+EpYr5E7XAvKra69+bUYntl/7hg0mTAYOHw+xcLPEJmfs5vGOyvRGZkMOVTI/2CGbb6vVjob6JmwCxfEIKkX7wbpULaaRP6KzOh4dPsb+DwxxfRkiBxoLdii2SfCKjSTsPE1WDPAq8lwXAJuuhsXLN24PyG8bucivf2oIZrxTdi1OrQ7OdP0Kn/cw4dTiNKV/GiJuz28/8M3aj7DqGUZrbajyAIgiCmit9n6DSbK9BtOot1mkQU3ufAtRQhSZOK0qcvYfjEe4N0OUFnR+vx8bto3hO2KrUURvtdHFrqniiVSCxs8SxpKpYU4I79L5xaPX5HQ5VSgqf2ezj0vjKo8mnXl6KNs6O3rRaXvyvCvi0JQUdkZpUvKEHi3ty3pB09F6XNfes43NwbA4W0ZNhSmOhJr4jdjwY7L3i8l+XCJOhUKSfxxM/evhjrQvlGlwgLxX7+BJ1qnSTohPqF3X7+n6Fb9UHshBczZqf9CIIgCGKq+BV0ipg81A014EDyXvzRWI7zDXU4sDIPtYMN2B/r/VC5nKALPGG7BNMdFCxx56VE/JEmH0HXKCPogi2femEyMr78GqerWtDntKJ+X3BbzbDKJ9Rv/4T66fj62f0JkpO8IKmQBEkth1v7FnoEiXd6xWJBxL4tQSfYstGrfv6Zrv0CL7nyNpWWXMNrv/AuuYbbfgRBEAQxVfwKughlMorbe1Clr8K90jSknriLX/VX0Pn01IQJcnqCTrFAWJ76G+fWucWLBpv03XC4BZPmk8lLrrt/w6BVWHLlPwddPjcapF/ogr06Z8JdEjV0i+MRv1gHtdf3zPJF6JBbY8PTklVSGBHhDt4Dj4AITpA4Ya3KwjzpmppNepiHa/FljJdICFXQaXfjxrAJZWu9RKKAsGQ48ApVn84PkO9EpmY/vy9F6LvgfOJe8gy3/WZI0IXdfgRBEAQxM/gXdBGR2HbZgmHOBP1HGqg3fAfj0DCsV3e4XmrwMD1B53rpwAJz1S7EqfnJeFkeqvvGfF6KEN6KtD8zIHftMiSs/hwXjXaYL2YgWsyPVT4V1uSfReHudCTHL8HSlGzo2214VrbWN46bMglFj0YnP1vFLJ8Kq0qewvawGKlaXsAsysAFowOjUxQkr7lWXPg0GQlJGTh514r+6lxfO4Yq6JQrceKRHUb9DiTFxSL2vSgpHy02nP0LdnMNjm1LQUJCEtZtL8D5qhNI5+sbqv1EQSeFLUlO+xh7SoWwJb34ZZe7HuG23wwJunDbjyAIgiBmiACCToHY/NtwDFRh5zz+s3Y7KvsdaDwY5xJoqlSUGv08ROS8jyMJSrag4z8rFm1BSb0JFksvOh9X41xl2/iSpnA8OhX5V1pg5pxwcj14ePUg1urcd68Y5eMn6qQ8AxqN3RgYGYVjsAvNlwuw2pNeIpCg42GWb+HHKLvbA26gF6YmAw592zDlJcMH+uMwtFpgdw6h49YpZHjCbkgEEnQs+3vOVWD+xiLcfMHh9Zs3vuE5hLAbJTfwqIeD08Gh7/l9XC/biQSxfqHZTxR0UmDhUdsr/H3/F5zM8g0sHF77MQTdbLEfQRAEQcwQAQQdEVZEQWJD02F6pmpakP0IgiAIwgcSdP8EJEhCg+xHEARBED6QoPsnIEESGmQ/giAIgvCBBB1BEARBEMQchwQdQRAEQRDEHIcEHUEQBEEQxByHBB1BzDX8hAUKDSXiDjbC5hWWJ1iiUgpw3dgPx9gbjL2swGaN9/EAcf40mbhiHXOFihn1s1cu8daQb7/ZDiOOZNBMv/8Tc5B/sf8hQUfMOrzj2DmHLXjeVIXiHb5x7N5pZo2gi0b29QF0//w5EmPmQ6eLmhA4WYnYzGJcKtwEnb8JN8DWanMFVdpZ/G37DZ+FSQSFO392+/0DaLaios+GG7u1k45FZV8HJ+wW5LEHo38FDQm6d5I57n/8QYKOmHV47zSRsi4DeaeEnSZ6UPVZoB0z3jFmi6BTxuPIfRvuFCyZXruQoJMl7IIu1PYLB0Iw9RY7WgoTJ/RtaT/tR0VImnHRRYLunYQEHUGEH797wf7QBad7RwrGTiTCThPWjjuoabNgyFyHE4e/xyOrHZZ7RUiL4s8Xw57Y8bjyDK61dcFifYXn9aXY6r1Th3YV9l9ugXnIAafdis7WahwSN/6XjjNR4L11B2G41wGr3QHu5VPUn96OOHHCUGJZ9jnUtL7AK5sTIwMv0GQowBqfnSRk0kv1bzu7F0V/PIN1hK9bawV2xXuVX9jJ4tQfeNJng3PECtOts8iKd9tT2AllM4rrTGLavlYDjpU3++yEIot4feEWqu+f95KdJvtXjLxxfe+zw4Y3cg6VUX42cvbnmZeCfYZmV/ty3WipPIDUaMn+Yv3seKQvxPnbJlg4m499lUnH0Trqqpv3n/PmXsS46ylX/pnIP5T+GUT7CfsPZ1UNouuHXOw6dxsdAyMYGepCzQFJaMnYjzn+3OXwSyR2/GxFt34T1Ly4O9LslLZcVGNDeSe433aJ+yHL9i+GfQWY/T9Q/dQbUd5pweVtmvHrSWg2/4ieXsmGIbRPUPaT6V9BpZfr/yKB21/94Qk8sj9AYaLXuI3KwKXeflzL1nnlIYOsfeT944z4d4FQ/E/I80N4IEFHzDomC7oIRO74GYOOP3FgMT+oRYctL+gGhxpweE0ajt6xYfTJWWz+8DNc6TRDv4nPUxzwToz116FgRRQU6jjsqjLDciMHi8SJQYnEoy2wmwzISY1HXPxKpOccRe6a4AescnkBbg8MoKX8c6xLfB8JqzLx9bmvsEbcikyF1fnnUJS7BWs+iEdCynZ828RPYhc/9mzeL5terL8Ddss9nP9sDZJSs1DeZsPLSxnSXsZarD9jhPXxReSlr0D88jTs+Yn/3Fzoursh7lX8CkPNZchcuQzJO8vRyr322qs4SELdazigQ2WU3+dc/8jbX4uP9C9gf3YZe9KWY9maL3DJaEdXxVbME9JLgme0txr5SVooNIkoqLei12NfF4HvoLHsH2r+ofdPEdn2EyZ0DsMWE2r/txUJ0Rpol27Ejo3C9ory9mOOv0nX8kaJ5OJ2DNfkQhe1HZV9Qxh6eRVZUVrsvsHhWdkar2XhAP2LZV9m/5ernw451YNoK0qadAdx+dct4OryeNEdWvuw7Sffv4JJL9v/RWTaX5mIwha7j//VZhjQa6nEjujxegSGZR95/xi6f5eYtv+ZofEXBkjQEbMOf4JO/Z9z6HAaUbqKHzRBCLp+8W6eCmmnTeivzISGT7O/gcMfX0RLA96B3oot0EjpVWmnYeJqsGeB8CtQjfQLZtjq92KhPyHCRIW1ZSaMPBT2o/V3fDLzcqoxzJd/lST4ZNOL9XfAYvhEEgBKxH3VCHvrN1ghnB+djWvWDpzfMH4XQfHeHtRwrfjmAyUUMV+idrgXFVsjpeNabK/snz2CjlF+n3P9wrCfJgMGC4ffv1jgKff8nN8w2F+JzEj+s2jfEfEukat/KBC7vwE2t32lNAEFF6v8oeYfcv+UCELQOSeUSYRhP+b4887LD9H8WODaipCccgIPH1xERVMriletwNGWYdTnjV8zYP9i2JfZ/2Xr57rmIC8OdPz1V+79ERX7knmRqcXOKivai5N5nxRa+zDtx+hfzPSs/i9+J9P+fL3jD92D7VERPhSPabHN8BK9vD9y/yCVZ+r28faPoft3Kd9p+58ZGn9hgAQdMevwJ+hU6yRBJ9zWFh02Q9C5N/cvaUfPRWlz/zoON/fGeDb3935ORxG7Hw12KX/+s3Z9Kdo4O3rbanH5uyLs25IQpLMS0GFPrR3mC+lQ+z2ugG5tAX5qfI5XtlGMSUtHYy/OY71aOM5IL9bf7nOXwLv+qpSTePLalafP31gXyjeqoUothdF+F4eWuh0Z/4uzkP/FOUsEHav83uf6R95+iiUFuGP/C6dWj/+iVqWU4Kn9Hg697xZcdrQe929fT5oAgotZ/hDzFwitf0owBd0Q+sSx43uMZT/m+PPKyx+qtDMw9V7Cp7nX0XExExl6E27kZUHf1YkL6d7tLyfoAtuX1f+Z9dtcgW7TWazTJKLwPgeupQhJmlSUPn0JwycukRhK+7Dsp2b0L1Z6Jav/i98Fbn8BZVw+Grh2FAtjV5uJK31m/LjZLZDZyNtH3j/OhH8XCcH/zMj4CwMk6IhZR+Al1zsokJZc908QdDreYdv9CbqT/ICvkAZ8LYdb+xZ6Brx3esViwcn5Dnj1wmRkfPk1Tle1oM9pRf2+YLcakwTF9wEEWeRm/GDm0Ho+C0kLNOIEF5l9HcOd5djgLegCpRcnrMCC1uWcG1GwxOvXqBeuCY23pee49MD5rBF08uVnI28/YcJuZAq6wPb1pAko6BjlDzF/N9PvnxJMQTeIrvKNk2zIsh9z/Hnl5Q9FzD7c4m7jh4vtqN8fi5i8Gjyt+B51XCO+ivPuK3KCTmZ8MPo/q36KmDzUDTXgQPJe/NFYjvMNdTiwMg+1gw3YHzve5tNtH5b91Iz+xUovCDrZ/i9+F7j9RXgb59UN4WnJKszfXom+FxeQHqCfBiKgfRj+cab8e6j+J+TxFwZI0BGzDr8vRei74Hwi3GYXPuuQW2MTnYnreRrhF/YDjExJ0DlhrcryPDOi2aSHebgWX8b4G8QapF/ogr06J8hfYfJLfsrlR9Fiv4uDnslJiQ9PPIazyy3ogllylREEwpLBwCtUfTrf7+SpWCAsH/yNc+vczk2DTfpuON62oNPuxo1hE8rWejlZAUb52bCWXD+ZvOS0+zcMCiExPEuuQQiutWUw2X/H5/PGvxNhlT/U/Ccx1f4pMU1Bx7JfqIIuQv0R9OZudHUZxb6hWlWK9hcvYO4zIMNHNExP0DH7P6t/KJNR3N6DKn0V7pWmIfXEXfyqv4LOp6d82m+cqbUP036M/sVMz6qf+B1D0EUoEPNFNax/XUDJNQv+Prc+wHnB4Gsfln+cMf8+Y/4nUPuqoVscj/jFuhBsMzVI0BGzDlHQSWFLktM+xp5SIWxJL37Z5Z54VFhV8hS2h8VI1fLnL8rABaMDo1MUdK+5Vlz4NBkJSRk4edeK/upcaWJQYU3+WRTuTkdy/BIsTcmGvt2GZ2Vrg47T5Xko/3wO1iUuRfzKrfjqVD5WCw4/Ogs/W17i19yl4kDXJu3Dje5RvPYIOkZ6piDQYsPZv2A31+DYthQkJCRh3fYCnK86gXQhf/GhcAvMVbsQJzjIZXmo7ht7+8/QKVfixCM7jPodSIqLRex7UVI+jPJPzMcPsvYTfiD8wDvgZwbkrl2GhNWf46LRDvPFDEQL6YMUXIrF+Wiwm1G5OwG6qEho1O4JiGX/UPMPvX+KTFfQMewXsqCTxucb7jqyBTGr5cfL4BuMPixEok//nJ6gY/d/Rv+IiMS2yxYMcyboP9JAveE7GIeGYb26Q3qmNbT2YdtPvn8Fk16+fgIsQcej44WP1Qmnw4Qzad5L4SwY9mH4x9D9u8S0/U+Q7atMQtGjUYyKz/t5fR9GSNARsw5R0EmBhUdtr/D3/V9wMss3sLBi4ccou9sDbqAXpiYDDn3bMOUl1wf64zC0WmB3DqHj1ilkeF5rVyIpz4BGYzcGRkbhGOxC8+UCrPYJK8JCgQVC2IymDlhHnLD1GXHzzA5P2JKlWd+hsbMf/T0v8FfTTzhw4ndwniVXRvpgBIHw2n3JDTzq4XiHy6Hv+X1cL9uJBMmxKBZtQUm9CRZLLzofV+NcZdvMLbmqUlFq9PMQivM+jiS4bSygwPyNRbj5gsPrN298w08wys9Gzv58/aNTkX+lBWaOn5C4Hjy8ehBr3e0bpOCKUOiw4XgtTFYHxoTyTwxbEqj8Iec/E/2TZ9qCTt5+IQs6/trbrljhbDmK5YK9lPE4zE/Q3LVPXYKJ1b+CsC+r/8v2D75vxebfhmOgCjtFwbkdlf0ONB4U3gAWjofWPkHZT6Z/BZNevn4CQQi6iHnIutqPUdNppHn3WyYs+8j7x9D9u5vp+p8g25cEHUG8BcQBb0PT4X/+mQeCIIg5iTKOF84cjKWpU7szHG7eYf9Ogo549yBBRxAEMU2UiNTFIin7Iky2FhQGFUroLUKCjiDeIUjQEQRBTA/lBzj20IlR7jl+/2/q1F7EeRuQoCMIgiAIgiDmKiToCIIgCIIg5jgk6AiCIAiCIOY4IQo6RpypoFEi7mAjbFMNm0AQBEEQBEGELuhiM4txqXATdCTo5g6KGOy9KQR6m/DnrEee9+bFBEEQBEHMASLw/8Tcv/7aqyCwAAAAAElFTkSuQmCC" width="628" height="43" class="img_ev3q">
Now we craft the complete command so that we can extract the file out of the memory dump.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python vol.py -f /media/sf_D_DRIVE/HTB-Sherlocks/RogueOne/20230810.mem windows.dumpfiles --pid 6812 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/70e28cecde09008eaf409e635b544e84-22eefeeb09015f6f34ceed4c21f3298e.png" width="903" height="781" class="img_ev3q">
Above you can see that the <code>svchost.exe</code> was dumped out an an <code>.img</code> file, along with the DLLs that the application must have been accessing to run. The <code>.img</code> file is a raw dump format that is a binary blob of the file as it appeared in memory at the time of capture.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hashing">Hashing<a href="#hashing" class="hash-link" aria-label="Direct link to Hashing" title="Direct link to Hashing">‚Äã</a></h3>
<p>Now that we have the image file of the malicious file we need to get a hash of the file to provide to the reverse engineering team mentioned in the task. To do this we can use the pre-installed <strong>md5sum</strong> command line utility. Most distributions of Linux have this utility installed by default as a part of the GNU Core Utilities package.</p>
<p>The command used to get the md5sum is as follows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">md5sum file.0x9e8b91ec0140.0x9e8b957f24c0.ImageSectionObject.svchost.exe.img</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Which gives use the output, containing the MD5 hash and the filename. The hash being <strong>5bd547c6f5bfc4858fe62c8867acfbb5</strong>, which is the answer to Task 3.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4">Task 4<a href="#task-4" class="hash-link" aria-label="Direct link to Task 4" title="Direct link to Task 4">‚Äã</a></h2>
<ul>
<li><strong>In order to find the scope of the incident, the SOC manager has deployed a threat hunting team to sweep across the environment for any indicator of compromise. It would be a great help to the team if you are able to confirm the C2 IP address and ports so our team can utilize these in their sweep.</strong></li>
</ul>
<p>This task requires us to dig into the <code>windows.netscan</code> plugin that is pre-installed with Volatility3. With the Linux Mint VM that I had setup, volatility was not detecting that the memory dump file had data that could be scanned with the plugin, so I created a new VM and installed Kali Purple, which is a Linux distro targeted at purple/blue team use, which is more suitable for carrying out investigations and also has a lot of SOC Analyst software pre-installed.</p>
<p>I believe now, after looking into the situation, that the file had been only partially extracted from the archive, the memory dump that I was accessing with volatility3 was only 2.7gb in size, with the file in kali purple, after fully being extracted from the archive, was around 4gb in size. Whoops!üòù</p>
<p>So, here is the truncated output.
<img decoding="async" loading="lazy" src="/assets/images/6b7a134109b41851933036b02589823d-58d93ddf0d599096ecedd5eadd8eadc5.png" width="1197" height="802" class="img_ev3q">
The first thing that jumps out to be is a connection to an IP address, <strong>13.127.155.166</strong> with the port <strong>8888</strong>.
<img decoding="async" loading="lazy" src="/assets/images/9227a23fead3b17a69b2c8fc5aef4eee-86e161a19875148a1e1c7cb030e6946c.png" width="1157" height="19" class="img_ev3q">
From what I know about services, networking, and ports, and from running some services on home server, port 8888 is used for some self-hosted services. I did some research on the port and what it has been historically used for. <a href="https://whatportis.com/ports/8888_http-web-interface-alternative" target="_blank" rel="noopener noreferrer">WhatPortIs.com</a> states that the port is commonly used for http &amp; https traffic as an alternative port, if there are multiple services providing http/https functionality. <a href="https://www.speedguide.net/port.php?port=8888" target="_blank" rel="noopener noreferrer">SpeedGuide.net</a> states that the port is used for <em>&quot;allhttpd&quot;</em> but, also states that it could be related to malware and trojans, things are looking fishy üêü.</p>
<p>Moving on to the IP address, I did some research on websites that contained databases of IP addresses that could be associated with botnets &amp; C2 Command and Control servers. I landed at <a href="https://talosintelligence.com/reputation_center/" target="_blank" rel="noopener noreferrer">Cisco Talos</a>, which allows  for searching of IP addresses, providing information on if the IP address has been used in malicious acts, exactly what we need.</p>
<p>The search itself did not turn up anything of note, IP address originates from Mumbai, India bit the IP address is rated as neutral in nature.
<img decoding="async" loading="lazy" src="/assets/images/3b792a7166d7d200f514d24bceba9884-b7ca872896b6ae7f21c586043f843fe8.png" width="619" height="694" class="img_ev3q"></p>
<p>Judging from this entry being the only entry from an <code>svchost.exe</code> process and it&#x27;s the only one to be connecting to a foreign IP on a non-standard port, we should be on the right track. I went ahead and entered the IP found and port,  <strong>13.127.155.166:8888</strong>. This turned out to be the correct answer.
<img decoding="async" loading="lazy" src="/assets/images/99175462031af18f1aab198ba46a4b26-b1abc7ae9a4496342cba1dc9feec1bcc.png" width="695" height="240" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-5">Task 5<a href="#task-5" class="hash-link" aria-label="Direct link to Task 5" title="Direct link to Task 5">‚Äã</a></h2>
<ul>
<li><strong>We need a timeline to help us scope out the incident and help the wider DFIR team to perform root cause analysis. Can you confirm time the process was executed and C2 channel was established?</strong>
To get the answer for this task we can look at the time that the connection was established. In the previous question we used the <code>windows.netstat</code> volatility plugin to get a list of connections that were established leading up to the event. It also provided us with timestamps for when these connections took place.</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/9227a23fead3b17a69b2c8fc5aef4eee-86e161a19875148a1e1c7cb030e6946c.png" width="1157" height="19" class="img_ev3q">
Looking back at the above image, we can see that the time of connection to the C2 server was at <strong>10/08/2023 11:30:03</strong>. Note that we could have also gotten this answer via using the <code>windows.pstree</code> plugin, which allows for checking of parent-child relationships and provides timestamps as to when processes where initially executed.<br>
<img decoding="async" loading="lazy" src="/assets/images/c3f278d2c5df55ab1478fa8cc66d6897-0e8c1e495865b1ed1188f2dc9b6787ea.png" width="1260" height="175" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-6">Task 6<a href="#task-6" class="hash-link" aria-label="Direct link to Task 6" title="Direct link to Task 6">‚Äã</a></h2>
<ul>
<li><strong>What is the memory offset of the malicious process?</strong>
The offset can be found via the above mentioned <code>windows.pstree</code>. It allows us to see, as mentioned before, parent-child relationships and when a process was executed. Looking at the malicious <code>svchost.exe</code> that after being launched created a child <code>cmd.exe</code> process, we can get the offset of the malicious file, which is <strong>0x9e8b87762080</strong>.
<img decoding="async" loading="lazy" src="/assets/images/89793110be8d531f657bd7a4ab07cc4e-95020871d9df7e914c69569ba5004c5a.png" width="1260" height="175" class="img_ev3q"></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-7">Task 7<a href="#task-7" class="hash-link" aria-label="Direct link to Task 7" title="Direct link to Task 7">‚Äã</a></h2>
<ul>
<li><strong>You successfully analyzed a memory dump and received praise from your manager. The following day, your manager requests an update on the malicious file. You check VirusTotal and find that the file has already been uploaded, likely by the reverse engineering team. Your task is to determine when the sample was first submitted to VirusTotal.</strong>
Nice, okay so we can use the hash of the malicious <code>svchost.exe</code> file that we gathered as the result of [[#Task 3]], which was <strong>5bd547c6f5bfc4858fe62c8867acfbb5</strong>. So, we load up <a href="https://www.virustotal.com/gui/home/search" target="_blank" rel="noopener noreferrer">VirusTotal</a> and navigate to search and input the hash.
<img decoding="async" loading="lazy" src="/assets/images/3c2a636693291df9c1b033fe703081ae-d895f68b275e267078fd22d0f6516c6b.png" width="854" height="732" class="img_ev3q"></li>
</ul>
<p>And we get a result, the file indeed is on virustotal, and is indeed malicious in nature, as we have already confirmed.
<img decoding="async" loading="lazy" src="/assets/images/f8712dc71fd8059bfe677e388f5af5a5-39e72fb5a33795d998d71c5d8bc0ce9d.png" width="1373" height="849" class="img_ev3q"></p>
<p>Navigating to the details section of the entry in virustotal, and it looks like the file was first submitted on <strong>2023-08-10 11:58:10 UTC</strong>. üéâ
<img decoding="async" loading="lazy" src="/assets/images/1b05997badd8edc600002d09da18a9dd-6342c57086d0a498eafe33cd3c0e79ec.png" width="510" height="462" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-takeaways">Key Takeaways<a href="#key-takeaways" class="hash-link" aria-label="Direct link to Key Takeaways" title="Direct link to Key Takeaways">‚Äã</a></h2>
<ul>
<li>The volatility framework is a powerful tool in memory forensics that can be used on Windows, Mac, &amp; Linux.</li>
<li>Volatility has a host of plugins that work with supported Operating Systems, allowing for in depth memory analysis and investigation.</li>
<li>Capturing images of a compromised systems filesystem and memory is a critical component in the incident response process, providing ways to investigate possible compromised machines, without the need to keep them on the network.</li>
<li>Cisco Talos is a repository of IP address information. Providing insights on if a particular IP address is a part of a botnet or has been used in malicious activities.</li>
</ul></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/hackthebox">Hackthebox</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/labs">Labs</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/incident-response">Incident-Response</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/volatility">Volatility</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/hashing">Hashing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/virustotal">Virustotal</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/memory-forensics">Memory-Forensics</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/python">Python</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/Kerberoasting-Explained"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Kerberoasting: What You Need To Know</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/Noxious-HTB-Sherlocks"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Noxious (HTB-Sherlocks)</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#scenario" class="table-of-contents__link toc-highlight">Scenario</a><ul><li><a href="#what-are-c2-communications" class="table-of-contents__link toc-highlight">What are C2 communications</a></li><li><a href="#the-provided-files" class="table-of-contents__link toc-highlight">The Provided Files</a></li><li><a href="#memory-analysis-software-volatility" class="table-of-contents__link toc-highlight">Memory Analysis Software (Volatility)</a></li></ul></li><li><a href="#task-1--2" class="table-of-contents__link toc-highlight">Task 1 &amp; 2</a><ul><li><a href="#investigating-the-output" class="table-of-contents__link toc-highlight">Investigating the Output</a></li><li><a href="#svchostexe" class="table-of-contents__link toc-highlight">svchost.exe</a></li><li><a href="#the-answers" class="table-of-contents__link toc-highlight">The Answers</a></li></ul></li><li><a href="#task-3" class="table-of-contents__link toc-highlight">Task 3</a><ul><li><a href="#file-extraction" class="table-of-contents__link toc-highlight">File Extraction</a></li><li><a href="#hashing" class="table-of-contents__link toc-highlight">Hashing</a></li></ul></li><li><a href="#task-4" class="table-of-contents__link toc-highlight">Task 4</a></li><li><a href="#task-5" class="table-of-contents__link toc-highlight">Task 5</a></li><li><a href="#task-6" class="table-of-contents__link toc-highlight">Task 6</a></li><li><a href="#task-7" class="table-of-contents__link toc-highlight">Task 7</a></li><li><a href="#key-takeaways" class="table-of-contents__link toc-highlight">Key Takeaways</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2025 DarioCruz.dev. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>